(function(a,b){function d(a){return")]}'\n"==a.slice(0,5)?b.parseJSON(a.substring(5)):a}window.version_mismatch_has_occurred=!0;a.version=function(){return version};a.cacheVersion=function(){return cacheVersion};a.getHashConvertedUrl=function(a){var b=window.location.pathname;window.location.hash&&(b+="/"+window.location.hash.slice(1));a&&(a=window.location.search,a=a.replace(/([?&])mp-r-id=[^&]*&?/,"$1").replace(/&$/,""),"?"==a&&(a=""),b+=a);return b};a.fetchTemplates=function(a,d){b.ajax({dataType:"html",
type:"GET",url:a,success:function(a){b("head").append(a);b('script[type="text/x-handlebars"]').each(function(a,c){c=b(c);Ember.TEMPLATES[c.attr("data-template-name")]=Ember.Handlebars.compile(c.html());c.remove()});d&&d()},error:function(){alert("Request for template file "+a+" failed.")}})};a.ajaxREST=function(a,e,f,g){(new Date).getTime();request_seq=a.split(" ");method=request_seq[0];path=request_seq[1];headers={};headers["X-XSRF-Token"]=document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2];
a={type:method,dataType:"text",url:"/api"+path,headers:headers,dataFilter:d,success:function(a,c,b){f&&f(a,b)},error:function(a,c,b){if(g)g(d(a.responseText,"text"),a);else{if(!b||"OK"==b)b=d(a.responseText,"text").error;alert(""+c+" "+a.status+": "+b)}}};b.isEmptyObject(e)||b.extend(a,{contentType:"GET"==method?"application/x-www-form-urlencoded":"application/json; charset=utf-8",data:"GET"==method?{json:JSON.stringify(e)}:JSON.stringify(e),cache:!e.fresh});b.ajax(a)};a.pushTrackingEvent=function(a,
b,d,g,h){h&&_gaq&&_gaq.push(["_set","hitCallback",h]);a=["_trackEvent",a,b];void 0!==d&&a.push(d);void 0!==g&&a.push(g);_gaq&&_gaq.push(a)};a.pushTrackPageview=function(){var a=["_trackPageview",location.pathname+location.search+location.hash];_gaq&&_gaq.push(a)};a.getScriptCached=function(a,d){return b.ajax({dataType:"script",cache:!0,url:a,success:d})};a.getUrlQueryParams=function(){var a={},d=window.location.search;d&&b.each(d.substr(1).split("&"),function(b,d){var e=d.split("=");a[e[0].toString()]=
e[1].toString()});return a};a.getDecodedURIComponent=function(c){return(c=a.getUrlQueryParams()[c])?decodeURIComponent(c):c}})(window.UY=window.UY||{},jQuery);angular.module("udacity.core",["services","controllers","directives","filters","meta"]);angular.module("services","services.utility services.reviews services.blogFeed services.forum services.user services.auth services.content services.dummyData".split(" "));angular.module("controllers",["controllers.courseCatalog","controllers.lesson","controllers.reviews","controllers.editor","controllers.myCourses"]);
angular.module("directives",["directives.user","directives.utility","directives.reviews","directives.forum","directives.myCourses"]);angular.module("filters",["filters.dates"]);angular.module("meta",["meta.configuration"]);angular.module("services.lesson",[]);angular.module("directives.lesson",[]);angular.module("controllers.lesson",[]);angular.module("controllers.settings",[]);angular.module("directives.location",[]);angular.module("controllers.courseCatalog",[]);
angular.module("controllers.myCourses",[]);angular.module("directives.myCourses",[]);angular.module("services.utility",[]);angular.module("directives.utility",[]);angular.module("directives.reviews",[]);angular.module("services.reviews",[]);angular.module("controllers.reviews",[]);angular.module("services.blogFeed",[]);angular.module("directives.forum",[]);angular.module("services.forum",[]);angular.module("filters.dates",[]);angular.module("services.editor",[]);
angular.module("directives.editor",[]);angular.module("controllers.editor",[]);angular.module("meta.configuration",[]);angular.module("services.content",[]);angular.module("services.user",[]);angular.module("directives.user",[]);angular.module("services.auth",[]);angular.module("services.dummyData",[]);angular.module("youtube",[]);angular.module("udacity",["udacity.core"]);angular.module("udacity.viewer",["udacity.core","youtube","services.lesson","directives.lesson","controllers.lesson"]);
angular.module("udacity.overview",["udacity.core","youtube"]);angular.module("udacity.courseCatalog",["udacity.core"]);angular.module("udacity.editor",["udacity.core","services.editor","directives.editor","controllers.editor","services.lesson"]);angular.module("udacity.settings",["udacity.core","controllers.settings","directives.location"]);angular.module("udacity.core").config(["$locationProvider",function(a){a.html5Mode(!1);a.hashPrefix("!")}]);angular.module("udacity.courseCatalog").config(["$routeProvider",function(a){a.when("/:keyword")}]);
angular.module("controllers.courseCatalog").controller("courseCatalog",["$scope","$routeParams",function(a,b){a.categoryTypeOptions=[{value:"all",name:"All Categories"},{value:"biz",name:"Business"},{value:"cs",name:"Computer Science"},{value:"math",name:"Mathematics"},{value:"ph",name:"Physics"},{value:"ps",name:"Psychology"}];a.levelTypeOptions=[{value:"all",name:"All Levels"},{value:"beginner",name:"Beginner"},{value:"intermediate",name:"Intermediate"},{value:"advanced",name:"Advanced"}];a.form=
{categoryType:a.categoryTypeOptions[0].value,levelType:a.levelTypeOptions[0].value};a.courseData={cs101:{level:"beginner",category:"cs"},ph100:{level:"beginner",category:"ph"},st101:{level:"beginner",category:"math"},ma006:{level:"beginner",category:"math"},ma008:{level:"beginner",category:"math"},st095:{level:"beginner",category:"math"},cs046:{level:"beginner",category:"cs"},ps001:{level:"beginner",category:"ps"},cs215:{level:"intermediate",category:"cs"},cs222:{level:"intermediate",category:"cs"},
cs253:{level:"intermediate",category:"cs"},cs255:{level:"intermediate",category:"cs"},cs258:{level:"intermediate",category:"cs"},cs259:{level:"intermediate",category:"cs"},cs262:{level:"intermediate",category:"cs"},cs271:{level:"intermediate",category:"cs"},cs291:{level:"intermediate",category:"cs"},cs313:{level:"intermediate",category:"cs"},ep245:{level:"intermediate",category:"biz"},cs212:{level:"advanced",category:"cs"},cs344:{level:"advanced",category:"cs"},cs348:{level:"advanced",category:"cs"},
cs373:{level:"advanced",category:"cs"},cs387:{level:"advanced",category:"cs"}};a.routeCategoryMappings={"computer-science":"cs",business:"biz",mathematics:"math",physics:"ph"};a.routeLevelMappings={beginner:"beginner",intermediate:"intermediate",advanced:"advanced"};a.$on("$routeChangeSuccess",function(){var d=b.keyword;null!==d&&(a.routeCategoryMappings.hasOwnProperty(d)?a.form.categoryType=a.routeCategoryMappings[d]:a.routeLevelMappings.hasOwnProperty(d)&&(a.form.levelType=a.routeLevelMappings[d]))});
a.isNoMatch=!1;a.$watch("form.categoryType + form.levelType",function(){var b=0;angular.forEach(a.courseData,function(c){a.matchesFilter(c.category,c.level)&&b++});a.isNoMatch=0===b});a.isCourseShown=function(b){var c=a.courseData[b],b=c.category,c=c.level;return a.matchesFilter(b,c)||a.softlyMatchesFilter(b,c)};a.matchesFilter=function(b,c){var e=a.form.categoryType,f=a.form.levelType;return("all"===f||f===c)&&("all"===e||e===b)};a.softlyMatchesFilter=function(b){var c=a.form.categoryType;return a.isNoMatch&&
c===b}}]);angular.module("controllers.editor").controller("CourseEditorCtrl",["$scope","$routeParams","content","api","$location","nodedb","$timeout",function(a,b,d,c,e,f,g){a.$on("$locationChangeStart",function(c){a.dirty&&(window.confirm("You will lose any unsaved changes if you leave this page.  Are you sure?")||c.preventDefault())});a.nodeIndex=function(c){if(!c)return!1;for(var b=0;b<a.course.steps_refs.length;b++)if(a.course.steps_refs[b].key===c.key)return b;return-1};a.addStep=function(c,b){if(void 0===
b||b>a.course.steps_refs.length)b=a.course.steps_refs.length;a.course.steps_refs.splice(b,0,{ref:"Node",key:c.key})};a.removeStep=function(c){for(var b=0;b<a.course.steps_refs.length;b++)if(a.course.steps_refs[b].key===c.key)return a.course.steps_refs.splice(b,1)[0]};a.clickRemoveNode=function(c){confirm("Are you sure you want to delete this node?")&&a.removeStep(c)};a.moveToAfter=function(c,b){var d=a.nodeIndex(b);if(-1===d)return!1;a.removeStep(c);d=a.nodeIndex(b)+1;a.addStep(c,d)};a.$on("droppedNode",
function(c,b){b.droppedOn.key!==b.droppedKey&&a.moveToAfter(f.getNode(b.droppedKey),b.droppedOn)});a.newLesson=function(){var c=d.newLesson();c.affiliate_program_refs=angular.copy(a.course.affiliate_program_refs);a.course.steps_refs.push({ref:"Node",key:c.key})};a.addLesson=function(){alert("This feature is temporary disabled")};a.setAffiliation=function(c){console.log(c);a.course.affiliate_program_refs=[{ref:"AffiliateProgram",key:c}]};a.removeAffiliation=function(c){for(var b=0;b<a.course.affiliate_program_refs.length;b++)if(a.course.affiliate_program_refs[b].key===
c){a.course.affiliate_program_refs.splice(b,1);break}};a.createMasteryIfEmpty=function(){return!a.course.catalog_entry.mastery_spec?(a.course.catalog_entry.mastery_spec=new d.MasterySpec,alert("Course did not have a Mastery Spec defined, adding one.  You will need to save this Course."),!0):5!==a.course.catalog_entry.mastery_spec.badge_thresholds.length?(a.course.catalog_entry.mastery_spec.badge_thresholds.unshift(0),alert("Course mastery had to be updated to a new format.  Make sure the levels below appear correct and save changes."),
!0):!1};a.$watch(function(){return b.courseKey},function(){a.courseKey=b.courseKey;if("new"===a.courseKey){var c=d.newLesson();c.catalog_entry=new d.CatalogEntry;e.path("/c-"+c.key)}else f.getNode(a.courseKey,!0,1)});f.addEventListener("nodeUpdate",function(c){c===a.courseKey&&g(function(){a.course=f.getNode(a.courseKey);h="registered user\\3aglobal";l="enrollee\\3anode\\7ckNode\\2e"+a.course.key;a.enrollable=a.checkEnroll();a.open=a.checkOpen();a.dirty=!1},0)});a.$watch("course",function(){a.course&&
f.isDirty(a.course)&&(a.dirty=!0)},!0);a.save=function(){f.saveTreeFrom(a.course,1)&&(a.dirty=!1)};a.$on("removeUser",function(c,b){var d;if(confirm("Are you sure you want to remove this Instructor from the Course?")){for(d=0;d<a.course.catalog_entry.instructor_refs.length;d++)b.key===a.course.catalog_entry.instructor_refs[d].key&&a.course.catalog_entry.instructor_refs.splice(d,1);for(d=0;d<a.course.catalog_entry.assistant_refs.length;d++)b.key===a.course.catalog_entry.assistant_refs[d].key&&a.course.catalog_entry.assistant_refs.splice(d,
1)}});a.newInstructor=function(b,d){var e=null;d?a.assistantError=null:a.instructorError=null;c.get("/users/"+b).success(function(c){c.user&&c.user.key&&(e=c.user.key,d?a.course.catalog_entry.assistant_refs.push({ref:"Account",key:e}):a.course.catalog_entry.instructor_refs.push({ref:"Account",key:e}))}).error(function(c){d?a.assistantError=c:a.instructorError=c;console.error(c)})};a.newPermission=function(b){var d=null;c.get("/users/"+b).success(function(c){c.user&&c.user.key&&(d=c.user.key,a.course.guard.permissions.push({derivation:["assigned"],
behavior:"preview",principal_ref:{ref:"Account",key:d}}))}).error(function(c){a.permissionsError=c;console.error(c)})};var h="",j=function(a){return"enroll"===a.behavior&&a.principal_ref.key===h};a.checkEnroll=function(){return _.some(a.course.guard.permissions,j)};a.enrollable=!1;a.toggleEnroll=function(){var c=a.course.guard;a.checkEnroll()?c.permissions=_.reject(c.permissions,j):a.course.guard.permissions.push({behavior:"enroll",derivation:["assigned"],principal_ref:{key:h,ref:"ScopedRole"}});
a.enrollable=a.checkEnroll()};var l="",k=function(a){return"view"===a.behavior&&a.principal_ref.key===l};a.checkOpen=function(){return _.some(a.course.guard.permissions,k)};a.open=!1;a.toggleOpen=function(){var c=a.course.guard;a.checkOpen()?c.permissions=_.reject(c.permissions,k):a.course.guard.permissions.push({behavior:"view",derivation:["assigned"],principal_ref:{key:l,ref:"ScopedRole"}});a.open=a.checkOpen()};a.updateMastery=function(c){var b=parseFloat(a.course.catalog_entry.mastery_spec.badge_thresholds[c]);
isNaN(b)&&(b=0);a.course.catalog_entry.mastery_spec.badge_thresholds[c]=b};a.addMasteryWeight=function(){a.course.catalog_entry.mastery_spec.weights.push({node_ref:{ref:"Node",key:"1"},points:1})};a.masteryInfo=function(c){for(var b,d=0;d<a.course.steps_refs.length;d++)for(var e=f.getNode(a.course.steps_refs[d].key),g=0;g<e.steps_refs.length;g++)e.steps_refs[g].key===c&&(b=e.title+" - ");return b?b=(c=f.getNode(c))&&c.title?b+c.title:b+"(loading...)":"Node key is not in this course."};f.addEventListener("network",
function(c){a.busyText=c});f.addEventListener("keyChange",function(c){c[a.courseKey]&&(a.dirty=!1,e.path("/c-"+c[a.courseKey]))})}]);angular.module("controllers.editor").controller("ExerciseCtrl",["$scope","nodedb","mediaUpload","$timeout",function(a,b,d,c){a.addTidbit=function(){a.node.tidbits.push({bin_code_groups:[{bin_codes:[]}],tidbit_ref:null,plays_on_quiz:!1})};a.removeTidbit=function(c){a.node.tidbits.splice(c,1)};a.addBinCodeGroup=function(a){a.bin_code_groups.push({bin_codes:[]})};a.removeBinCodeGroup=function(a,c){a.bin_code_groups.splice(c,1)};a.$on("selectNode",function(c,b){c.stopPropagation();a.selectedNode=b.node});
a.$watch("node",function(){a.selectedNode&&(a.selectedNode=b.getNode(a.selectedNode.key))});a.$watch("selectedNode",function(){a.selectedNode&&b.isDirty(a.selectedNode)&&a.$emit("childNodeDirty");a.selectedNodeBusy=a.selectedNode&&d.isKeyEnqueued(a.selectedNode.key)},!0);b.addEventListener("nodeUpdate",function(d){a.selectedNode&&a.selectedNode.key===d&&c(function(){a.selectedNode=b.getNode(d)},0)});a.$on("droppedNode",function(c,d){if(void 0===d.droppedOn){var e=b.getNode(d.droppedKey);if(!e){c.stopPropagation();
return}if("lecture"===d.type&&!a.node.lecture_ref&&("Video"===e.model||"Sketch"===e.model||"SketchVideo"==e.model||"EmbeddedFrame"===e.model)){a.node.lecture_ref={ref:"Node",key:d.droppedKey};a.node.answer_ref&&a.node.answer_ref.key===d.droppedKey&&(a.node.answer_ref=void 0);_.each(a.node.tidbits,function(a){a.tidbit_ref.key===e.key&&(a.tidbit_ref=null)});return}if("answer"===d.type&&!a.node.answer_ref&&("Video"===e.model||"Sketch"===e.model||"SketchVideo"==e.model||"EmbeddedFrame"===e.model)){a.node.answer_ref=
{ref:"Node",key:d.droppedKey};a.node.lecture_ref&&a.node.lecture_ref.key===d.droppedKey&&(a.node.lecture_ref=void 0);_.each(a.node.tidbits,function(a){a.tidbit_ref.key===e.key&&(a.tidbit_ref=null)});return}if("quiz"===d.type&&!a.node.quiz_ref&&("ImageFormQuiz"===e.model||"ProgrammingQuiz"===e.model)){a.node.quiz_ref={ref:"Node",key:d.droppedKey};return}if("tidbit"===d.type&&!a.node.tidbits[d.nodeIndex].tidbit_ref&&("Video"===e.model||"Sketch"===e.model||"SketchVideo"==e.model||"EmbeddedFrame"===e.model)){a.node.tidbits[d.nodeIndex].tidbit_ref=
{ref:"Node",key:d.droppedKey};a.node.lecture_ref&&a.node.lecture_ref.key===d.droppedKey&&(a.node.lecture_ref=void 0);a.node.answer_ref&&a.node.answer_ref.key===d.droppedKey&&(a.node.answer_ref=void 0);return}}c.stopPropagation()});var e=function(){if(a.selectedNode&&(!a.node.lecture_ref||a.node.lecture_ref.key!==a.selectedNode.key)&&(!a.node.quiz_ref||a.node.quiz_ref.key!==a.selectedNode.key)&&(!a.node.answer_ref||a.node.answer_ref.key!==a.selectedNode.key))a.selectedNode=void 0};a.$watch("node.lecture_ref",
function(){e()});a.$watch("node.answer_ref",function(){e()});a.$watch("node.quiz_ref",function(){e()});a.isSelected=function(c){return a.selectedNode&&c===a.selectedNode};d.addEventListener("finished",function(b){a.selectedNode&&a.selectedNode.key===b.nodeKey&&c(function(){a.selectedNodeBusy=!1},0)});d.addEventListener("error",function(b){a.selectedNode&&a.selectedNode.key===b.nodeKey&&c(function(){a.selectedNodeBusy=!1},0)})}]);angular.module("controllers.editor").controller("EditorNetworkStatusCtrl",["$scope","mediaUpload","$timeout","nodedb",function(a,b,d,c){a.uploading=[];a.errors=[];a.nodedbErrors=[];a.running=!1;c.addEventListener("error",function(){d(function(){a.nodedbErrors=c.errors},0)});c.addEventListener("network",function(c){d(function(){a.nodedbNetwork=c},0)});b.addEventListener("started",function(c){d(function(){a.uploading.push(c);a.updateUploadStats()},0)});b.addEventListener("finished",function(c){d(function(){a.removeFromUploading(c);
a.updateUploadStats()},0)});b.addEventListener("error",function(c){d(function(){a.removeFromUploading(c);a.errors.push(c);a.updateUploadStats()},0)});a.lastNodedbErrors=function(c){c||(c=5);var b=a.nodedbErrors.length,c=Math.min(c,b);return a.nodedbErrors.slice(b-c,b)};a.updateUploadStats=function(){a.total=b.totalQueued;a.finished=b.totalFinished;a.running=b.running};a.removeFromUploading=function(c){for(var b=0;b<a.uploading.length;b++)if(a.uploading[b].nodeKey===c.nodeKey){a.uploading.splice(b,
1);break}}}]).controller("EditorChooserCtrl",["$scope","$location","nodedb",function(a,b,d){window.onbeforeunload=void 0;d.course=void 0;a.newLesson=function(){b.path("/l-new")};a.newCourse=function(){b.path("/c-new")};UY.ajaxREST("GET /nodes/lessons?fresh=true&top_level_only=true",{},function(c){a.$apply(function(){a.data=c;a.courses=c.lessons.filter(function(a){return a.catalog_entry});a.lessons=c.lessons.filter(function(a){return!a.catalog_entry});var b=function(a,c){return Date.parse(c.last_edit_time)-
Date.parse(a.last_edit_time)};a.lessons=a.lessons.sort(b);a.courses=a.courses.sort(b)})})}]).controller("EditorCtrl",["$scope",function(){}]).controller("LessonLayoutCtrl",["$scope","nodedb",function(a){a.clickOnNode=function(b,d){d&&d.stopPropagation();a.selectedNode=b}}]).controller("MicroUserInfoCtrl",["$scope","api",function(a,b){a.$watch("userRef",function(){a.userRef&&b.get("/users/"+encodeURIComponent(a.userRef.key)+"?fresh=true").success(function(b){a.user=b.user}).error(function(){a.user=
{error:"Invalid User"}})});a.removeUser=function(b){b.preventDefault();a.$emit("removeUser",{key:a.userRef.key})}}]).controller("LessonListCtrl",["$scope","$attrs","$routeParams","nodedb",function(a,b,d,c){a.nodeType=b.nodeType;a.parentNode=a.$parent.node;a.click=function(c){a.$emit("selectNode",{node:a.node});c.stopPropagation();return!1};a.dontSelect=function(a){a.stopPropagation();return!1};a.$watch("nodeRef",function(){a.nodeRef?(a.node=c.getNode(a.nodeRef.key),a.url="/danger_editor#!",d.courseKey&&
(a.url+="/c-"+d.courseKey),a.url+="/l-"+a.nodeRef.key):a.node=void 0});a.$watch(function(){if(a.nodeRef)return c.getNode(a.nodeRef.key)},function(){a.nodeRef&&(a.node=c.getNode(a.nodeRef.key))});a.$watch("node",function(){if(a.node){var b=function(a){if(!a)return"-";switch(a.model){case "Exercise":return b(c.getNode(a.lecture_ref))+b(c.getNode(a.quiz_ref))+b(c.getNode(a.answer_ref));case "Video":return a._video?"V":a._video_in_progress?"u":"v";case "ImageFormQuiz":return"CodeGradedEvaluator"===a.evaluator.model||
"LegacyCodeGradedEvaluator"===a.evaluator.model?a._background_image&&0<a.evaluator.gae_grading_code.length?"G":"g":"FormQuizEvaluator"===a.evaluator.model?a._background_image&&a.widgets&&0<a.widgets.length?"Q":"q":"?";case "Sketch":return"S";case "SketchVideo":return a._video?"T":a._video_in_progress?"u":"t";case "EmbeddedFrame":return 0<a.external_uri.length?"F":"f";case "Lesson":return 0===a.steps_refs.length?"l":"L";case "ProgrammingQuiz":return"ProgramEvaluator"===a.evaluator.model||"LegacyProgramEvaluator"===
a.evaluator.model?0<a.initial_code_files[0].text.length&&0<a.evaluator.executor_grading_code.length&&0<a.evaluator.gae_grading_code.length?"P":"p":"IFrameEvaluator"===a.evaluator.model?0<a.initial_code_files[0].text.length&&0<a.evaluator.gae_grading_code.length&&0<a.evaluator.js_application.length&&0<a.evaluator.html_body.length?"H":"h":"?";default:return"?"}};a.subBits="["+b(a.node)+"]"}},!0)}]).controller("VideoCtrl",["$scope","nodedb",function(a,b){a.setFile=function(c){a.$apply(function(a){1!==
c.files.length?(console.warn("Did not select exactly 1 file, so no file prepped for upload"),a.node.__FILE_video=void 0):a.node.__FILE_video=c.files[0]})};a.refreshNode=function(c){c.preventDefault();b.getNode(a.node.key,!0);a.refreshingNode=!0};var d=function(){a.ytPlayer&&(a.node._video&&a.node._video.youtube_id)&&a.ytPlayer.cueVideoById(a.node._video.youtube_id)};a.$watch("node._video.youtube_id",d);a.$watch("ytPlayer",d)}]).controller("SketchVideoCtrl",["$scope","nodedb","api",function(a,b,d){a.editStatus=
"";a.editOnIPad=function(){a.editStatus="Updating iPad edit list...";d.get("/nodes/home/edit_list").then(function(c){c=c.data.references.Node[c.data.folder_ref.key];c.steps_refs.push({ref:"Node",key:a.node.key});d.post("/nodes",{nodes:[c]}).then(function(){a.editStatus="Sketch added to iPad edit list"},function(c){a.editStatus="Failed to write edit list: "+c.status})},function(c){a.editStatus="Failed to read home collection: "+c.status})};a.refreshNode=function(c){c.preventDefault();b.getNode(a.node.key,
!0);a.refreshingNode=!0};var c=function(){a.ytPlayer&&(a.node._video&&a.node._video.youtube_id)&&a.ytPlayer.cueVideoById(a.node._video.youtube_id)};a.$watch("node._video.youtube_id",c);a.$watch("ytPlayer",c)}]);angular.module("controllers.editor").controller("LessonEditorCtrl",["$scope","nodedb","$routeParams","$location","content","api","$timeout","mediaUpload","bulkImporter",function(a,b,d,c,e,f,g,h,j){var l=function(){return"You have unsaved changes, leaving this page may cause important things not to be saved."};f.get("/code_packages?fresh=true").success(function(a){b.codePackages=a.packages;console.log(b.codePackages)}).error(function(){alert("Error fetching Programming quiz template information.  The editor will not workfor programming quizzes.  Try re-loading the page, if this message appears again tell Mike")});
a.$watch("doNotPostProcessUploads",function(){b.doNotPostProcessUploads=a.doNotPostProcessUploads});a.$watch("dirty",function(c){c&&(window.onbeforeunload=l);!c&&!a.uploading&&(window.onbeforeunload=void 0)});a.$watch("uploading",function(c){c&&(window.onbeforeunload=l);!c&&!a.dirty&&(window.onbeforeunload=void 0)});a.$on("$locationChangeStart",function(c){if(a.dirty||a.uploading)window.confirm("You will lose any unsaved changes if you leave this page.  Are you sure?")||c.preventDefault()});a.$watch(function(){return d.courseKey},
function(){a.courseKey=d.courseKey;"new"!==a.courseKey&&b.getNode(a.courseKey,!0)});a.$watch(function(){return b.getNode(a.courseKey)},function(){a.course=b.getNode(a.courseKey);a.courseKeyForViewer=a.course?"c-"+a.course.key:"none"});a.$on("selectNode",function(c,b){a.selectedNode=b.node});b.addEventListener("nodeUpdate",function(c){a.selectedNode&&a.selectedNode.key===c&&g(function(){a.selectedNode=b.getNode(c)},0)});a.$on("droppedNode",function(c,d){var e=b.getNode(d.droppedKey);if(void 0!==d.droppedOn){if(0<=
a.nodeIndex(d.droppedOn)){if(d.droppedOn.key===d.droppedKey)return;a.moveToAfter(e,d.droppedOn)}a.selectedNode&&"Exercise"===a.selectedNode.model&&(a.selectedNode.lecture_ref&&a.selectedNode.lecture_ref.key===e.key&&(a.selectedNode.lecture_ref=null),a.selectedNode.quiz_ref&&a.selectedNode.quiz_ref.key===e.key&&(a.selectedNode.quiz_ref=null),a.selectedNode.answer_ref&&a.selectedNode.answer_ref.key===e.key&&(a.selectedNode.answer_ref=null),_.each(a.selectedNode.tidbits,function(a){a.tidbit_ref.key===
e.key&&(a.tidbit_ref=null)}))}else a.removeStep(e)});a.$watch(function(){return d.lessonKey},function(){a.lessonKey=d.lessonKey;if("new"===a.lessonKey){var f=e.newLesson(),g="";d.courseKey&&(g+="/c-"+d.courseKey);g+="/l-"+f.key;c.path(g)}else b.getNode(a.lessonKey,!0,2)});b.addEventListener("nodeUpdate",function(c){c===a.lessonKey&&g(function(){a.lesson=b.getNode(a.lessonKey);a.dirty=!1})});a.nodeIndex=function(c){if(!c)return!1;for(var b=0;b<a.lesson.steps_refs.length;b++)if(a.lesson.steps_refs[b].key===
c.key)return b;return-1};a.addStep=function(c,b){if(void 0===b||b>a.lesson.steps_refs.length)b=a.lesson.steps_refs.length;a.lesson.steps_refs.splice(b,0,{ref:"Node",key:c.key})};a.removeStep=function(c){for(var b=0;b<a.lesson.steps_refs.length;b++)if(a.lesson.steps_refs[b].key===c.key)return b=a.lesson.steps_refs.splice(b,1)[0],a.selectedNode===c&&(a.selectedNode=void 0),b};a.clickRemoveNode=function(c){confirm("Are you sure you want to delete this node?")&&a.removeStep(c)};a.moveToAfter=function(c,
b){var d=a.nodeIndex(b);if(-1===d)return!1;a.removeStep(c);d=a.nodeIndex(b)+1;a.addStep(c,d)};a.saveLesson=function(){b.saveTreeFrom(a.lesson,2)&&(a.dirty=!1)};a.bulkImport=function(c){c?j.prepFromFileInputElement(c):(c=j.run(),angular.forEach(c,function(c){a.addStep(c)}))};a.isSelected=function(c){return a.selectedNode===c};a.isHovered=function(c){return a.hoveredNode===c};a.addNewNode=function(c){c.affiliate_program_refs=angular.copy(a.lesson.affiliate_program_refs);a.addStep(c);a.selectedNode=
c};a.newVideoMorsel=function(){var c=e.newVideo();a.addNewNode(c)};a.newFrameMorsel=function(){var c=e.newFrame();a.addNewNode(c)};a.newSketchMorsel=function(){var c=e.newSketch();a.addNewNode(c)};a.newQuizMorsel=function(){var c=e.newQuiz();a.addNewNode(c)};a.newGradedCodeMorsel=function(){var c=e.newQuiz();c.evaluator=new e.CodeGradedEvaluator;a.addNewNode(c)};a.newProgrammingMorsel=function(){var c=e.newProgram();a.addNewNode(c)};a.newHTMLMorsel=function(){var c=e.newProgram();c.evaluator=new e.IFrameEvaluator;
a.addNewNode(c)};a.newExerciseNode=function(){var c=e.newExercise();a.addNewNode(c)};a.emptyClick=function(c){c&&c.preventDefault();a.selectedNode=void 0};a.$watch("lesson",function(){a.lesson&&b.isDirty(a.lesson)&&(a.dirty=!0)},!0);a.$watch("selectedNode",function(){a.selectedNode&&b.isDirty(a.selectedNode)&&(a.dirty=!0);a.selectedNodeBusy=a.selectedNode&&h.isKeyEnqueued(a.selectedNode.key)},!0);a.$on("childNodeDirty",function(){a.dirty=!0});b.addEventListener("keyChange",function(c){a.selectedNode&&
a.selectedNode.key in c&&(a.selectedNode=b.getNode(c[a.selectedNode.key]))});b.addEventListener("network",function(c){a.busyText=c});h.addEventListener("started",function(){g(function(){a.uploading=!0},0)});h.addEventListener("allFinished",function(){g(function(){a.uploading=!1},0)});h.addEventListener("finished",function(c){a.selectedNode&&a.selectedNode.key===c.nodeKey&&g(function(){a.selectedNodeBusy=!1},0)});h.addEventListener("error",function(c){a.selectedNode&&a.selectedNode.key===c.nodeKey&&
g(function(){a.selectedNodeBusy=!1},0)})}]);angular.module("controllers.editor").filter("selected",["$filter",function(){return function(a,b,d){return b?d:a}}]).filter("caseInsensitiveSubstring",["$filter",function(){return function(a,b){return _.filter(a,function(a){return a.name&&-1!==a.name.toLowerCase().indexOf(b.toLowerCase())})}}]).controller("ProgrammingGradingCtrl",["$scope","content","nodedb","$filter",function(a,b,d){a.selectedGradingTab="test";a.codePackages=d.codePackages;a.searchText="";a.checked=!1;a.keyToPackage={};angular.forEach(a.codePackages,
function(c){a.keyToPackage[c.key]=c});a.$watch("evaluator",function(){a.tempLegacyTemplateRefs=[];angular.forEach(a.evaluator.legacy_template_refs,function(c){a.tempLegacyTemplateRefs.push(a.keyToPackage[c.key])})});a.updateTemplateRefs=function(){a.evaluator.legacy_template_refs=[];angular.forEach(a.tempLegacyTemplateRefs,function(c){a.evaluator.legacy_template_refs.push({ref:"ProgramTemplate",key:c.key})})};a.clearTemplateRefs=function(){a.evaluator.legacy_template_refs=[];a.tempLegacyTemplateRefs=
[]};a.setTestFile=function(c){a.$apply(function(a){if(0!==c.files.length){var b=new FileReader;b.onload=function(){a.$apply(function(a){a.evaluator.executor_grading_code=b.result})};b.readAsText(c.files[0])}})};a.setGradingFile=function(c){a.$apply(function(a){if(0!==c.files.length){var b=new FileReader;b.onload=function(){a.$apply(function(a){a.evaluator.gae_grading_code=b.result})};b.readAsText(c.files[0])}})}}]).controller("IFrameGradingCtrl",["$scope","content","nodedb",function(a){a.selectedGradingTab=
"html";a.htmlName="file.html";a.jsName="file.js";a.setGradingFile=function(b){a.$apply(function(a){if(0!==b.files.length){var c=new FileReader;c.onload=function(){a.$apply(function(a){a.evaluator.gae_grading_code=c.result})};c.readAsText(b.files[0])}})};a.setHTMLFile=function(b){a.$apply(function(a){if(0!==b.files.length){var c=new FileReader;c.onload=function(){a.$apply(function(a){a.evaluator.html_body=c.result})};c.readAsText(b.files[0])}})};a.setJSFile=function(b){a.$apply(function(a){if(0!==
b.files.length){var c=new FileReader;c.onload=function(){a.$apply(function(a){a.evaluator.js_application=c.result})};c.readAsText(b.files[0])}})}}]).controller("ProgrammingCtrl",["$scope","content","nodedb",function(a,b){a.$watch("node",function(){a.updatePrimaryEvaluator()});a.updatePrimaryEvaluator=function(){a.node||(a.evaluator=void 0);for(var b=a.node.evaluator;b.evaluator;)b=b.evaluator;a.evaluator=b};a.selectedUserTab=0;a.userTabClick=function(b){a.selectedUserTab=b};a.deleteTabClick=function(b){confirm("Are you sure you want to delete this file?")&&
a.node.initial_code_files.splice(b,1)};a.addFile=function(){a.node.initial_code_files.push(new b.FileAttachement)};a.setFile=function(b,c){a.$apply(function(a){if(0!==b.files.length){var f=new FileReader;f.onload=function(){a.$apply(function(a){a.node.initial_code_files[c].text=f.result})};f.readAsText(b.files[0]);a.node.initial_code_files[c].name=b.files[0].name}})}}]);angular.module("controllers.editor").controller("WidgetCtrl",["$scope",function(a){a.$watch("widget",function(){"MathInputWidget"===a.widget.model&&(a.isMath=!0);if("NumericInputWidget"===a.widget.model){var b=a.evaluatorForMarker(a.widget.marker);b.__upper_bound=String(b.upper_bound);b.__lower_bound=String(b.lower_bound)}});a.$watch("widget.marker",function(){a.updateMarkers()});a.toggleMath=function(){a.widget.model=a.isMath?"MathInputWidget":"TextInputWidget"};a.validateNumeric=function(){a.invalid=
!1;var b=a.evaluatorForMarker(a.widget.marker),d=parseFloat(b.__upper_bound),c=parseFloat(b.__lower_bound);isNaN(d)&&(a.invalid=!0,d=0);isNaN(c)&&(a.invalid=!0,c=0);b.upper_bound=d;b.lower_bound=c;d<c&&(a.invalid=!0)}}]).controller("QuizCtrl",["$scope","nodedb","content",function(a,b,d){a.$watch("node",function(){a.updatePrimaryEvaluator()});a.updatePrimaryEvaluator=function(){a.node||(a.evaluator=void 0);for(var c=a.node.evaluator;c.evaluator;)c=c.evaluator;a.evaluator=c};a.$watch("groupSelected",
function(){a.node&&a.groupSelected&&angular.forEach(a.node.widgets,function(c){if("RadioButtonWidget"===c.model){var b=a.groupSelected[c.group]===c.marker;a.evaluatorForMarker(c.marker).answer=b}})},!0);a.groupName=function(){if(!a.groupNames[a.group]){var c=a.groupNames,b=a.group,d=[];angular.forEach(a.groupNames,function(a){d.push(a)});for(var g=0,h=0;h<d.length;h++)"group"+g===d[h]&&(g++,h=-1);c[b]="group"+g}return a.groupNames[a.group]};a.loadExistingWidgets=function(){a.group=0;a.groupNames=
{};a.groupSelected={};var c=0;angular.forEach(a.node.widgets,function(b){if("RadioButtonWidget"===b.model){var d=b.group,g;angular.forEach(a.groupNames,function(a,c){a===d&&(g=c)});g||(a.groupNames[c]=b.group,c++);a.evaluatorForMarker(b.marker).answer&&(a.groupSelected[b.group]=b.marker)}})};a.groupUp=function(){a.group++};a.groupDown=function(){0<a.group&&a.group--};a.evaluatorForMarker=function(c){if("FormQuizEvaluator"===a.evaluator.model)for(var b=a.evaluator.answer_sets[0].widget_graders,d=0;d<
b.length;d++)if(b[d].marker===c)return b[d];console.warn("no matching evaluator")};a.widgetForMarker=function(c){for(var b=0;b<a.node.widgets.length;b++)if(a.node.widgets[b].marker===c)return a.node.widgets[b]};a.updateMarkers=function(){if(a.isGradedQuiz()&&"LegacyCodeGradedEvaluator"!==a.evaluator.model){a.evaluator.markers=[];for(var c=0;c<a.node.widgets.length;c++)a.evaluator.markers.push(a.node.widgets[c].marker)}};a.nextTabIndex=function(){for(var c=1,b=0;b<a.node.widgets.length;b++)a.node.widgets[b].tabindex>=
c&&(c=a.node.widgets[b].tabindex+1);return c};a.addWidget=function(c,b){c.tabindex=a.nextTabIndex();for(var d=0,g=0;g<a.node.widgets.length;g++)a.node.widgets[g].marker===d.toString()&&(d++,g=-1);c.marker=d.toString();a.node.widgets.push(c);b&&"FormQuizEvaluator"===a.evaluator.model?(b.marker=c.marker,a.evaluator.answer_sets[0].widget_graders.push(b)):("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)&&"TextInputWidget"===c.model&&a.evaluator.markers.push(c.marker)};
a.newRadio=function(){var c=new d.RadioButtonWidget;c.group=a.groupName();var b=new d.SelectionEvaluator;a.addWidget(c,b)};a.newCheckbox=function(){var c=new d.CheckboxWidget,b=new d.SelectionEvaluator;a.addWidget(c,b)};a.newNumberField=function(){var c=new d.NumericInputWidget,b=new d.NumericalEvaluator;a.addWidget(c,b)};a.newRegexField=function(){var c=new d.TextInputWidget,b=new d.RegexEvaluator;a.addWidget(c,b)};a.newMultilineRegexField=function(){var c=new d.TextInputWidget;c.text_area=!0;var b=
new d.RegexEvaluator;a.addWidget(c,b)};a.newUnevaluatedTextField=function(){var c=new d.TextInputWidget;a.addWidget(c)};a.newMultilineUnevaluatedTextField=function(){var c=new d.TextInputWidget;c.text_area=!0;a.addWidget(c)};a.deleteWidget=function(c){for(var b=0;b<a.node.widgets.length&&a.node.widgets[b].marker!==c;b++);if(b!==a.node.widgets.length){var b=a.node.widgets.splice(b,1)[0],d;if("FormQuizEvaluator"===a.evaluator.model){var g=a.evaluator.answer_sets[0].widget_graders;for(d=0;d<g.length;d++)g[d].marker===
c&&g.splice(d,1)}else if("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)for(d=0;d<a.evaluator.markers.length;d++)a.evaluator.markers[d]===c&&a.evaluator.markers.splice(d,1);"RadioButtonWidget"===b.model&&a.groupSelected[b.group]===b.marker&&(a.groupSelected[b.group]=void 0)}};a.updateWidgetPosition=function(c,b,d){if(0>b||0>d||1<b||1<d)return confirm("Are you sure you want to delete this widget?")?(a.$apply(function(a){a.deleteWidget(c)}),!0):!1;var g=a.widgetForMarker(c);
g.placement.x=b;g.placement.y=d;return!0};a.isGradedQuiz=function(){return a.node&&a.evaluator&&("LegacyCodeGradedEvaluator"===a.evaluator.model||"CodeGradedEvaluator"===a.evaluator.model)};a.setFile=function(c){a.$apply(function(a){if(1!==c.files.length)console.warn("Did not select exactly 1 file, so no file prepped for upload"),a.node.__FILE_background_image=void 0,a.node.__URL_background_image=void 0;else{var b=c.files[0];a.node.__FILE_background_image=b;var d=new FileReader;d.onload=function(c){var b=
c.target.result;a.$apply(function(a){a.node.__URL_background_image=b})};d.readAsDataURL(b)}})};a.$watch(function(){return b.getNode(a.node.key)},function(){a.node=b.getNode(a.node.key);a.loadExistingWidgets()})}]);angular.module("controllers.editor").controller("SketchCtrl",["$scope","$timeout","audio",function(a,b,d){a.saving={audio:!1,strokes:!1};a._fullscreen=!1;a.colors={black:"#000000",red:"#FF0000",green:"#00FF00",blue:"#0000FF"};a.activeColor=a.colors.black;a.lineWidth=0.003;a.setColor=function(c){a.activeColor=c};a.fullscreen=function(c){return a._fullscreen?c+" fullscreen":c};a.setFullscreen=function(){if(!a._fullscreen){a._fullscreen=!0;var c=document.getElementById("sketch-recorder"),b=$("#sketch-container"),
d=$(window).width(),f=$(window).height(),g=d-1,j=f-38;1<9*g/(16*j)?(c.width=16*j/9,c.height=j):(c.width=g,c.height=9*g/16);b.width(d);b.height(f);e=Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2))}};a.unsetFullscreen=function(){if(a._fullscreen){a._fullscreen=!1;var c=document.getElementById("sketch-recorder"),b=$("#sketch-container");c.width=640;c.height=360;b.css("width","auto");b.css("height","auto");e=Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2))}};a.$watch("selectedMorsel",function(){a.reset()});
a.reset=function(){a.clear();j=[];a.record=!1;a.stopped=!0;a.down=!1;a.startTime=0;a.sketchTime=0};a.save=function(){a.saving.audio=!0;a.saving.strokes=!0;a.uploadMediaBlob(a.wavBlob(),"audio",function(){a.$apply(function(a){a.saving.audio=!1})});a.uploadMediaBlob(a.strokesBlob(),"strokes",function(){a.$apply(function(a){a.saving.strokes=!1})})};a.load=function(){UY.ajaxREST("GET /nodes/"+a.node.key+"/strokes",{},function(a){j=$.parseJSON(a).visual});a.node._audio_in_progress&&UY.ajaxREST("GET /nodes/"+
a.node.key+"/audio_in_progress",{},function(){});a.node._audio&&UY.ajaxREST("GET /nodes/"+a.node.key+"/audio",{},function(){})};a.$watch(function(){return d.currentTime()},function(){a.audioTime=d.currentTime()});a.startRecording=function(){d.startRecording();a.clear();a.stop();j=[];a.record=!0;a.startTime=(new Date).getTime()};a.stopRecording=function(){d.stopRecording();a.record=!1};a.clear=function(){f.clearRect(0,0,c.width,c.height);a.sketchTime=0;a.stroke=0;a.index=0};a.drawWaveform=function(){h.clearRect(0,
0,g.width,g.height);h.fillStyle="#000000";a.bounds&&h.fillRect(d.waveformIndexFromTime(a.bounds.inpoint),0,d.waveformIndexFromTime(a.bounds.outpoint-a.bounds.inpoint),31);if(d.waveform)for(var c=0;c<d.waveform.length;c++){var b=c+0.5;if(d.waveformCurrentIndex()===c)h.strokeStyle="#000099",h.beginPath(),h.moveTo(b,0),h.lineTo(b,31);else{h.strokeStyle=a.bounds&&c>d.waveformIndexFromTime(a.bounds.inpoint)&&c<d.waveformIndexFromTime(a.bounds.outpoint)?"#55FFFF":"#990000";var e=Math.floor(d.waveform[c]/
0.0667),f=15-e,e=16+e;h.beginPath();h.moveTo(b,f);h.lineTo(b,e)}h.stroke()}};a.stop=function(){a.stopped=!0;d.stop()};a.play=function(){a.stopped=!1;d.play()};a.$watch("audioTime",function(){a.record||a.seek(a.audioTime);a.drawWaveform()});a.seek=function(b){b<a.sketchTime&&a.clear();if(0!==j.length&&!(a.stroke>=j.length)){var d=!0;a.activeColor=j[a.stroke].meta.color;a.lineWidth=j[a.stroke].meta.width;for(0<a.index&&a.index--;a.sketchTime<b;){var g=j[a.stroke].points_and_times[a.index];a.sketchTime=
g[2];0===a.index||d?(d=!1,f.beginPath(),f.strokeStyle=a.activeColor,f.lineWidth=a.lineWidth*e,f.moveTo(g[0]*c.width,g[1]*c.height)):f.lineTo(g[0]*c.width,g[1]*c.height);a.index++;if(a.index===j[a.stroke].points_and_times.length){f.stroke();a.index=0;a.stroke++;if(a.stroke>=j.length)return;a.activeColor=j[a.stroke].meta.color;a.lineWidth=j[a.stroke].meta.width}}f.stroke()}};a.activeColorClass=function(c){return c===a.activeColor?"color-patch active":"color-patch"};a.mouseDown=function(b){if(a.record){var d=
b.offsetX,b=b.offsetY;f.beginPath();f.moveTo(d,b);a.down=!0;a.sketchTime=((new Date).getTime()-a.startTime)/1E3;l=[[d/c.width,b/c.height,a.sketchTime]]}};a.mouseUp=function(b){if(a.record){var d=b.offsetX,b=b.offsetY;a.down=!1;f.stroke();a.sketchTime=((new Date).getTime()-a.startTime)/1E3;l.push([d/c.width,b/c.height,a.sketchTime]);j.push({type:"stroke",meta:{color:a.activeColor,width:a.lineWidth},points_and_times:l})}};a.mouseMove=function(b){if(a.record){var d=b.offsetX,b=b.offsetY;a.down&&(f.lineTo(d,
b),f.strokeStyle=a.activeColor,f.lineWidth=a.lineWidth*e,f.stroke(),f.beginPath(),f.moveTo(d,b),a.sketchTime=((new Date).getTime()-a.startTime)/1E3,l.push([d/c.width,b/c.height,a.sketchTime]))}};a.timelineMouseDown=function(c){var b=document.getElementById("waveform").offsetLeft,c=d.timeFromWaveformIndex(c.clientX-b);c>d.duration()&&(c=d.duration());a.timelineDown=!0;a.bounds={inpoint:c,outpoint:c,start:c};d.seek(c)};a.timelineMouseUp=function(){a.timelineDown=!1;d.seek(a.bounds.inpoint)};a.timelineMouseMove=
function(c){if(a.timelineDown){var b=document.getElementById("waveform").offsetLeft,c=d.timeFromWaveformIndex(c.clientX-b);c>d.duration()&&(c=d.duration());d.seek(c);c<=a.bounds.start?(a.bounds.inpoint=c,a.bounds.outpoint=a.bounds.start):(a.bounds.outpoint=c,a.bounds.inpoint=a.bounds.start)}};a.cut=function(c){if(c){for(var b=c.outpoint-c.inpoint,e=0;e<j.length;e++)for(var f=0;f<j[e].points_and_times.length;f++){var g=j[e].points_and_times[f];g[2]>c.inpoint&&(g[2]=g[2]<c.outpoint?c.inpoint:g[2]-b)}d.cut(c);
a.bounds=void 0;a.drawWaveform()}};a.duration=function(){return d.duration()};a.waveform=function(){return d.waveform};a.playIndex=function(){return d.playIndex};a.strokesBlob=function(){return new Blob([JSON.stringify({visual:j,aspect:c.width/c.height})],{type:"application/json"})};a.wavBlob=function(){return WavEncoder(d.buffer)};a.uploadMediaBlob=function(c,b,d){UY.ajaxREST("GET /nodes/"+a.node.key+"/"+b+"/upload_url?fresh=true",{},function(a){var e=new FormData;e.append("file",c);var f=new XMLHttpRequest;
f.addEventListener("load",function(a){200!==a.srcElement.status?(alert("Error saving "+b+"\n"+a),d("ERROR")):d("COMPLETE")},!1);f.addEventListener("error",function(a){alert("Error saving "+b+"\n"+a);d("ERROR")},!1);f.open("POST",a.url);f.setRequestHeader("X-XSRF-Token",document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2]);f.send(e)})};var c=document.getElementById("sketch-recorder"),e=Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2)),f=c.getContext("2d"),g=document.getElementById("waveform"),
h=g.getContext("2d"),j=[],l=[];d.addEventListener("bufferRead",function(){a.$apply(function(a){a.audioTime=d.currentTime()})});d.addEventListener("end",function(){a.$apply(function(a){a.stopped=!0})});document.addEventListener("keypress",function(c){105===c.keyCode&&(a.bounds?a.bounds.inpoint=a.audioTime:a.bounds={inpoint:a.audioTime,outpoint:a.audioTime,start:a.audioTime},a.bounds.inpoint>a.bounds.outpoint&&(a.bounds.outpoint=a.bounds.inpoint),a.drawWaveform());111===c.keyCode&&(a.bounds?a.bounds.outpoint=
a.audioTime:a.bounds={inpoint:a.audioTime,outpoint:a.audioTime,start:a.audioTime},a.bounds.outpoint<a.bounds.inpoint&&(a.bounds.inpoint=a.bounds.outpoint),a.drawWaveform());32===c.keyCode&&(a.stopped?a.play():a.stop());120===c.keyCode&&a.$apply(function(){a.cut(a.bounds)})});a.reset()}]);angular.module("controllers.myCourses").controller("myCourses",["$scope","content","auth","user","$location","dummyData",function(a,b,d,c,e){c.fetchFullUser();a.userKey="me";a.nodesLoaded=!1;a.getEnrollmentKeys=function(a){var d=c.getUserProp("enrollments");if(null===d)return[];d=_.filter(d,function(c){return c.is_enrolled===a});d=_.map(d,function(a){return a.node_key});d.sort(function(a,c){return b.getLastInteractionDate(c,"me")-b.getLastInteractionDate(a,"me")});return d};$(".tool-tip").tooltip();
a.allKeys=_.map(c.getBaseUser().enrollments,function(a){return a.node_key});d=e.search();a.newClass=d.newClass;d=d.expand;a.expand=_.contains(a.allKeys,d)?d:void 0;a.firstName=c.getBaseUser().firstName;b.addEventListener("loadNodesComplete",function(){_.each(a.allKeys,function(a){b.setMasteryPoints(a,"me")});if(a.expand){var c=b.getChildrenKeys(a.expand);b.addEventListener("loadNodesComplete",function(){a.nodesLoaded=!0});b.loadNodes(c,["me"],a.expand)}else a.nodesLoaded=!0},{removeAfterFired:!0});
b.loadNodes(a.allKeys,["me"])}]);angular.module("controllers.reviews").controller("reviewForm",["$scope","api","$window","user","nodeKey","nodeUrl",function(a,b,d,c,e,f){a.buttonDisabled=!1;a.countWords=function(a){return a?a.split(" ").length:0};var g=null,h=null;a.getAuthor=function(){return c.getUser()};a.setPotentialRating=function(a){g=a};a.getPotentialRating=function(){return g};a.getRating=function(){return h};a.setRating=function(a){1<=a&&5>=a&&(g=null,h=a)};a.setupReviewText=function(c){a.reviewText=decodeURIComponent(c)};
a.submitReview=function(){a.serverError=!1;if(h&&20<=a.countWords(a.reviewText)){var c={user_key:"me",score_type:"stars5",score_str:h.toString(),text:a.reviewText,fresh:!0};a.buttonDisabled=!0;b.post("/users/me/reviews/"+encodeURIComponent(e),c).success(function(){d.location.href=f}).error(function(c){a.serverError=c.error||"Somthing went wrong on our end, please try again!";a.buttonDisabled=!1})}else a.submitAttempted=!0}}]);angular.module("controllers.settings").config(["$routeProvider","cacheVersion",function(a,b){a.when("/profile",{templateUrl:"/templates/angular/settings/profile.html?"+b,controller:"userSettings"}).when("/settings",{templateUrl:"/templates/angular/settings/site_settings.html?"+b,controller:"siteSettings"}).otherwise({templateUrl:"/templates/angular/settings/account.html?"+b,controller:"userSettings"})}]).controller("userSettings",["$scope","api","user","validator",function(a,b,d,c){function e(a,c){c.usr=
angular.copy(a);c.accountErrors={};c.profileErrors={};c.profileErrorsFlat=[];c.usr.currentPassword="";c.usr.newPassword="";c.usr.newPasswordRept="";c.usr.locCache="undefined"!==typeof c.usr.location&&null!==c.usr.location?angular.copy(c.usr.location):{};c.submitSuccess=!1;$("[rel=tooltip]").length&&$("[rel=tooltip]").tooltip()}function f(a,c,b,d){b="function"===typeof b?b:function(a,c){console.log("it made it!");console.log({data:a,e:c})};d="function"===typeof d?d:function(a,c){console.warn("it failed!");
console.warn({data:c,e:a})};$(a).fileupload({dataType:"json",type:"POST",forceIframeTransport:!0,done:b,fail:d});$(a).fileupload("add",{fileInput:$(a),url:c})}function g(c){d.setUser(d.translateUserFromApi(c.user));a.submitSuccess=!0;$("body").animate({scrollTop:0},300,function(){$("#account-success").animate({backgroundColor:"#76D576"},100).animate({backgroundColor:"#FFFFFF"},300)})}function h(c,b){400===b?a.accountErrors.linkedAccounts=[c.error]:a.accountErrors.settingsGeneralError=[c.error]}d.fetchFullUser();
d.addEventListener("userChanged",function(c){e(c.user,a)},{removeOnDestructionOf:a});e(d.getUser(),a);a.saveProfileSettings=function(e){a.profileErrors={};a.profileErrorsFlat=[];a.submitSuccess=!1;if(null===e.location||"undefined"===typeof e.location.places)if(angular.equals(a.usr.locCache,{})&&(null===e.location||""===e.location.displayPlace))a.usr.location=null;else{a.usr.location=a.usr.locCache;a.profileErrorsFlat=["Please select a city from one of the suggested locations in the drop-down list."];
return}var f=c.check({});if(f.valid)f={occupation:e.occupation,bio:e.bio,linkedin_url:e.linkedinUrl,website_url:e.websiteUrl,nickname:e.nickname,employer_sharing:e.employerSharing},e.location&&(f.location={display_place:e.location.displayPlace,places:e.location.places,coordinates:e.location.coordinates}),b.post("/users/me",f).success(function(c){d.setUser(d.translateUserFromApi(c.user));a.submitSuccess=!0;$("body").animate({scrollTop:0},300,function(){$("#profile-success").animate({backgroundColor:"#76D576"},
100).animate({backgroundColor:"#FFFFFF"},300)})}).error(function(){});else{for(var g in f.errorText)if(f.errorText.hasOwnProperty(g))for(e=0;e<f.errorText[g].length;e++)a.profileErrorsFlat.push(f.errorText[g][e]);setTimeout(function(){$("body").animate({scrollTop:$("#profile-errors").offset().top-40},300)},1)}};a.resumeUpload=function(c){$(c).val()&&b.get("/users/me/resume/upload_url").success(function(b){f(c,b.url,function(){a.$apply(function(){a.usr.resume={url:"/api/users/me/resume?"+Math.random()};
a.setsChangeResume=!1})});return!1}).error(function(c,b,d,e){a.profileErrorsFlat=["Oops! Something happened when we tried to upload yourfile. Please refresh the page and try again."];console.warn("Getting upload URL failed!");console.warn({data:c,status:b,headers:d,config:e})});return!1};a.avatarUpload=function(c){$(c).val()&&b.get("/users/me/image/upload_url").success(function(b){f(c,b.url,function(c,b){a.$apply(function(){try{a.usr.imageUrl=b.result.media.serving_url}catch(c){}})})}).error(function(c,
b,d,e){a.profileErrorsFlat=["Oops! Something happened when we tried to upload yourfile. Please refresh the page and try again."];console.warn("Getting upload URL failed!");console.warn({data:c,status:b,headers:d,config:e})});return!1};a.saveAccountSettings=function(e){a.submitSuccess=!1;a.accountErrors={};var f={setsFirstName:{pretty:"first name",value:e.firstName,validators:[{type:"required"}]},setsLastName:{pretty:"last name",value:e.lastName,validators:[{type:"required"}]},setsEmail:{pretty:"email address",
value:e.email.address,validators:[{type:"required",chained:[{type:"email"}]}]},setsCurrPass:{pretty:"password",value:e.currentPassword,validators:[{type:"required",failMsg:"The current password is required when changing the account password.",disabled:!d.getUser().hasPassword||""===e.newPassword&&""===e.newPasswordRept}]},setsNewPass:{pretty:"new password",value:e.newPassword,validators:[{type:"strLen",args:[6,void 0],disabled:""===e.newPassword}]},setsNewPassRept:{pretty:"new password confirmation",
value:e.newPasswordRept,validators:[{type:"required",failMsg:"A password confirmation is required when changing the account password.",disabled:""===e.newPassword,chained:[{type:"equal",args:[e.newPassword,"password"]}]}]}},f=c.check(f);if(f.valid){var h={first_name:e.firstName,last_name:e.lastName,email_preferences:{master_ok:e.emailPreferences.masterOK}};e.email.address!==d.getUser().email.address&&(h.email_address=e.email.address);""!==e.newPassword&&(h.password=e.newPassword,h.existing_password=
e.currentPassword);b.post("/users/me",h).success(g).error(function(c,b){403===b?a.accountErrors.setsCurrPass=[c.error]:a.accountErrors.settingsGeneralError=[c.error];var d=Number.POSITIVE_INFINITY,e;for(e in a.accountErrors)a.accountErrors.hasOwnProperty(e)&&(e=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),$("#"+e).offset().top<d&&(d=$("#"+e).offset().top));$("body").animate({scrollTop:d-50},300)})}else{a.accountErrors=f.errorText;e=Number.POSITIVE_INFINITY;for(h in f.errorText)f.errorText.hasOwnProperty(h)&&
(h=h.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),$("#"+h).offset().top<e&&(e=$("#"+h).offset().top));$("body").animate({scrollTop:e-50},300)}};a.removeFacebookId=function(){b.post("/users/me",{remove_facebook_id:!0}).success(g).error(h)};a.removeGoogleId=function(){b.post("/users/me",{remove_google_id:!0}).success(g).error(h)};a.proFormComplete=function(){var c=a.usr,c=0+("string"===typeof c.nickname&&0<c.nickname.length)+("string"===typeof c.websiteUrl&&0<c.websiteUrl.length)+("string"===typeof c.linkedinUrl&&
0<c.linkedinUrl.length)+(typeof("object"===c.location)&&c.location&&"string"===typeof c.location.displayPlace&&0<c.location.displayPlace.length)+("string"===typeof c.occupation&&0<c.occupation.length)+("string"===typeof c.bio&&0<c.bio.length)+("string"===typeof c.imageUrl&&0<c.imageUrl.length&&!/robohash\.org/.test(c.imageUrl))+("object"===typeof c.resume&&null!==c.resume&&"string"===typeof c.resume.url&&0<c.resume.url.length);return Math.ceil(100*c/8)}}]);angular.module("controllers.settings").controller("siteSettings",["$scope","api","user","validator",function(a,b,d){a.videoQualities=[{label:"Automatic",value:"default"},{label:"360p",value:"medium"},{label:"480p",value:"large"},{label:"720p",value:"hd720"},{label:"1080p",value:"hd1080"}];a.playbackRates=[{label:"0.25x",value:0.25},{label:"0.5x",value:0.5},{label:"Normal",value:1},{label:"1.5x",value:1.5},{label:"2x",value:2}];d.addEventListener("userChanged",function(){var c=d.getUserProp("sitePreferences");
a.settings=c?{useHtml5Player:c.useHtml5Player,autoAdvance:c.autoAdvance,playbackRate:_.find(a.playbackRates,function(a){return a.value===c.playbackRate}),videoQuality:_.find(a.videoQualities,function(a){return a.value===c.videoQuality})}:{useHtml5Player:!0,autoAdvance:!0,playbackRate:a.playbackRates[2],videoQuality:a.videoQualities[0]}},{replayLast:!0});a.saveClassroomSettings=function(){b.post("/users/me",{site_preferences:{use_html5_player:a.settings.useHtml5Player,auto_advance:a.settings.autoAdvance,
playback_rate:a.settings.playbackRate.value,video_quality:a.settings.videoQuality.value}}).success(function(c){d.setUser(d.translateUserFromApi(c.user));a.submitStatus="success"}).error(function(){a.submitStatus="error"})}}]);angular.module("controllers.lesson").controller("classroomPlayer",["$scope","lesson","$timeout",function(a,b,d){a.isPlayerLoading=!0;a.loadingComplete=function(c){c?d(function(){a.$apply(function(){a.isPlayerLoading=!1})},0,!1):a.isPlayerLoading=!1};b.addEventListener("pendingMorselChange",function(c){a.isPlayerLoading=c.from&&("Video"===c.from.model||"SketchVideo"===c.from.model)&&("Video"===c.to.model||"SketchVideo"===c.to.model)?!1:!0})}]);angular.module("controllers.lesson").controller("imageQuizPanel",["$scope","lesson","imageQuiz","tidbits",function(a,b,d,c){a.attempted=!1;a.correctlyAnswered=!1;a.status="unsubmitted";a.quizReturn=null;a.isTidbitAvailable=function(a){return c.isTidbitRelevant(a,a.tidbit_ref.containingExercise.quiz_ref.binCodes)};a.isTidbitRelevant=function(b){return a.quizReturn&&c.isTidbitRelevant(b,a.quizReturn.binCodes,!0)};a.submitQuiz=function(){a.quizReturn=null;a.status="processing";d.submit()};a.getSubmitButtonLabel=
function(){return"processing"===a.status?"Processing":"Submit Answer"};b.addEventListener("morselChange",function(){a.quizReturn=null;a.attempted=!1;a.correctlyAnswered=!1;a.status="unsubmitted"},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("correct",function(c){a.attempted=!0;a.status="correct";a.correctlyAnswered=!0;a.quizReturn={status:"correct",text:c.comment,binCodes:c.binCodes}},{removeOnDestructionOf:a}).addEventListener("incorrect",function(c){a.attempted=!0;a.status="incorrect";
a.quizReturn={status:"incorrect",text:c.comment,binCodes:c.binCodes}},{removeOnDestructionOf:a}).addEventListener("error",function(c){a.attempted=!0;a.status="error";a.quizReturn={status:"error",text:c.comment}},{removeOnDestructionOf:a}).addEventListener("recorded",function(c){a.status="recorded";a.quizReturn={status:"recorded",text:c.comment}})}]);angular.module("controllers.lesson").controller("programmingQuizOutputPanel",["$scope","lesson","programmingQuiz",function(a,b,d){a.status="unsubmitted";a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.run=function(){d.run();a.status="processing";a.stdout=null;a.stderr=null;a.images=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Test Run"};a.reset=function(){window.confirm("Are you sure you want to reset to the original assignment stub?")&&d.reset()};b.addEventListener("morselChange",
function(){a.stdout=null;a.stderr=null;a.images=null;a.ready=!1;a.status="unsubmitted"},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("run",function(c){a.status="evaluated";a.stdout=c.result.stdout;a.stderr=c.result.stderr;a.images=c.result.images;if(!a.stdout&&!a.stderr&&(!a.images||0===a.images.length)&&!a.isEmbeddingIframe)a.stdout="Your code didn't display any output"},{removeOnDestructionOf:a});d.addEventListener("runError",function(){a.stderr="The server encountered an error. Please try running again.";
a.status="error"},{removeOnDestructionOf:a});d.addEventListener("ready",function(){a.ready=!0},{removeOnDestructionOf:a})}]);angular.module("controllers.lesson").controller("programmingQuizPanel",["$scope","lesson","programmingQuiz","tidbits",function(a,b,d,c){a.status="unsubmitted";a.quizReturn=null;a.attempted=!1;a.answeredCorrectly=!1;a.submitProgrammingQuiz=function(){d.submit();a.status="processing";a.quizReturn=null};a.getSubmitButtonLabel=function(){return"processing"===a.status?"Processing":"Submit"};a.isTidbitAvailable=function(a){return c.isTidbitRelevant(a,a.tidbit_ref.containingExercise.quiz_ref.binCodes)};
a.isTidbitRelevant=function(b){return a.quizReturn&&c.isTidbitRelevant(b,a.quizReturn.binCodes,!0)};b.addEventListener("morselChange",function(){a.quizReturn=null;a.attempted=!1;a.answeredCorrectly=!1},{replayLast:!0,removeOnDestructionOf:a});d.addEventListener("evaluated",function(c){a.status="evaluated";a.attempted=!0;var c=c.result,b=Math.round(100*(c.score.points_earned/c.score.points_possible));a.quizReturn={status:100===b?"correct":"incorrect",text:c.comment,binCodes:c.bin_codes};100===b&&(a.answeredCorrectly=
!0)},{removeOnDestructionOf:a});d.addEventListener("evaluationError",function(){a.status="error";a.attempted=!0;a.quizReturn={status:"incorrect",text:"There was an error grading your quiz, please try submitting again."}},{removeOnDestructionOf:a})}]);angular.module("udacity.viewer").config(["$routeProvider","tags",function(a,b){a.when("/"+b.course+":courseKey/"+b.lesson+":lessonKey/"+b.exercise+":exerciseKey/"+b.morsel+":morselKey").when("/"+b.course+":courseKey/"+b.lesson+":lessonKey/"+b.morsel+":morselKey").when("/"+b.course+":courseKey/"+b.lesson+":lessonKey").when("/"+b.course+":courseKey")}]);
angular.module("controllers.lesson").constant("videoViewedTimeThreshold",3).constant("tags",{course:"c-",lesson:"l-",exercise:"e-",morsel:"m-"}).constant("typeForTag",{"c-":"course","l-":"lesson","e-":"exercise","m-":"morsel"}).controller("viewer",["$scope","lesson","$location","$q","$routeParams","$route","lessonActivityTracker","$timeout","videoViewedTimeThreshold","youtubeVideoPlayer","viewerSettings","cacheVersion","loadingMessages","lessonPrefetcher","user","tags","congratulatoryMessages","libraryLoader",
"viewerPartialMap","examMode","techDetect","mixin","$rootScope",function(a,b,d,c,e,f,g,h,j,l,k,m,n,w,p,q,u,r,A,y,x){function s(){var c;c=_.without(_.union(n.general,n[t]),null,void 0,"");a.viewerLoadingMessage=c[_.random(c.length-1)];a.isViewerLoading=!0}function v(c){a.congratulatoryMessageOccasion=c;var b=_.random(0,u[c].length-1);a.congratulatoryMessage=u[c][b];l.pauseVideo()}function B(a,c){if(a){if(A[a.model])return"/templates/angular/viewer/partials/"+A[a.model]+c+"?"+m;console.error("Unrecognized morsel type"+
a.model)}else return"/templates/angular/viewer/partials/loading"+c+"?"+m}function z(a){return function(){if(l.getCurrentTime()>=j){var c=l.getCurrentTime();l.emitEvent("videoPause",c);l.emitEvent("videoPlay",c+1);b.markMorselAsCompleted(a)}else C=h(z(a),500,!1)}}a.course=null;a.lessons=null;a.lesson=null;a.morsels=null;a.morsel=null;var t=d.path().match("/"+q.course+"([^/]+)");(t=t?t[1]:null)?p.getBaseUser().registered||(window.location.href="/course/"+t):window.location.href="/";b.addEventListener("lessonPermissionDenied",
function(){window.location.href="/course/"+t});b.addEventListener("courseChange",function(a){if((!a.lessons||0===a.lessons.length)&&!a.lastLessonVisited&&!e.lessonKey)window.location.href="/course/"+t}).addEventListener("coursePermissionDenied",function(){e.lessonKey||(window.location.href="/course/"+t)});b.addEventListener("lessonChange",function(a){if(!a.morsels||0===a.morsels.length)window.location.href="/course/"+t});a.isViewerLoading=!0;b.addEventListener("courseChange",function(){r.loadLibraries(["codemirror",
"mathquill"]).then(function(){},function(){console.log("Failed to load some libraries!");alert("Failed to load some required parts of the course! Please refresh the page. If this issue persists, please post on the technical support section of the disucssion forum. Thanks!")})}).addEventListener("morselChange",function(){a.isViewerLoading=!1});a.startCourse=function(){a.isStartingCourse=!1;k.set("autoPlay",!0)};a.isStartingCourse=!1;a.goToMyCourses=function(){window.location.href="/my_courses"};a.goToCourseCatalog=
function(){window.location.href="/courses"};a.clearCongratulatoryMessage=function(){a.congratulatoryMessageOccasion=null;a.congratulatoryMessage=null};a.clearCongratulatoryMessage();b.addEventListener("courseChange",function(c){a.course=c.course;a.lessons=c.lessons},{replayLast:!0}).addEventListener("lessonChange",function(c){a.lesson=c.lesson;a.morsels=c.morsels},{replayLast:!0}).addEventListener("morselChange",function(c){a.morsel=c;h.cancel(C);("Video"===c.model||"SketchVideo"===c.model)&&l.addEventListener("videoPlay",
function(){h.cancel(C);C=h(z(c.key),1E3*j,!1)},{removeAfterFired:!0})},{replayLast:!0});b.addEventListener("pendingLessonChange",function(){a.morsels=null;a.morsel=null});a.$on("$routeChangeSuccess",function(c,d,f){if(!f||!d)c=!1;else{var h=f.pathParams,c=d.pathParams;if(_.keys(h).length===_.keys(c).length)c=!1;else{var j=!0;_.each(c,function(a,c){h[c]!==a&&(j=!1)});c=j}}c&&window.history.back();f&&UY.pushTrackPageview();if((null===a.course||a.course.key!==e.courseKey)&&"none"!==e.courseKey)s(),b.addEventListener("courseChange",
function(c){e.lessonKey||(c.hasActivity||(a.isStartingCourse=!0,k.set("autoPlay",!1)),c.lastLessonVisited?a.goToLesson(c.lastLessonVisited.key):a.goToLesson(c.lessons[0].key))},{removeAfterFired:!0}),b.changeCourse(e.courseKey);if((null===a.lesson||a.lesson.key!==e.lessonKey)&&e.lessonKey)s(),b.addEventListener("lessonChange",function(c){e.morselKey||(c.lastMorselVisited?a.goToMorsel(c.lastMorselVisited):a.goToMorsel(c.morsels[0]))},{removeAfterFired:!0}),b.changeLesson(e.lessonKey);if((null===a.morsel||
a.morsel.key!==e.morselKey)&&e.morselKey)g.logNodeVisit(),a.lesson&&a.lesson.key===e.lessonKey?b.changeMorsel(e.morselKey):b.addEventListener("lessonChange",function(){b.changeMorsel(e.morselKey)},{removeAfterFired:!0})});a.alert=function(a){alert(a)};a.log=function(a){console.log(a)};a.getCurrentMorselType=function(){return a.morsel?a.morsel.model:null};a.getStyleClassesForMorsel=function(c){var b="";if(a.morsel)if("Exercise"===c.model){if(c.completed||c.lecture_ref&&c.lecture_ref.completed)b+="is-viewed";
if(c.key===(a.morsel.containingExercise?a.morsel.containingExercise.key:a.morsel.key))b+=" is-current"}else c.completed&&(b+="is-viewed"),a.morsel.key===c.key&&(b+=" is-current");return b};a.getPlayerPartialForCurrentMorsel=function(){return B(a.morsel,"_player.html")};a.getSidePanelPartialForCurrentMorsel=function(){return B(a.morsel,"_side_panel.html")};a.goToMorsel=function(c){(!c||!c.key)&&console.error("Cannot go to invalid morsel "+c);(!a.morsel||c.key!==a.morsel.key)&&h(function(){if("Exercise"===
c.model){var a=c.lecture_ref?c.lecture_ref:c.quiz_ref;b.announcePendingMorselChange(a);d.path("/"+q.course+e.courseKey+"/"+q.lesson+e.lessonKey+"/"+q.exercise+c.key+"/"+q.morsel+a.key)}else b.announcePendingMorselChange(c),c.containingExercise?d.path("/"+q.course+e.courseKey+"/"+q.lesson+e.lessonKey+"/"+q.exercise+c.containingExercise.key+"/"+q.morsel+c.key):d.path("/"+q.course+e.courseKey+"/"+q.lesson+e.lessonKey+"/"+q.morsel+c.key)})};a.goToNextMorsel=function(){var c=a.morsel,b=a.morsels.length;
c.containingExercise&&(c=c.containingExercise);c=c.indexInLesson;c<b-1?a.goToMorsel(a.morsels[c+1]):a.lessons&&a.lesson.key===a.lessons[a.lessons.length-1].key?a.course&&a.course.catalog_entry&&!a.course.catalog_entry.complete?v("endOfIncompleteCourse"):v("endOfCourse"):v("endOfLesson")};a.goToPreviousMorsel=function(){var c=a.morsel;c.containingExercise&&(c=c.containingExercise);c=c.indexInLesson;0<c?a.goToMorsel(a.morsels[c-1]):console.error("Can't go to previous; at beginning of lesson")};a.goToLesson=
function(c){if(!a.lesson||c!==a.lesson.key)b.announcePendingLessonChange(),h(function(){d.path("/"+q.course+e.courseKey+"/"+q.lesson+c)})};a.goToNextLesson=function(){if(a.lessons){var c=a.lessons.length,b=_.find(a.lessons,function(c){return c.key===a.lesson.key}).indexInCourse;0<=b&&b<c-1?a.goToLesson(a.lessons[b+1].key):console.error("Can't go to next; at end of course!")}else console.error("Can't go to next lesson, we're not in a course!")};a.os=x.os(!1);a.isActiveMorsel=function(c){return a.morsel&&
a.morsel.key===c};a.getProgressPercentage=function(){return 77};var C}]);angular.module("services.lesson").constant("loadingMessages",{general:"The instructor is setting up the classroom;Thanks for waiting while we prepare the classroom;Dust off your slide-rule...;Cleaning the whiteboard;Adding duplication fluid to our ditto machine...;Reticulating Splines;Contemplating banana bread recipes;Once you have completed the course, cake will be served;Check the Wiki for each class to find helpful course notes and other information from fellow Udacians!;Did you know you can meet other Udacians on the Forums?".split(";"),
ma006:["We recommend having a pencil and paper handy for this class."],ma008:["We recommend having a pencil and paper handy for this class."],st095:["We recommend having a pencil and paper handy for this class.",'Want to read about some fascinating real-world statistics? Check out Dan Ariely\'s book "Predictably Irrational"!']}).constant("congratulatoryMessages",{endOfLesson:["You made it to the end of the lesson. Great job!"],endOfCourse:["You made it to the end of the last lesson for the course! Fantastic work!"],
endOfIncompleteCourse:["You made it to the end of the lesson. Good work! This is the last lesson available right now, but more will be up soon. We'll send you an email as soon as we add additional content."]});angular.module("directives.lesson").directive("chatTest",["lesson","user","libraryLoader","$timeout","cacheVersion","dateTime","lessonContentContext",function(a,b,d,c,e,f,g){return{restrict:"A",templateUrl:"/templates/angular/chat-test.html?"+e,link:function(e,j){var l=null,k=null;a.addEventListener("lessonChange",function(a){"172950396"===a.lesson.key||"5136918324969472"===a.lesson.key?d.loadLibraries(["https://cdn.firebase.com/v0/firebase.js"]).then(function(){var d=a.lesson.key;e.showChat=!1;e.isChatMinimized=
!1;e.toggleChat=function(){e.isChatMinimized=!e.isChatMinimized};l&&l.off();var w=new Firebase("https://udacity.firebaseio.com/");l=w.child("node-"+d).child("messages");k=w.child("node-"+d).child("logs");w.child("enabled").on("value",function(a){c(function(){e.showChat=a.val();!1===e.showChat&&l&&(l.off(),k.off())})});var p=[];j.find(".chat-input").on("keypress",function(a){13===a.keyCode&&j.find(".send-chat-button").click()});var q,u={updateHistory:function(){e.chatHistory=_.uniq(_.sortBy(p,"id"),
!1,function(a){return a.id});c.cancel(q);q=c(function(){e.$apply();j.find(".chat-history").clearQueue();j.find(".chat-history").scrollTop(j.find(".chat-history").prop("scrollHeight"))},0,!1)}};e.sendChat=function(){e.chatMessage&&(300>e.chatMessage.length?(l.push({sender:b.getUserProp("nickname"),text:e.chatMessage}),k.push({sender:b.getUserProp("nickname"),text:e.chatMessage,accountId:b.getUserProp("key"),fullName:b.getUserProp("firstName")+" "+b.getUserProp("lastName"),time:f.getCurrentAsUTC(),
context:g.getCurrent(),location:window.location.href}),e.chatMessage=""):alert("Sorry, your message is too long, please enter a short message"))};l.limit(10).endAt().on("child_added",function(a){var c=a.val();c.id=a.name();p.push(c);u.updateHistory()});l.on("child_removed",function(a){p=_.reject(p,function(c){return c.id===a.name()});u.updateHistory()});u.updateHistory()}):(e.showChat=!1,l&&(l.off(),k.off()))},{replayLast:!0})}}}]);angular.module("directives.lesson").directive("codeMirrorEditor",["codeMirror","codeEditor",function(a,b){return{restrict:"A",priority:3,link:function(d,c,e){a.attach(c.get(0),{language:e.language,theme:e.theme,autofocus:!0});d.fileCount=null;b.addEventListener("filesLoaded",function(a){d.fileCount=a.files.length},{removeOnDestructionOf:d});d.getActiveLanguage=function(){return a.getActiveLanguage()};d.getAvailableLanguages=function(){return a.getAvailableLanguages()};d.setActiveLanguage=function(c){a.setActiveLanguage(c)};
d.$on("$destroy",function(){a.detach()})}}}]);angular.module("directives.myCourses").directive("courseSummary",["cacheVersion","content","user","canEatDogFood","dummyData",function(a,b,d,c){return{restrict:"A",replace:!1,templateUrl:"/templates/course_summary.html?"+a,scope:{courseKey:"=courseKey",initExpand:"=initExpand"},controller:["$scope",function(a){a.HIGHEST_MASTERY=4;a.MASTERY_LEVELS=[0,1,2,3,4];a.expanded=!1;a.loadingLessons=!1;a.masteryDescription={"0":"In Progress",1:"Proficiency",2:"Accomplishment",3:"High Distinction",4:"Highest Distinction"};
a.isCertificateReady=function(a){return!_.contains([],a)};a.getNodeProperty=b.getNodeProperty;a.getChildrenKeys=b.getChildrenKeys;a.getDifficultyLevel=b.getDifficultyLevel;a.getLevelMasteryPoints=b.getLevelMasteryPoints;a.getNotAvailableMessage=b.getNotAvailableMessage;a.getPositionNumber=b.getPositionNumber;a.hasBehavior=b.hasBehavior;a.isAvailable=b.isAvailable;a.isEnrolledIn=d.isEnrolledIn;a.isEnrolledForCreditIn=d.isEnrolledForCreditIn;a.getMasteryPoints=function(a,c){return b.getMasteryPoints(a,
"me",c)};a.getEarnedMasteryPercentage=function(a){var c=b.getMasteryPoints(a,"me","points_earned"),a=b.getMasteryPoints(a,"me","points_possible");return 0===a||!_.isNumber(c/a)?0:Math.round(100*(c/a))};a.getHighestMasteryBadge=function(a){try{var c=d.getUserProp("badges");return _.find(c,function(c){return"Course Mastery"===c.name&&c.target_ref.key===a})}catch(b){}};a.getHighestMasteryBadgeUrl=function(c){try{return a.getHighestMasteryBadge(c).highest_level_icon_url}catch(b){return"/media/img/site/icons/badge/CourseMastery_beginner_0.png"}};
a.hasCertificate=function(c){try{return 0<a.getHighestMasteryBadge(c).highest_level}catch(b){return!1}};a.getLastChild=function(a){return b.getLastChild(a,"me")};a.getMasteryLevel=function(a){return b.getMasteryLevel(a,"me")};a.getProgress=function(a){return b.getProgress(a,"me")};a.getRemainingDuration=function(a){return b.getRemainingDuration(a,"me")};a.getRemainingEvaluables=function(a){return b.getRemainingEvaluables(a,"me")};a.getRemainingMasteryPoints=function(c,d){var h=b.getLevelMasteryPoints(c,
d),j=a.getMasteryPoints(c,"points_earned"),h=h-j;0>h&&(h=0);return h};a.isOldClass=function(a){return _.contains(["cs101-old","cs373-old","cs271-old"],a)};a.pointText=function(a){return 1===a?"point":"points"};a.hasPermission=function(){return c}}],link:function(a,c){function d(){if(!a.expanded&&(a.loadingLessons=!0,a.$apply(),b.addEventListener("loadNodesComplete",function(c){$(k).slideDown("fast");a.loadingLessons=!1;a.expanded=!0;c.nohttp&&a.$apply()},{removeAfterFired:!0}),a.hasOwnProperty("courseKey"))){var c=
b.getChildrenKeys(a.courseKey);b.loadNodes(c,["me"],a.courseKey)}$(l).off("click")}function h(){$(l).on("click",d);$(l).find(".resume").on("click",function(a){a.stopPropagation()});$(l.find(".course-title span")).on("click",j)}function j(){$(l.find(".course-title span")).off("click");$(k.slideUp("fast",function(){h()}));a.expanded=!1;a.$apply()}var l=c,k=c.find(".details");$(l.find(".tab")).on("click",j);a.initExpand?a.expanded=!0:(h(),$(k).slideToggle("fast"))}}}]);angular.module("directives.utility").directive("creditLink",["user",function(a){return{restrict:"A",scope:{course:"=course",courseKey:"=courseKey",accredited:"=accredited"},controller:["$scope",function(b){b.shouldDisplay=function(){return b.course&&b.course.catalog_entry.accredited&&!a.isEnrolledForCreditIn(b.course.key)||b.courseKey&&b.accredited&&!a.isEnrolledForCreditIn(b.courseKey)}}],template:'<a href="/collegecredit" data-ng-show="shouldDisplay()"><strong>Enroll For College Credit</strong></a>'}}]);angular.module("services.utility").directive("dropdownMenu",[function(){return{restrict:"A",link:function(a,b,d){var c=b.find(d.dropdownMenu);$("body").on("click",function(){c.hide()});if(d.opener)b.on("click",""+d.opener,function(){c.show()});if(d.closer)b.on("click",""+d.closer,function(){c.hide()});if(d.toggler)b.on("click",""+d.toggler,function(){c.toggle()});b.on("click",function(a){a.stopPropagation();a.preventDefault()})}}}]);angular.module("directives.editor").directive("quizWidget",["cacheVersion",function(a){return{restrict:"E",controller:"WidgetCtrl",templateUrl:"/templates/angular/editor/widgets/widget.html?"+a,replace:!0,link:function(a,d){$(d).parent().width();$(d).parent().height();$(d).css({top:100*a.widget.placement.y+"%",left:100*a.widget.placement.x+"%"});$(d).draggable({handle:"img",stop:function(c,e){var f=$(d).parent().width(),g=$(d).parent().height();a.updateWidgetPosition(a.widget.marker,e.position.left/
f,e.position.top/g)||$(d).css({top:100*a.widget.placement.y+"%",left:100*a.widget.placement.x+"%"})}});if("NumericInputWidget"===a.widget.model||"TextInputWidget"===a.widget.model||"MathInputWidget"===a.widget.model)$(d).css({width:100*a.widget.placement.width+"%",height:100*a.widget.placement.height+"%"}),$(d).resizable({stop:function(c,e){var f=$(d).parent().width(),g=$(d).parent().height();a.widget.placement.width=e.size.width/f;a.widget.placement.height=e.size.height/g}})}}}]).directive("radioButtonWidget",
function(){return{restrict:"E",replace:!0,template:'<input type="radio" ng-model="groupSelected[widget[\'group\']]" value="{{widget.marker}}"/>'}}).directive("checkboxWidget",function(){return{restrict:"E",replace:!0,template:"<input type=\"checkbox\" ng-model=\"evaluatorForMarker(widget['marker'])['answer']\" ng-model-instant/>"}}).directive("textInputWidget",["cacheVersion",function(a){return{restrict:"E",replace:!0,templateUrl:"/templates/angular/editor/widgets/text_input.html?"+a}}]).directive("numericInputWidget",
["cacheVersion",function(a){return{restrict:"E",replace:!0,templateUrl:"/templates/angular/editor/widgets/numeric_input.html?"+a}}]).directive("videoNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"VideoCtrl",templateUrl:"/templates/angular/editor/nodes/video.html?"+a,link:function(a){if(window.YT)var d=new YT.Player("youtube-player",{height:"200",width:"320",playerVars:{autoplay:0,controls:1},events:{onReady:function(){a.$apply(function(a){a.ytPlayer=d})}}});
else{var c=document.createElement("script");c.src="//www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(c,e)}window.onYouTubeIframeAPIReady=function(){console.log("youtube api ready");a.$apply(function(a){var c=new YT.Player("youtube-player",{height:"200",width:"",playerVars:{autoplay:0,controls:1},events:{onReady:function(){a.$apply(function(a){a.ytPlayer=c})}}})})}}}}]).directive("quizNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},
controller:"QuizCtrl",templateUrl:"/templates/angular/editor/nodes/image_form_quiz.html?"+a}}]).directive("codeMirrorEditor",["libraryLoader",function(a){return{restrict:"E",scope:{text:"=text",filename:"=filename"},template:'<div class="code-mirror-editor">EDITOR</div>',link:function(b,d){a.loadLibraries(["codemirror"]).then(function(){var a=d.get(0),e=window.CodeMirror(function(b){a.parentNode.replaceChild(b,a);b.classList.add("code-mirror-editor")},{value:b.text,mode:"python",theme:"codacity",
lineNumbers:!0,matchBrackets:!0,indentUnit:4,extraKeys:{Tab:"indentMore"}});e.on("change",function(a){var c=a.getValue();"$digest"===b.$root.$$phase?b.text=c:b.$apply(function(a){a.text=c})});b.$watch("text",function(){b.text!==e.getValue()&&e.setValue(b.text)});b.$watch("filename",function(){if(b.filename){var a=b.filename.split(".");2>a.length||(a=a[a.length-1].toLowerCase(),"py"===a?(e.setOption("mode","python"),e.setOption("indentUnit",4)):"js"===a?(e.setOption("mode","javascript"),e.setOption("indentUnit",
2)):"html"===a&&(e.setOption("mode",{name:"xml",htmlMode:!0}),e.setOption("indentUnit",2)))}})})}}}]).directive("frameNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},templateUrl:"/templates/angular/editor/nodes/frame.html?"+a}}]).directive("programmingNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"ProgrammingCtrl",templateUrl:"/templates/angular/editor/nodes/programming.html?"+a}}]).directive("programmingGrading",["cacheVersion",function(a){return{restrict:"E",
scope:{evaluator:"=evaluator"},controller:"ProgrammingGradingCtrl",templateUrl:"/templates/angular/editor/nodes/programming_grading.html?"+a}}]).directive("iframeGrading",["cacheVersion",function(a){return{restrict:"E",scope:{evaluator:"=evaluator"},controller:"IFrameGradingCtrl",templateUrl:"/templates/angular/editor/nodes/iframe_grading.html?"+a}}]).directive("exerciseNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"ExerciseCtrl",templateUrl:"/templates/angular/editor/nodes/exercise.html?"+
a}}]).directive("sketchNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"SketchCtrl",templateUrl:"/templates/angular/editor/nodes/sketch.html?"+a}}]).directive("sketchVideoNode",["cacheVersion",function(a){return{restrict:"E",scope:{node:"=node"},controller:"SketchVideoCtrl",templateUrl:"/templates/angular/editor/nodes/sketch_video.html?"+a,link:function(a){if(window.YT)var d=new YT.Player("youtube-player",{height:"200",width:"320",playerVars:{autoplay:0,controls:1},
events:{onReady:function(){a.$apply(function(a){a.ytPlayer=d})}}});else{var c=document.createElement("script");c.src="//www.youtube.com/iframe_api";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(c,e)}window.onYouTubeIframeAPIReady=function(){console.log("youtube api ready");a.$apply(function(a){var c=new YT.Player("youtube-player",{height:"200",width:"",playerVars:{autoplay:0,controls:1},events:{onReady:function(){a.$apply(function(a){a.ytPlayer=c})}}})})}}}}]);angular.module("directives.editor").directive("editorNetworkStatus",["cacheVersion",function(a){return{restrict:"A",scope:{},controller:"EditorNetworkStatusCtrl",templateUrl:"/templates/angular/editor/network_status.html?"+a,replace:!0}}]).directive("editorListItem",["cacheVersion",function(a){return{restrict:"E",scope:{nodeRef:"=nodeRef",nodeIndex:"=nodeIndex"},controller:"LessonListCtrl",templateUrl:"/templates/angular/editor/list_item.html?"+a,replace:!0,link:function(a,d){d=d.get(0);d.addEventListener("dragstart",
function(c){d.classList.add("dragging");c.dataTransfer.setData("text/plain",a.node.key)});d.addEventListener("dragend",function(){d.classList.remove("dragging")});d.addEventListener("dragenter",function(){this.classList.add("hovered")});d.addEventListener("dragleave",function(a){var b=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=a.clientY+document.body.scrollTop+document.documentElement.scrollTop,f=d.getBoundingClientRect();(b<f.left||b>f.right||a<f.top||a>=f.bottom)&&
this.classList.remove("hovered")});d.addEventListener("dragover",function(a){a.preventDefault();a.dataTransfer.dropEffect="move";return!1});d.addEventListener("drop",function(c){this.classList.remove("hovered");c.stopPropagation();var d=c.dataTransfer.getData("text/plain");a.$apply(function(a){a.$emit("droppedNode",{droppedKey:d,droppedOn:a.node,where:a.parentNode,type:a.nodeType,nodeIndex:a.nodeIndex})});return!1})}}}]).directive("microUserInfo",["cacheVersion",function(a){return{restrict:"E",replace:!0,
scope:{userRef:"=userRef"},controller:"MicroUserInfoCtrl",templateUrl:"/templates/angular/editor/micro_user_info.html?"+a}}]);angular.module("directives.lesson").directive("cacheBuster",["codeMirror","executor",function(a,b){return{restrict:"A",link:function(d){d.bustCache=!0;d.toggleCacheBusting=function(){d.bustCache=!d.bustCache};d.submitCode=function(){var c=a.getContents(),e=a.getActiveLanguage();d.bustCache&&("cuda"===e||"c"===e)?c+="\n/* cache busting: "+(new Date).getTime()+" */":d.bustCache&&"python"===e&&(c+="\n''' cache busting: "+(new Date).getTime()+" '''");b.submitCode(c,a.getActiveLanguage())}}}}]);angular.module("directives.forum").directive("lessonForumDirective",["forumService","lesson",function(a,b){return{restrict:"A",controller:["$scope","$attrs",function(d,c){d.postsStartIndex=0;d.postsEndIndex=0;var e=c.numPerPage,f=function(a,c){a&&c&&(d.seeAllCoursePostsUrl="https://forums.udacity.com/tags/"+a.key+"/#"+a.key,d.askAQuestionUrl="https://forums.udacity.com/questions/ask/?tag="+(c.containingExercise?c.containingExercise.key:c.key)+"#"+a.key)};b.addEventListener("morselChange",function(c){d.morsel=
c;d.posts=void 0;a.getPosts(c.containingExercise?c.containingExercise.key:c.key,0,e).then(function(a){d.posts=a;d.postsStartIndex=1+0*e;d.postsEndIndex=d.posts.length+0*e});f(d.course,d.morsel)});b.addEventListener("courseChange",function(a){d.course=a.course;f(d.course,d.morsel)})}]}}]);angular.module("directives").directive("headerMiniNav",["cacheVersion",function(a){return{restrict:"A",scope:{courseId:"="},templateUrl:"/templates/angular/header_mini_nav.html?"+a,link:function(a,d,c){a.hovered=c.currentLocation;a.currentLocation=c.currentLocation;a.getCourseKey=function(){return a.courseId}}}}]);angular.module("directives.lesson").directive("bsDropdownCloser",function(){return{restrict:"A",link:function(a,b){b.on("click",function(){$(b).closest(".dropdown").removeClass("open")})}}});angular.module("directives.lesson").directive("documentTitleUpdater",["lesson","$routeParams",function(a){return{restrict:"A",link:function(b){var d=null,c=null,e=null,f=function(){document.title=(d?d+" - ":"")+(c||"Untitled Lesson")+" - "+(e||"Untitled Course")+" - Udacity"};a.addEventListener("morselChange",function(a){d=a.title;f()},{replayLast:!0,removeOnDestructionOf:b}).addEventListener("courseChange",function(a){e=a.course.title;f()},{replayLast:!0,removeOnDestructionOf:b}).addEventListener("lessonChange",
function(a){c=a.lesson.title;f()},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.lesson").directive("editorFileTabs",["codeEditor",function(a){return{restrict:"A",link:function(b){b.files=null;b.currentFilename=null;a.addEventListener("filesLoaded",function(a){b.files=a.files},{removeOnDestructionOf:b});a.addEventListener("activeFileChanged",function(a){b.currentFilename=a.newActiveFile.name},{removeOnDestructionOf:b});b.switchToFile=function(d){b.currentFilename=d;a.switchToFile(d)}}}}]);angular.module("directives.lesson").directive("examDoneButton",[function(){return{restrict:"A",link:function(a){a.leaveExam=function(){alert("Your exam is done. You will be redirected to the home page.");window.location.href="/"}}}}]);angular.module("directives.lesson").directive("examNanny",["examMode","$http","$timeout","$routeParams",function(a,b,d,c){return{restrict:"A",controller:["$scope",function(d){function f(){c.lessonKey&&b.get("/api/users/me/time_remaining?exam_key="+c.lessonKey).success(function(a){a=a.time_remaining;900>a&&(840<a&&!g)&&(alert("You have 15 minutes remaining."),g=!0);300>a&&(240<a&&!h)&&(alert("You have 5 minutes remaining."),h=!0);0>=a&&(alert("Time is up! You will now be directed to the home page."),
window.location.href="/")}).error(function(a){403===a.status?(alert("You do not have permission to view this exam! You will now be directed to the home page."),window.location.href="/"):404===a.status&&(alert("You are not registered for this exam. Redirecting to the registration page"),window.location.href="/proctored_exam")})}var g=!1,h=!1;a&&(setInterval(f,15E3),d.$on("$routeChangeSuccess",function(){f()}))}]}}]);angular.module("directives.lesson").directive("iframeCommander",["iframeEvaluator","isTrustedDomain","lesson",function(a,b,d){return{restrict:"A",link:function(c,e){function f(){var a;window.location.origin||(a=window.location,a=a.protocol+"//"+a.hostname+(a.port?":"+a.port:""));return window.location.origin||a}c.isEmbeddingIframe=!1;var g=e.find(".output-iframe-container");a.addEventListener("newEvaluation",function(a){a=a.iframeUrl?a.iframeUrl:"/content/frame/grade?node=Node."+a.nodeId;g.empty();
g.append($("<iframe />",{src:a,"class":"output-iframe"}));c.isEmbeddingIframe=!0},{removeOnDestructionOf:c});a.addEventListener("postMessageRequest",function(a){if(b(f())){var d=a.iframeUrl?a.iframeUrl:f();g.find(".output-iframe").get(0).contentWindow.postMessage(JSON.stringify({parts:a.submission.parts,operation:a.submission.operation,messageType:"evaluate"}),d);c.isEmbeddingIframe=!0}},{removeOnDestructionOf:c});d.addEventListener("pendingMorselChange",function(){g.empty();c.isEmbeddingIframe=!1},
{removeOnDestructionOf:c})}}}]);angular.module("directives.lesson").directive("iframePlayer",["lesson",function(a){return{restrict:"A",link:function(b,d){a.addEventListener("morselChange",function(a){"EmbeddedFrame"===a.model&&(b.iframeSourceUrl=a.external_uri,$(d.get(0).contentWindow).ready(function(){b.loadingComplete(!0)}))},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("directives.lesson").directive("imageQuizPlayer",["lesson","$routeParams","imageQuiz",function(a,b,d){return{restrict:"A",link:function(c){d.addEventListener("ready",function(){c.loadingComplete(!0)},{removeOnDestructionOf:c});a.addEventListener("morselChange",function(a){"ImageFormQuiz"===a.model&&(a=$.extend({},a),c.progressLoaded=!1,d.setQuiz(a),c.getQuiz=d.getQuiz,c.answers=d.answers,c.radioGroupAnswers=d.radioGroupAnswers)},{replayLast:!0,removeOnDestructionOf:c})}}}]);angular.module("directives.lesson").directive("iosNavReplacement",["lesson",function(){return{restrict:"A",template:'<select data-ng-model="iosLesson" data-ng-options="l.key as l.title for l in lessons" data-ng-change="goToLesson(iosLesson)"></select><select data-ng-model="iosMorsel" data-ng-options="m as m.title for m in morsels" data-ng-change="goToMorsel(iosMorsel)"></select>',controller:["$scope","lesson",function(a,b){a.iosLesson=null;a.iosMorsel=null;b.addEventListener("lessonChange",function(){a.iosLesson=
a.lesson.key},{replayLast:!0}).addEventListener("morselChange",function(b){a.iosMorsel="undefined"!==typeof b.containingExercise?b.containingExercise:b},{replayLast:!0})}]}}]);angular.module("directives.lesson").directive("lessonVideoPlayer",["lesson","$routeParams","youtubeVideoPlayer","viewerSettings","user",function(a,b,d,c,e){return{restrict:"A",link:function(b,g){var h=!1,j=null,l=function(){h&&d.pauseVideo()},k=function(){h&&d.destroyVideo()};d.addEventListener("apiReady",function(){a.addEventListener("pendingMorselChange",l,{removeOnDestructionOf:b}).addEventListener("pendingLessonChange",k,{removeOnDestructionOf:b}).addEventListener("pendingCourseChange",k,{removeOnDestructionOf:b});
a.addEventListener("morselChange",function(a){j=a;a._video&&(h?d.loadVideo(a._video.youtube_id,0):(d.attach(g.get(0),a._video.youtube_id,{autoPlay:c.get("autoPlay")?1:0}),h=!0))},{replayLast:!0,removeOnDestructionOf:b});c.addEventListener("change",function(a){"autoPlay"===a.name&&(!1===a.oldValue&&!0===a.newValue&&h)&&d.playVideo()});d.addEventListener("ready",function(){b.loadingComplete(!0)},{removeOnDestructionOf:b});d.addEventListener("videoPlay",function(){b.loadingComplete(!0)},{removeOnDestructionOf:b});
d.addEventListener("videoEnd",function(){if(!e.getUserProp("sitePreferences")||e.getUserProp("sitePreferences").autoAdvance)j.containingExercise&&j.containingExercise.quiz_ref&&(!j.containingExercise.answer_ref||j.containingExercise.answer_ref.key!==j.key)?b.goToMorsel(j.containingExercise.quiz_ref):b.goToNextMorsel()},{removeOnDestructionOf:b})},{replayLast:!0,removeOnDestructionOf:b,removeAfterFired:!0})}}}]);angular.module("directives.lesson").directive("mathquillTextfield",["imageQuiz","libraryLoader",function(a,b){return{restrict:"A",link:function(d,c){b.loadLibraries(["mathquill"]).then(function(){c.mathquill("editable");c.focusout(function(){a.answers[d.widget.marker]=c.mathquill("latex")});d.$watch(function(){if(d.widget)return a.answers[d.widget.marker]},function(a){c.mathquill("latex",a)})})}}}]);angular.module("directives.lesson").directive("playbackRateSelector",["youtubeVideoPlayer",function(a){return{restrict:"A",link:function(b){a.addEventListener("playbackRateChange",function(){b.$apply()},{replayLast:!0});a.addEventListener("ready",function(){b.playbackRates=a.getAvailablePlaybackRates().slice(1,-1);b.getCurrentPlayBackRate=function(){return a.getCurrentPlaybackRate()||1};b.setPlaybackRate=function(b){a.setPlaybackRate(b)};b.$apply()},{replayLast:!0})}}}]);angular.module("directives.lesson").directive("playerLoadingOverlay",function(){return{restrict:"A",template:'<div class="player-loading-overlay-message"><img alt="Loading..." src="/media/img/site/icons/udacity/quiz_loading.gif"></div>'}});angular.module("directives.lesson").directive("programmingQuizPlayer",["codeMirror","lesson","$routeParams","programmingQuiz",function(a,b,d,c){return{restrict:"A",priority:10,link:function(d){c.addEventListener("ready",function(){d.loadingComplete()},{removeOnDestructionOf:d});a.addEventListener("attached",function(){b.addEventListener("morselChange",function(a){"ProgrammingQuiz"===a.model&&(d.loading=!0,a=$.extend({},a),c.init(a))},{replayLast:!0,removeOnDestructionOf:d})},{removeOnDestructionOf:d,
removeAfterFired:!0})}}}]);angular.module("directives.lesson").directive("quizWidget",function(){return{restrict:"A",link:function(a,b){var d=!0;a.$watch("widget",function(a,e){d&&e&&(b.css({top:100*e.placement.y+"%",left:100*e.placement.x+"%"}),"TextInputWidget"===e.model||"NumericInputWidget"===e.model?(b.width(100*e.placement.width+"%"),b.height(100*e.placement.height+"%")):"MathInputWidget"===e.model&&b.css({"min-width":100*e.placement.width+"%","min-height":100*e.placement.height+"%"}),d=!1)})}}});angular.module("directives.lesson").directive("sketchPlayer",["sketch","lesson","$routeParams",function(a,b){return{restrict:"A",link:function(d,c){var e,f=c.find("#slider"),g=null;e={start:function(){g||(g=setInterval(function(){f.slider("value",1E3*a.currentPosition())},100))},stop:function(){clearInterval(g);g=null}};b.addEventListener("pendingMorselChange",function(){a.pause();e.stop()},{removeOnDestructionOf:d});c.find("#slider").slider({animate:!0,stop:function(){e.stop();a.jumpPercent($("#slider").slider("value")/
1E3);e.start()},max:1E3,min:0,start:function(){e.stop()}});c.find("#dialog_link, ul#icons li").hover(function(){$(this).addClass("ui-state-hover")},function(){$(this).removeClass("ui-state-hover")});a.addEventListener("ready",function(){a.play();e.start()},{replayLast:!0,removeOnDestructionOf:d});b.addEventListener("morselChange",function(b){b=$.extend({},b);if(b._strokes){var d={container:c.find("#canvasroom-container").get(0),backgroundCanvas:c.find("#canvasroom-background").get(0),canvas:c.find("#canvasroom").get(0),
audioEl:c.find("#canvasroom-audio").get(0)};a.attach(b,d)}else console.error("Passed invalid sketch data, ignoring")},{replayLast:!0,removeOnDestructionOf:d});d.restart=function(){a.pause();e.stop();a.jump(0)};d.play=function(){a.play();e.start()};d.pause=function(){a.pause();e.stop()}}}}]);angular.module("directives.lesson").directive("viewerErrorMessage",["lessonActivityTracker",function(a){return{restrict:"A",template:'<span data-ng-bind-html-unsafe="errorMessageText"></span><div class="dismiss"><a ng-click="errorMessageText = null">x</a></div>',controller:["$scope",function(b){b.errorMessageText=null;a.addEventListener("quizActivityLogFailure",function(a){console.log(a);a=_.reduce(a.context,function(a,b){return a+"/"+b.tag+b.node_key},"/course/viewer#!");b.errorMessageText='Oh no! We were unable to save the last submission, please resubmit again <a href="'+
a+'">here.</a>'})}]}}]);angular.module("directives.location").directive("location",["$http",function(){return{restrict:"A",scope:{userLocation:"=",locElClass:"="},template:'<input class="loc-widget {{locElClass}}" data-ng-model="userLocation.displayPlace" type="text" data-ng-change="locSelect(this)" data-uy-event="{focus: \'locEditStart()\', blur: \'locEditEnd()\'}">',controller:["$scope",function(a){a.locEditStart=function(){};a.locEditEnd=function(){};a.locSelect=function(){a.userLocation={displayPlace:a.userLocation.displayPlace}}}],
link:function(a,b){a.googleLoc=null;a.googleLocEl=b.find(".loc-widget");a.$watch("userLocation.displayPlace",function(b){"undefined"!==b&&null===a.googleLoc&&(a.googleLoc=new google.maps.places.Autocomplete(a.googleLocEl.get(0),{types:["(cities)"]}),google.maps.event.addListener(a.googleLoc,"place_changed",function(){var c=a.googleLoc.getPlace();c.geometry&&setTimeout(function(){a.place=c;var b=c.formatted_address,d=c.address_components,g="country administrative_area_level_1 administrative_area_level_2 administrative_area_level_3 colloquial_area locality postal_code".split(" "),
h;h="short_name";for(var j=[],l=0;l<d.length;l++)for(var k=0;k<d[l].types.length;k++)if(-1!==$.inArray(d[l].types[k],g)){j.push(d[l][h]);break}a.locObj={displayPlace:b,places:j,coordinates:""+c.geometry.location.lat()+","+c.geometry.location.lng()};a.userLocation=a.locObj;a.$apply()},1)}))});b.keydown(function(a){if(13===a.keyCode){a.preventDefault();var c=b.find("input"),a=c.closest("form").find(":input").not("[type=hidden]"),c=a.index(c);-1<c&&c+1<a.length&&a.eq(c+1).focus();return!1}})}}}]);angular.module("directives.utility").directive("markdown",["markdownConverter",function(a){return{restrict:"A",template:'<div class="markdown-container" data-ng-bind-html-unsafe="compiledOutput"></div>',link:function(b,d,c){b.$watch(c.markdown,function(d){d?b.compiledOutput=a.makeHtml(d):d||(b.compiledOutput=c.placeholder||"")})}}}]);angular.module("directives.utility").directive("mathquillifier",["libraryLoader","$timeout",function(a,b){return{restrict:"A",link:function(d,c,e){if(e.target)d.$watch(e.watch,function(){a.loadLibraries(["mathquill"]).then(function(){b(function(){c.find(e.target).mathquill()},0,!1)})});else throw Error("Must provide a target selector to mathquillify");}}}]);angular.module("directives.reviews",["ui.bootstrap"]).directive("reviewsList",["reviews",function(a){return{restrict:"A",scope:{entityKey:"=",numReviews:"=",numPerPage:"="},controller:["$scope",function(b){var d="recency";b.reviewsStartIndex=0;b.reviewsEndIndex=0;b.currentPage=1;b.numPages=Math.ceil(b.numReviews/b.numPerPage);b.showPage=function(c){var e=c-1,f=b.numPerPage;a.getReviews(b.entityKey,e,f,d,b.cursorMap).success(function(a){b.reviews=a.reviews.slice(0,f);b.reviewsStartIndex=1+e*f;b.reviewsEndIndex=
b.reviews.length+e*f;for(var c=0;c<b.reviews.length;++c)b.reviews[c].account=a.accounts[c];b.cursorMap=a.cursor_map})};b.$watch("entityKey",function(a){a&&(b.currentPage=1,b.showPage(1))});b.setSortOrder=function(a){d=a;b.currentPage=1;b.showPage(1)}}]}}]);angular.module("directives.reviews").directive("voteWidget",["reviews","user",function(a,b){return{restrict:"A",scope:{rating:"=",entityKey:"="},controller:["$scope",function(d){d.thumbs_u=function(){var a=d.rating&&d.rating.thumbs_u||0;return"u"===d.voteState?a+1:a};d.thumbs_d=function(){var a=d.rating&&d.rating.thumbs_d||0;return"d"===d.voteState?a+1:a};var c=function(c){b.userIsLoggedIn()?(a.vote(d.entityKey,c),d.voteState=c):window.location.href="/account/signin?"+$.param({next:window.location.href})};
d.voteUp=function(){c("u")};d.voteDown=function(){c("d")}}]}}]);angular.module("directives.user").directive("signUp",["user","auth","validator",function(a,b,d){return{restrict:"A",controller:["$scope",function(){}],link:function(c){c.signUp=b.signUserUp;c.isLoggedIn=a.userIsLoggedIn;c.user=a.getUser;c.firstName="";c.lastName="";c.email="";c.password="";c.passwordConfirm="";c.acceptTos=!1;c.signUpErrors=[];c.signUpErrorFields=[];c.signUp=function(a,f,g,h,j,l,k){c.buttonDisabled=!0;c.signUpErrors=[];c.signUpErrorFields=[];var m={firstName:{pretty:"first name",value:a,
validators:[{type:"required"}]},lastName:{pretty:"last name",value:f,validators:[{type:"required"}]},email:{pretty:"email address",value:g,validators:[{type:"required",chained:[{type:"email"}]}]},acceptTos:{pretty:"terms of service (TOS)",value:l,validators:[{type:"required"}]}};k&&(m.password={pretty:"password",value:h,validators:[{type:"required",chained:[{type:"strLen",args:[6,void 0]}]}]},m.passwordConfirm={pretty:"confirmed password",value:j,validators:[{type:"required",chained:[{type:"equal",
args:[h,"password"]}]}]});k=d.check(m);if(k.valid)if(b.getGoogleTokenCode())UYSocial.getGoogleToken(!0,function(c){b.signUserUp(a,f,g,null,null,null,c.code,l)});else{var n=b.getFacebookSignedRequest();b.signUserUp(a,f,g,h,j,n,null,l)}else{h=[];for(n in k.errorText)k.errorText.hasOwnProperty(n)&&(c.signUpErrorFields.push(n),h=h.concat(k.errorText[n]));c.signUpErrors=h;c.buttonDisabled=!1}};c.signUpFacebook=function(){UYSocial.getFacebookAuthResponse(function(a){b.logUserInSocial(a.signedRequest,null,
function(){b.socialAccountNotFoundRedirect(a.signedRequest,null,"signup")})})};c.signUpGoogle=function(){UYSocial.getGoogleToken(!1,function(a){b.logUserInSocial(null,a.code,function(){b.socialAccountNotFoundRedirect(null,a.code,"signup")})})};b.getFacebookSignedRequest()&&UYSocial.getFacebookMeResponse(function(a){c.email||(c.email=a.email);c.firstName||(c.firstName=a.first_name);c.lastName||(c.lastName=a.last_name);c.acceptTos=!0;c.$apply()});b.getGoogleTokenCode()&&UYSocial.getGoogleMeResponse(function(a){c.email||
(c.email=a.email);c.firstName||(c.firstName=a.given_name);c.lastName||(c.lastName=a.family_name);c.$apply()});b.addEventListener("signUp",function(){c.signUpErrors=[]});b.addEventListener("signUpSuccess",function(){b.loggedInAction()});b.addEventListener("signUpFailure",function(a){console.warn(a);c.signUpErrors=-1!==a.data.error.search(/address_lower already registered/)?["That email address is already registered at Udacity!"]:[a.data.error];c.buttonDisabled=!1})}}}]).directive("signIn",["user",
"auth","validator",function(a,b,d){return{restrict:"A",link:function(c,e){c.isLoggedIn=a.userIsLoggedIn;c.user=a.getUser;c.baseUser=a.getBaseUser;c.email="";c.password="";c.signIn=function(a,g){c.email||(a=e.find("#signInEmail").val());c.password||(g=e.find("#signInPass").val());c.buttonDisabled=!0;c.signInErrors=[];c.signInErrorFields=[];var h=d.check({email:{pretty:"email address",value:a,validators:[{type:"required",chained:[{type:"email"}]}]},password:{pretty:"password",value:g,validators:[{type:"required"}]}});
if(h.valid){var j=b.getFacebookSignedRequest();b.getGoogleTokenCode()?UYSocial.getGoogleToken(!0,function(c){b.logInAndConnect(a,g,j,c.code)}):b.logInAndConnect(a,g,j,null)}else{var l=[],k;for(k in h.errorText)h.errorText.hasOwnProperty(k)&&(c.signInErrorFields.push(k),l=l.concat(h.errorText[k]));c.signInErrors=l;c.buttonDisabled=!1}};c.signInFacebook=function(){UYSocial.getFacebookAuthResponse(function(a){b.logUserInSocial(a.signedRequest,null,function(){b.socialAccountNotFoundRedirect(a.signedRequest,
null,"signin")})})};c.signInGoogle=function(){UYSocial.getGoogleToken(!1,function(a){b.logUserInSocial(null,a.code,function(){b.socialAccountNotFoundRedirect(null,a.code,"signin")})})};b.addEventListener("logIn",function(){c.signUpErrors=[]});b.addEventListener("logInSuccess",function(){b.loggedInAction()});b.addEventListener("logInFailure",function(a){switch(a.status){case 403:c.signInErrors=["We couldn't find that user, or the password you entered was incorrect."];break;case 400:c.signInErrors=
[a.data.error];break;case 500:c.signInErrors=["Oh man, that's probably our bad. The server returned a 500 error! Try logging in again. If this doesn't work, please report this in the tech support forum."];break;default:c.signInErrors=["Oh dear. The server returned an unidentified error. Try logging in again and if it doesn't work, report this failure in the forum."]}c.buttonDisabled=!1})}}}]).directive("userMenu",["user","auth",function(a,b){return{restrict:"A",controller:["$scope",function(){}],
link:function(d){d.isLoggedIn=a.userIsLoggedIn;d.user=a.getUser;d.logOut=b.logUserOut;b.addEventListener("logOutSuccess",function(){window.location.href="/"})}}}]).directive("switchEnrollment",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!1;b.getActionText=function(){return a.isEnrolledIn(b.courseKey)?"Leave Class":"Join Class"}}],link:function(b,d){d.on("click",function(){b.disabled=!0;b.$apply();a.addEventListener("changeEnrollmentComplete",
function(){b.disabled=!1;b.$apply()},{removeAfterFired:!0});a.userIsLoggedIn()?a.changeEnrollment(b.courseKey,!a.isEnrolledIn(b.courseKey)):window.location="/account/signin?next="+encodeURIComponent(window.location)})}}}]).directive("enrollResume",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},link:function(b,d,c){b.disabled=!1;var e=c.courseKey;b.actionText=a.isEnrolledIn(e)?"Resume the Class":"Take the Class";d.on("click",function(){b.disabled=!0;b.$apply();var c="/course/viewer#!/c-"+
e;a.userIsLoggedIn()?a.isEnrolledIn(e)?window.location=c:(a.addEventListener("changeEnrollmentComplete",function(a){"enroll"===a.action&&(window.location=c)}),a.changeEnrollment(e,!a.isEnrolledIn(e))):window.location.href="/account/signin?"+$.param({next:c,enroll:e})})}}}]).directive("switchCourseEmailSubscription",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",function(b){b.disabled=!1;b.show=function(){return a.isEnrolledIn(b.courseKey)};b.getActionText=
function(){return a.isCourseEmailSubscribed(b.courseKey)?"Unsubscribe from course emails":"Subscribe to course emails"}}],link:function(b,d){d.on("click",function(){b.disabled=!0;b.$apply();a.addEventListener("changeEnrollmentSettingsComplete",function(){b.disabled=!1});a.changeEnrollmentSettings(b.courseKey,{email_ok:!a.isCourseEmailSubscribed(b.courseKey)})})}}}]).directive("requestPasswordReset",["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(d){d.email=
"";d.requestPasswordReset=function(c){d.buttonDisabled=!0;d.submitErrors=[];d.submitErrorFields=[];var e=b.check({email:{pretty:"email address",value:c,validators:[{type:"required",chained:[{type:"email"}]}]}});if(e.valid)a.requestPasswordReset(c);else{var c=[],f;for(f in e.errorText)e.errorText.hasOwnProperty(f)&&(d.submitErrorFields.push(f),c=c.concat(e.errorText[f]));d.submitErrors=c;d.buttonDisabled=!1}};a.addEventListener("requestPasswordResetSuccess",function(){d.submitErrors=[];d.submitSuccess=
!0});a.addEventListener("requestPasswordResetFailure",function(a){d.submitErrors=[a.data.error];d.buttonDisabled=!1})}}}]).directive("requestUnsubscribe",["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(d){d.email="";d.requestUnsubscribe=function(c){d.buttonDisabled=!0;d.submitErrors=[];d.submitErrorFields=[];var e=b.check({email:{pretty:"email address",value:c,validators:[{type:"required",chained:[{type:"email"}]}]}});if(e.valid)a.requestUnsubscribe(c);
else{var c=[],f;for(f in e.errorText)e.errorText.hasOwnProperty(f)&&(d.submitErrorFields.push(f),c=c.concat(e.errorText[f]));d.submitErrors=c;d.buttonDisabled=!1}};a.addEventListener("requestUnsubscribeSuccess",function(){d.submitErrors=[];d.submitSuccess=!0});a.addEventListener("requestUnsubscribeFailure",function(a){d.submitErrors=[a.data.error];d.buttonDisabled=!1})}}}]).directive("enrollUnreleasedCourse",["user",function(a){return{restrict:"A",scope:{courseKey:"@courseKey"},controller:["$scope",
function(b){b.disabled=!1;b.actionText=a.isEnrolledIn(b.courseKey)?"Go to My Courses":"Add to My Courses"}],link:function(b,d){d.on("click",function(){b.disabled=!0;b.$apply();a.userIsLoggedIn()?a.isEnrolledIn(b.courseKey)?window.location="/my_courses":(a.addEventListener("changeEnrollmentComplete",function(a){"enroll"===a.action&&(window.location="/my_courses#!/?newclass=true")}),a.changeEnrollment(b.courseKey,!a.isEnrolledIn(b.courseKey))):window.location.href="/account/signin?"+$.param({next:"/my_courses",
enroll:b.courseKey})})}}}]).directive("resetPassword",["user","validator",function(a,b){return{restrict:"A",controller:["$scope",function(){}],link:function(d){d.resetPassword=function(c,e,f,g){d.buttonDisabled=!0;d.submitErrors=[];d.submitErrorFields=[];e=b.check({password:{pretty:"password",value:c,validators:[{type:"required",chained:[{type:"strLen",args:[6,void 0]}]}]},passwordConfirm:{pretty:"confirmed password",value:e,validators:[{type:"required",chained:[{type:"equal",args:[c,"password"]}]}]}});
if(e.valid)a.resetPassword(c,f,g);else{var c=[],h;for(h in e.errorText)e.errorText.hasOwnProperty(h)&&(d.submitErrorFields.push(h),c=c.concat(e.errorText[h]));d.submitErrors=c;d.buttonDisabled=!1}};a.addEventListener("resetPasswordSuccess",function(){d.submitErrors=[];d.submitSuccess=!0});a.addEventListener("resetPasswordFailure",function(a){d.submitErrors=[a.data.error];d.buttonDisabled=!1})}}}]).directive("checkEnrollment",["user",function(a){return{restrict:"A",link:function(b,d,c){a.addEventListener("userSet",
function(){b.userIsEnrolled=a.isEnrolledIn(c.courseId.replace(/'/g,""))})}}}]);angular.module("directives.utility").directive("animatedToggle",function(){return{restrict:"A",link:function(a,b,d){d.toggleTarget||console.error("You must provide a toggle-target with a selector for the child element to toggle");d.toggler||console.error("You must provide an element to trigger the toggle");var c=b.find(d.toggleTarget),a=b.find(d.toggler);c||console.error("Element to toggle ("+d.toggleTarget+") not found!");a||console.error("Element to trigger toggle ("+d.toggler+") not found!");$(a).on("click",
function(){$(c).toggle("fast")});$(c).hide()}}});angular.module("directives.utility").directive("autofocusOnClick",["$timeout",function(a){return{restrict:"A",link:function(b,d){d.click(function(){a(function(){$("input[autofocus]").focus()},0,!1)})}}}]).directive("autofocusOnInit",["$timeout",function(a){return{restrict:"A",link:function(b,d){a(function(){d.find("input[autofocus]").focus()},0,!1)}}}]);angular.module("directives.utility").directive("clickFade",function(){return{restrict:"A",link:function(a,b){$(document).on("click",function(){$(b).fadeOut("slow")})}}});angular.module("directives.utility").directive("enforceBrowser",["techDetect",function(a){return{restrict:"A",link:function(){var b={Chrome:11,Firefox:10,Safari:4,Explorer:9,Opera:12},d=a.browserStats();b.hasOwnProperty(d.browser)&&("number"===typeof d.version&&d.version<b[d.browser])&&(window.location="/upgrade")}}}]).directive("warnBrowser",["techDetect","$cookieJar",function(a,b){return{restrict:"A",link:function(){},controller:["$scope",function(d){var c={Chrome:18,Firefox:16,Safari:5,Explorer:9,
UIWebView:1},e="dismissed"===b.get("udacityBrowserWarning"),f=a.browserStats();d.warnBrowserTech=function(){return!c.hasOwnProperty(f.browser)||"number"!==typeof f.version||f.version<c[f.browser]};d.warnBrowserDismiss=function(a){a=a||3600;a=new Date((new Date).getTime()+1E3*a);b.set("udacityBrowserWarning","dismissed",{expires:a});e=!0};d.warnBrowserDismissed=function(){return e}}]}}]);angular.module("directives.utility").directive("uyAssign",function(){return{restrict:"A",link:function(a,b,d){a.$eval(d.uyAssign)}}});angular.module("directives.utility").directive("uyBlur",function(){return function(a,b,d){b.on("blur",function(){console.log(d);a.$apply(d.uyBlur)})}});angular.module("directives.utility").directive("uyEvent",["$parse",function(a){return function(b,d,c){c=b.$eval(c.uyEvent);angular.forEach(c,function(c,f){var g=a(c);d.on(f,function(a){var c=Array.prototype.slice.call(arguments),c=c.splice(1);b.$apply(function(){g(b,{$event:a,$params:c})})})})}}]);angular.module("directives.utility").directive("uyAnimatedShow",function(){return{restrict:"A",link:function(a,b,d){a.$watch(d.uyAnimatedShow,function(a){a&&"none"===b.css("display")?d.fadeIn?b.fadeIn(parseInt(d.fadeIn,10)):d.slideDown?b.slideDown(parseInt(d.slideDown,10)):b.show():!a&&"none"!==b.css("display")&&(d.fadeOut?b.fadeOut(parseInt(d.fadeOut,10)):d.slideUp?b.slideUp(parseInt(d.slideUp,10)):b.hide())})}}});angular.module("directives.utility").directive("videoPlayer",["youtubeVideoPlayer",function(a){return{restrict:"A",link:function(b,d,c){a.addEventListener("apiReady",function(){a.attach(d.get(0),c.videoId,{autoPlay:c.autoPlay||0})},{replayLast:!0,removeOnDestructionOf:b})}}}]);angular.module("filters.dates").filter("dateRelative",["$filter",function(a){return function(b){var d=((new Date).getTime()-b)/1E3;return 60>d?"just now":3600>d?""+Math.floor(d/60)+"m ago":86400>d?""+Math.floor(d/3600)+"h ago":691200>d?""+Math.floor(d/86400)+"d ago":isNaN(b)?"not available":a("date")(b,"MMM d")}}]).filter("stringDate",["$filter",function(){var a=function(a){if(!a)return a;var d=a.lastIndexOf(".");if(-1===d)return a;var c=d+7;if(c>a.length)return a;for(var e=d+1;e<c;++e)if("0">a[e]||
"9"<a[e])return a;return a.substring(0,d)+a.substring(c,a.length)};return function(b){return Date.parse(a(b))}}]);angular.module("filters").filter("imageCropSize",["$filter",function(){return function(a,b){if(a)return a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)?a=a.replace(/\=s\d+(-c)?/,"=s"+b+"-c"):a.match(/\/\/robohash\.org\//)&&(a=a+"?size="+b+"x"+b),a}}]).filter("imageSize",["$filter",function(){return function(a,b,d){d=0===d?void 0:d;b=0===b?void 0:b;if("number"!==typeof b&&"number"!==typeof d)return a;var c=Math.max(d,b)||d||b;if(a.match(/\/\/[^.\/]+\.ggpht\.com\//)||a.match(/\/_ah\/img\//)){var e=
/#[\w=_\-&]*w=(\d+)&h=(\d+)/.exec(a);e&&(c=1*e[1],e=1*e[2],b=Math.min(d/e,b/c)||d/e||b/c,b=[c*b,e*b],a=a.replace(/\=s\d+(-c)?/,"=s"+Math.round(Math.max(b[0],b[1]))))}else a.match(/\/\/robohash\.org\//)&&c&&(a=a+"?size="+c+"x"+c);return a}}]);angular.module("services.auth").factory("auth",["api","user","mixin","urlParams",function(a,b,d,c){b.setUser(b.getBaseUser());var e=d.eventEmission({logInHelper:function(c,b,d,j,l,k){e.emitEvent("logIn");var m={};b&&(m={udacity:{username:c,password:b}});j&&(m.facebook={signed_request:j},m.connect=k);l&&(m.google={token:l},m.connect=k);a.post("/session",m).success(function(){e.emitEvent("logInSuccess")}).error(d)},logInAndConnect:function(a,c,b,d){e.logInHelper(a,c,function(a,c,b,d){e.emitEvent("logInFailure",
{status:c,data:a,config:d,headers:b})},b,d,!(!b&&!d))},logUserOut:function(){e.emitEvent("logOut");a.deleteRequest("/session").success(function(a,c,b,d){console.log("user logged out");console.log({status:c,data:a,config:d});e.emitEvent("logOutSuccess")}).error(function(a,c,b,d){console.warn("User tried to log out and failed!");console.log("Debug data:");console.log({status:c,data:a,config:d});e.emitEvent("logOutFailure")})},signUserUp:function(d,g,h,j,l,k,m,n){a.post("/users",{first_name:d,last_name:g,
email_address:h,password:j,facebook:k?{signed_request:k}:null,google:m?{token:m}:null,tos_accepted:n}).success(function(a){if(null===a.user)console.log('Got back a null user! You are null, and while not valid in this language, I\'m going to call you "void" too.');else{var d=function(){var c=b.translateUserFromApi(a.user);b.setUser(c);e.emitEvent("signUpSuccess")},f=c.getDecodedURIComponent("enroll");f?UY.pushTrackingEvent("SignUp","Enroll",f,void 0,d):UY.pushTrackingEvent("SignUp","Direct","",void 0,
d)}}).error(function(a,c,b,d){e.emitEvent("signUpFailure",{status:c,data:a,config:d,headers:b})})},logUserInSocial:function(a,c,b){e.logInHelper(null,null,function(a,c,d,f){502===c?(console.log("something failed with Facebook or the signed request"),e.emitEvent("logInFailure",{status:c,data:a,config:f,headers:d})):403===c?b():console.log("unknown failure "+c)},a,c,!1)},getFacebookSignedRequest:function(){return c.getUrlQueryParams().fsr},getGoogleTokenCode:function(){return c.getUrlQueryParams().gtc},
socialAccountNotFoundRedirect:function(a,b,d){var e={next:c.getDecodedURIComponent("next")||window.location.href};c.getDecodedURIComponent("enroll")&&(e.enroll=c.getDecodedURIComponent("enroll"));a&&(e.fsr=a);b&&(e.gtc=b);window.location.href="signin"===d?"/account/signin_connect?"+$.param(e):"/account/signup_connect?"+$.param(e)},loggedInAction:function(){var a=function(){var a=c.getDecodedURIComponent("next");a?window.location.href=a:window.location.reload()},d=c.getDecodedURIComponent("enroll");
d?(b.addEventListener("changeEnrollmentComplete",a),b.changeEnrollment(d,!0)):a()}},"logIn logInSuccess logInFailure logInValidation signUp signUpSuccess signUpFailure signUpValidation logOut logOutSuccess logOutFailure".split(" "));return e}]);angular.module("services.blogFeed").factory("blogFeed",["$http","$q",function(a,b){var d=b.defer();a.jsonp("//ajax.googleapis.com/ajax/services/feed/load?v=1.0&num=5&callback=JSON_CALLBACK&q="+encodeURIComponent("http://blog.udacity.com/feeds/posts/default")).success(function(a){var b=[];_.each(a.responseData.feed.entries,function(a){b.push({date:a.publishedDate.slice(0,16),title:a.title,link:a.link})});d.resolve(b)});return{posts:d.promise}}]);angular.module("services.utility").factory("callbackList",function(){return{create:function(){var a=[],b,d=!1,c={add:function(e,f,g){a.push(e);d&&f?(e(b),g&&c.remove(e)):g&&(e._removeOnFire=!0);return c},remove:function(b){for(var d=a.length,g=0;g<d;g++)a[g]===b&&(a.splice(g,1),g-=1);return c},fire:function(e){var f,g=a.length;for(f=0;f<g;f++)try{a[f](e)}catch(h){console.error("Exception encountered in callback:"+h.message)}b=e;d=!0;for(f=0;f<a.length;f++)!0===a[f]._removeOnFire&&(c.remove(a[f]),
f-=1);return c},_getCallbacks:function(){return a}};return c}}});angular.module("services.lesson").service("codeMirror",["mixin","libraryLoader",function(a,b){var d=null,c,e={python:{name:"python",version:2,singleLineStringErrors:!1},c:"text/x-csrc",cuda:"text/x-cudasrc",cpp:"text/x-c++src",css:"text/css",java:"text/x-java",javascript:"text/javascript",html:{name:"xml",htmlMode:!0},specman:"text/x-specmansrc"},f=function(a){for(var c={},a=a.split(" "),b=0;b<a.length;++b)c[a[b]]=!0;return c},g=function(a,c){return c.startOfLine?(a.skipToEnd(),"meta"):!1};b.loadLibraries(["codemirror"]).then(function(){CodeMirror.defineMIME("text/x-cudasrc",
{name:"clike",keywords:f("auto if break int case long char register continue return default short do sizeof double static else struct entry switch extern typedef float union for unsigned goto while enum void const signed volatile inline wchar_t"),builtin:f("__global__ __constant__ __shared__ threadIdx blockIdx gridDim blockDim __device__ __host__ __syncthreads"),blockKeywords:f("do else for if struct switch while"),atoms:f("true false null"),hooks:{"#":g}});CodeMirror.defineMIME("text/x-specmansrc",
{name:"clike",keywords:f("all also as_a assert assume an and attribute bit bits bool break byte case check change compute computed cover continue cross cycle default define delay detach do down each edges else emit empty event exec expect export extend fail fall file first for force from gen global if ifdef ifndef in index int inline is instance item keep keeping key like line list machine matching me nand new nor not now of on only or out pass prev print range ranges release repeat return reverse rise routine select soft start state step string struct sync sys that then time to transition true try type undefined uint unit until using var when while with")})});
var h={attach:function(a,f){b.loadLibraries(["codemirror"]).then(function(){if(!_.isElement(a))throw"Must attach code mirror to a DOM element!";d&&(d=null);var b=angular.bind(this,function(){h.emitEvent("contentChanged")}),g=window.CodeMirror;d=g(a,{mode:e[f.language],theme:f.theme||"default",autofocus:f.autofocus,onChange:b,lineNumbers:!0,matchBrackets:!0,indentUnit:4,extraKeys:{Tab:"indentMore"}});c=f.language;h.emitEvent("attached")})},detach:function(){d=null},getAvailableLanguages:function(){return _.keys(e)},
setActiveLanguage:function(a){c=a;d.setOption("mode",e[a]);h.emitEvent("languageChanged",{to:a})},getActiveLanguage:function(){return c},setOptions:function(a){_.each(a,function(a,c){d.setOption(c,a)})},getContents:function(){return d?d.getValue():null},setContents:function(a){d.setValue(a)}};return a.eventEmission(h,["attached","languageChanged","contentChanged"])}]);angular.module("services.content").factory("content",["api","mixin","$q","dummyData",function(a,b,d){var c=b.eventEmission({nodes:{},states:{},loadNodes:function(b,f,g){var h=f[0],b=_.filter(b,function(a){return!c.nodes.hasOwnProperty(a)});if(0===b.length)return c.emitEvent("loadNodesComplete",{nohttp:!0}),null;var j=Math.min(3,b.length),l=Math.ceil(b.length/j);d.all(_.flatten(_.map(_.range(j),function(c){var c=c*l,d=b.slice(c,c+l),c=JSON.stringify({keys:d,fresh:!1,depth:0}),d=JSON.stringify({node_keys:d,
user_key:h});return[a.get("/nodes?json="+c),a.get("/nodes/state?json="+d)]}))).then(function(a){function d(a){c.states[h][a.node_ref.key]=a}function f(a){c.states[h].hasOwnProperty(a)||(c.states[h][a]={})}for(var l=0;l<2*j;l+=2){var p=a[l+1].data;$.extend(c.nodes,a[l].data.references.Node);c.states.hasOwnProperty(h)||(c.states[h]={});$.extend(c.states[h],{});_.each(p.nodestates,d);_.each(b,f)}void 0!==g&&c.setMasteryPoints(g,h,b);c.emitEvent("loadNodesComplete",{nohttp:!1})})},setMasteryPoints:function(a,
b,d){try{void 0===d&&(d=[]);d.push(a);var h=c.states[b][a].mastery_points_summary;_.each(d,function(a){h.hasOwnProperty(a)?(c.states[b][a].points_possible=h[a].points_possible,c.states[b][a].points_earned=h[a].points_earned):(c.states[b][a].points_possible=0,c.states[b][a].points_earned=0)})}catch(j){return null}}},["loadNodesComplete","loadNodesPartial","loadStateComplete","aggregationMasteryPointsComplete"]);c.getNodeProperty=function(a,b){return c.nodes.hasOwnProperty(a)?c.nodes[a][b]:null};c.getChildrenKeys=
function(a){var b=[];c.nodes.hasOwnProperty(a)&&(b=_.map(c.nodes[a].steps_refs,function(a){return a.key}));return b};c.getDifficultyLevel=function(a){return c.nodes.hasOwnProperty(a)?c.nodes[a].catalog_entry.level:null};c.getLevelMasteryPoints=function(a,b){try{return c.nodes[a].catalog_entry.mastery_spec.badge_thresholds[b]}catch(d){return 0}};c.getMasteryPoints=function(a,b,d){try{return c.states[b][a][d]}catch(h){return 0}};c.getLastChild=function(a,b){try{for(var d=0;d<c.states[b][a].last_interactions.length;d++){var h=
c.states[b][a].last_interactions[d];if(1<h.content_context.length&&"c-"===h.content_context[0].tag&&h.content_context[0].node_ref.key===a)return h.content_context[1].node_ref.key}return null}catch(j){return null}};c.getLastInteractionDate=function(a,b){try{var d=_.map(c.states[b][a].last_interactions,function(a){return Date.parse(a.time)});return Math.max.apply(Math,d)}catch(h){return null}};c.getMasteryLevel=function(a,b){try{for(var d=c.nodes[a].catalog_entry.mastery_spec.badge_thresholds,h=c.getMasteryPoints(a,
b,"points_earned"),j=0,l=0;l<d.length&&!(j=l,h<=d[l]);l++);return j}catch(k){return 0}};c.getNotAvailableMessage=function(a){try{return c.nodes[a].catalog_entry.not_available_message}catch(b){return null}};c.getProgress=function(a,b){try{return Math.min(c.states[b][a].completed_morsel_count/c.nodes[a]._synopsis.morsel_count,1)}catch(d){return 0}};c.getRemainingDuration=function(a,b){try{return Math.max(Math.round((c.nodes[a]._synopsis.duration-c.states[b][a].completed_duration)/60),0)}catch(d){return 0}};
c.getRemainingEvaluables=function(a,b){try{return Math.max(c.nodes[a]._synopsis.quiz_count-c.states[b][a].completed_quiz_count,0)}catch(d){return 0}};c.getRemainingMasteryPoints=function(a,b,d){d=c.getLevelMasteryPoints(a,d);a=c.getEarnedMasteryPoints(a,b);a=d-a;0>a&&(a=0);return a};c.hasBehavior=function(a,b){try{var d=_.values(c.nodes[a].guard.allowed_behaviors);return _.contains(d,b)}catch(h){return!1}};c.isAvailable=function(a){try{return c.nodes[a]._available}catch(b){return!1}};c.isMorsel=function(a){return"Lesson"!==
a.model&&"Course"!==a.model};c.getMasteryMorselKeys=function(a){try{return _.map(c.nodes[a].catalog_entry.mastery_spec.weights,function(a){return a.node_ref.key})}catch(b){return[]}};c.getLessonKeys=function(a){return _.map(c.nodes[a].steps_refs,function(a){return a.key})};return c}]);angular.module("services.dummyData").factory("dummyData",[function(){return{getNodes:function(){return{Node:{"0":{key:"0",model:"Lesson",title:"Web Development",subtitle:"Better Living Through Weavistry",id:"cs253",duration:10,mastery_points:7,mastery_levels:[0,1,3,5,7],difficulty_level:"intermediate",quiz_count:2,node_references:["00","01"]},1:{key:"1",model:"Lesson",title:"Artisanal Pencil Sharpening",subtitle:"The craft of pencil",id:"ap301",duration:20,mastery_points:5,mastery_levels:[0,1,3,4,
5],difficulty_level:"advanced",quiz_count:0,node_references:["10"]},"00":{key:"00",model:"Lesson",title:"How the Web Works",duration:10,mastery_points:7,quiz_count:1,node_references:["000","001"]},"01":{key:"01",model:"Lesson",title:"How to Have Users",duration:0,mastery_points:0,quiz_count:1,node_references:["010"]},10:{key:"10",model:"Lesson",title:"Single Razor Pocket Sharpeners",duration:20,quiz_count:0,mastery_points:5,node_references:["100"]},"000":{key:"000",model:"Video",title:"BYOBaskets",
duration:10,mastery_points:0,quiz_count:0},"001":{key:"001",model:"ImageFormQuiz",title:"How big is your basket?",duration:0,mastery_points:7,quiz_count:1},"010":{key:"010",model:"ImageFormQuiz",title:"50 Shades of Basket",duration:0,mastery_points:0,quiz_count:1},100:{key:"100",model:"Video",title:"Single Razor",duration:20,mastery_points:5,quiz_count:0}},NodeState:{"0":{progress:0.3,mastery_points_earned:3,mastery_level_achieved:2,viewed_playable_duration:1,completed_evaluable_count:1,last_child_key:"01"},
1:{progress:0.7,mastery_points_earned:1,mastery_level_achieved:1,viewed_playable_duration:15,completed_evaluable_count:0,last_child_key:"10"},"00":{progress:0.5,mastery_points_earned:3,viewed_playable_duration:1,completed_evaluable_count:0,last_child_key:"001"},"01":{progress:0.2,mastery_points_earned:0,viewed_playable_duration:0,completed_evaluable_count:1,last_child_key:"010"},10:{progress:0.5,mastery_points_earned:1,viewed_playable_duration:15,completed_evaluable_count:0,last_child_key:"100"},
"000":{progress:0.5,mastery_points_earned:0,viewed_playable_duration:1,completed_evaluable_count:0},"001":{progress:0.5,mastery_points_earned:3,viewed_playable_duration:0,completed_evaluable_count:1},"010":{progress:0.5,mastery_points_earned:0,viewed_playable_duration:0,completed_evaluable_count:0},100:{progress:0.5,mastery_points_earned:5,viewed_playable_duration:15,completed_evaluable_count:0}}}},currentCourseKeys:["0","1"],pastCourseKeys:[],userKey:3,badgeUrls:{1:{medium:"http://foursquare.com/img/badge/swarm_big.png"},
2:{medium:"http://www.newtownhistoric.org/images/HeritageWalk/HistoryDetectiveBadge.jpg"},4:{medium:"https://foursquare.com/img/badge/barista_big.png"}}}}]);angular.module("udacity.editor").config(["$routeProvider","$locationProvider","cacheVersion","tags",function(a,b,d,c){a.when("/",{templateUrl:"/templates/angular/editor/chooser.html?"+d,controller:"EditorChooserCtrl"}).when("/"+c.course+":courseKey",{templateUrl:"/templates/angular/editor/course.html?"+d,controller:"CourseEditorCtrl"}).when("/"+c.lesson+":lessonKey",{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.lesson+":lessonKey/"+c.morsel+":morselKey",
{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.lesson+":lessonKey/"+c.exercise+":exerciseKey",{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.lesson+":lessonKey/"+c.exercise+":exerciseKey/"+c.morsel+":morselKey",{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.course+":courseKey/"+c.lesson+":lessonKey",{templateUrl:"/templates/angular/editor/lesson.html?"+
d,controller:"LessonEditorCtrl"}).when("/"+c.course+":courseKey/"+c.lesson+":lessonKey/"+c.morsel+":morselKey",{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.course+":courseKey/"+c.lesson+":lessonKey/"+c.exercise+":exercseKey",{templateUrl:"/templates/angular/editor/lesson.html?"+d,controller:"LessonEditorCtrl"}).when("/"+c.course+":courseKey/"+c.lesson+":lessonKey/"+c.exercise+":exercseKey/"+c.morsel+":morselKey",{templateUrl:"/templates/angular/editor/lesson.html?"+
d,controller:"LessonEditorCtrl"});b.html5Mode(!1);b.hashPrefix("!")}]);angular.module("services.editor").factory("audio",["mixin",function(a){var b={sampleRate:44100,bufferSize:1024,waveformScale:1,recording:!1,ready:!1,buffer:void 0,stream:void 0,error:void 0,context:void 0,inputSource:void 0,recordProcessor:void 0,playProcessor:void 0,initialize:function(){navigator.webkitGetUserMedia&&(b.resetBuffers(),navigator.webkitGetUserMedia({audio:!0},function(a){b.stream=a;b.context=new window.webkitAudioContext;b.inputSource=b.context.createMediaStreamSource(b.stream);b.recordProcessor=
b.context.createScriptProcessor(b.bufferSize,2,2);b.recordProcessor.onaudioprocess=b.recordDataHandler;b.playProcessor=b.context.createScriptProcessor(b.bufferSize,0,2);b.playProcessor.onaudioprocess=b.playDataHandler;b.ready=!0},function(){b.error="Unable to initialize audio input"}))},startRecording:function(){if(!this.ready)return!1;b.resetBuffers();b.inputSource.connect(b.recordProcessor);b.recordProcessor.connect(b.context.destination);b.recording=!0;b.playIndex=0;return!0},stopRecording:function(){b.recording=
!1;b.inputSource.disconnect();b.recordProcessor.disconnect();b.createWaveform()},play:function(){b.playIndex>b.buffer.left.length&&(b.playIndex=0);!b.recording&&0<b.buffer.left.length&&b.playProcessor.connect(b.context.destination)},stop:function(){b.playProcessor.disconnect()},seek:function(a){0>a&&(a=0);b.playIndex=a>=b.duration()?b.buffer.left.length+1:b.bufferIndexFromTime(a)},resetBuffers:function(){b.buffer={left:[],right:[]};b.waveform=void 0},playIndex:0,playDataHandler:function(a){var c=
a.outputBuffer.getChannelData(0),a=a.outputBuffer.getChannelData(1);b.playIndex===b.buffer.left.length?(c.set(new Float32Array(b.bufferSize)),a.set(new Float32Array(b.bufferSize)),b.playIndex++):b.playIndex>b.buffer.left.length?(b.playProcessor.disconnect(),b.emitEvent("end")):(c.set(b.buffer.left[b.playIndex]),a.set(b.buffer.right[b.playIndex]),b.playIndex++,0===b.playIndex%1&&b.emitEvent("bufferRead"))},recordDataHandler:function(a){b.recording&&(a.inputBuffer.getChannelData(0),a.inputBuffer.getChannelData(1),
b.buffer.left=b.buffer.left.concat(new Float32Array(a.inputBuffer.getChannelData(0))),b.buffer.right=b.buffer.right.concat(new Float32Array(a.inputBuffer.getChannelData(1))),b.playIndex++,0===b.playIndex%5&&(b.createWaveform(),b.emitEvent("bufferRead")))},cut:function(a){for(var c=[],e=[],f=b.bufferIndexFromTime(a.inpoint),g=b.bufferIndexFromTime(a.outpoint),h=0;h<b.buffer.left.length;h++)if(h<f||h>g)c.push(b.buffer.left[h]),e.push(b.buffer.right[h]);b.buffer.left=c;b.buffer.right=e;b.seek(a.inpoint);
b.waveform=void 0;b.createWaveform(!0)},duration:function(){return 0===b.buffer.left.length?0:((b.buffer.left.length-1)*b.bufferSize+b.buffer.left[b.buffer.left.length-1].length)/b.sampleRate},timeFromWaveformIndex:function(a){return b.timeFromBufferIndex(a*b.waveformScale)},timeFromBufferIndex:function(a){return a*b.bufferSize/b.sampleRate},waveformIndexFromTime:function(a){return Math.floor(b.bufferIndexFromTime(a)/b.waveformScale)},bufferIndexFromTime:function(a){return Math.floor(a*b.sampleRate/
b.bufferSize)},currentTime:function(){return b.recording?b.duration():b.timeFromBufferIndex(b.playIndex)},waveformCurrentIndex:function(){return Math.floor(b.playIndex/b.waveformScale)},createWaveform:function(a){b.waveform||(b.bufferMeans=[],b.waveform=[],b.max=1E-10,b.waveformBuildIndex=0,b.waveformSampleIndex=0);if(a||635<b.waveform.length)b.waveform=[],b.waveformSampleIndex=0,b.waveformScale=Math.max(1,b.buffer.left.length/640);b.recording||(b.waveform=[],b.waveformSampleIndex=0);for(;b.waveformBuildIndex<
b.buffer.left.length;){for(var c=a=0;c<b.buffer.left[b.waveformBuildIndex].length;c++)a+=Math.abs(b.buffer.left[b.waveformBuildIndex][c]);a/=b.buffer.left[b.waveformBuildIndex].length;a>b.max&&(b.max=a);b.bufferMeans.push(a);b.waveformBuildIndex++}for(a=b.bufferMeans.length/b.waveformScale;b.waveformSampleIndex<a;)b.waveform.push(b.bufferMeans[Math.floor(b.waveformSampleIndex*b.waveformScale)]/b.max),b.waveformSampleIndex++}};b.initialize();a.eventEmission(b,["bufferRead","end"]);return b}]);angular.module("services.editor").factory("bulkImporter",["content","mixin",function(a,b){var d={_files:[],_nodes:[],_processed:[],failedFiles:[],prepFromFileInputElement:function(a){d._files=[];d._nodes=[];d._processed=[];d.failedFiles=[];for(var b=0;b<a.files.length;b++)d._files.push(a.files[b]);0===d._files.length&&(d._files=void 0)},run:function(){angular.forEach(d._files,d._processFile);angular.forEach(d._processed,d._processExercises);if(0<d.failedFiles.length){var a="The following file types were not recognized.  Please check that you have only selected video and image files.\n\n";
angular.forEach(d.failedFiles,function(b){a+=b+"\n"});alert(a);return[]}return d._nodes},_processFile:function(c){var b=c.name,f=b.split("."),g=b,h,j;1<f.length&&(j=f[f.length-1].toLowerCase(),g=f.slice(0,f.length-1).join(""));var l=g.match(/^(\d{2,})_([lpqsnih])_(.*)/);l?(f=l[1],h=l[2],g=l[3].replace(/-/g," "),f=parseInt(f,10),f||(f=d._processed.length)):f=d._processed.length;d._processed[f]||(d._processed[f]={});if("jpg"===j||"jpeg"===j){if("p"!==h&&"i"!==h&&"h"!==h){var k=a.newQuiz();k.title=g;
k.__FILE_background_image=c;"n"===h&&(k.evaluator=new a.CodeGradedEvaluator);d._getFileURL(c,function(a){k.__URL_background_image=a});d._processed[f].quiz=k}}else"mp4"===j||"mpeg"===j||"mpg"===j?(b=a.newVideo(),b.title=g,b.__FILE_video=c,"q"===h||"p"===h||"n"===h||"i"===h||"h"===h?d._processed[f].intro=b:"s"===h?d._processed[f].solution=b:d._processed[f].lecture=b):d.failedFiles.push(b)},_processExercises:function(c){if(c.lecture)d._nodes.push(c.lecture);else{var b=a.newExercise();if(c.intro){if(!b.title||
"Exercise"===b.title)b.title=c.intro.title;b.lecture_ref={ref:"Node",key:c.intro.key}}if(c.quiz){if(!b.title||"Exercise"===b.title)b.title=c.quiz.title;b.quiz_ref={ref:"Node",key:c.quiz.key}}if(c.solution){if(!b.title||"Exercise"===b.title)b.title=c.solution.title;b.answer_ref={ref:"Node",key:c.solution.key}}d._nodes.push(b)}},_getFileURL:function(a,b){var d=new FileReader;d.onload=function(a){b(a.target.result)};d.readAsDataURL(a)}};b.eventEmission(d,[]);return d}]);angular.module("services.editor").factory("content",["nodedb",function(a){var b={nodeKey:0,getNewKey:function(){b.nodeKey++;return"~"+b.nodeKey},newVideo:function(){var d=new b.VideoNode;a.updateNode(d);return d},newQuiz:function(){var d=new b.QuizNode;a.updateNode(d);return d},newSketch:function(){var d=new b.SketchNode;a.updateNode(d);return d},newFrame:function(){var d=new b.FrameNode;a.updateNode(d);return d},newProgram:function(){var d=new b.ProgrammingNode;a.updateNode(d);return d},newExercise:function(){var d=
new b.ExerciseNode;a.updateNode(d);return d},newLesson:function(){var d=new b.LessonNode;a.updateNode(d);return d},LessonNode:function(){this.title="New Lesson";this.key=b.getNewKey();this.model="Lesson";this.inherit_read_permissions=!1;this.steps_refs=[];this.affiliate_program_refs=[]},VideoNode:function(){this.title="Video";this.key=b.getNewKey();this.model="Video";this.inherit_read_permissions=!1;this.affiliate_program_refs=[]},SketchNode:function(){this.title="Sketch";this.key=b.getNewKey();this.model=
"SketchVideo";this.inherit_read_permissions=!1;this.affiliate_program_refs=[]},FrameNode:function(){this.title="iFrame";this.key=b.getNewKey();this.model="EmbeddedFrame";this.inherit_read_permissions=!1;this.affiliate_program_refs=[];this.external_uri=""},QuizNode:function(){this.title="Quiz";this.key=b.getNewKey();this.model="ImageFormQuiz";this.inherit_read_permissions=!1;this.widgets=[];this.evaluator=new b.FormQuizEvaluator;this.affiliate_program_refs=[]},ProgrammingNode:function(){this.title=
"Program";this.key=b.getNewKey();this.model="ProgrammingQuiz";this.inherit_read_permissions=!1;this.initial_code_files=[new b.FileAttachement];this.evaluator=new b.ProgramEvaluator;this.affiliate_program_refs=[]},ExerciseNode:function(){this.title="Exercise";this.key=b.getNewKey();this.model="Exercise";this.inherit_read_permissions=!1;this.answer_ref=this.quiz_ref=this.lecture_ref=void 0;this.affiliate_program_refs=[];this.tidbits=[];this.answer_plays_on_quiz=this.lecture_plays_on_quiz=!1},CatalogEntry:function(){this.model=
"CatalogEntry";this.subtitle="";this.level="beginner";this.accredited=!1;this.mastery_spec=new b.MasterySpec;this.instructor_refs=[];this.assistant_refs=[];this.expected_learning=this.required_knowledge=this.summary=""},MasterySpec:function(){this.model="MasterySpec";this.badge_thresholds=[0,1,1,1,1];this.weights=[]},MasteryWeightAssignment:function(){this.model="MasteryWeightAssignment";this.node_ref=void 0;this.points=1},RadioButtonWidget:function(){this.model="RadioButtonWidget";this.placement=
{x:0,y:0,width:0,height:0};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value=!1;this.group="none"},CheckboxWidget:function(){this.model="CheckboxWidget";this.placement={x:0,y:0,width:0,height:0};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value=!1},NumericInputWidget:function(){this.model="NumericInputWidget";this.placement={x:0,y:0,width:0.15,height:0.06};this.tabindex=0;this.label="Empty";this.marker="none"},TextInputWidget:function(){this.model="TextInputWidget";
this.placement={x:0,y:0,width:0.15,height:0.06};this.tabindex=0;this.label="Empty";this.marker="none";this.initial_value="";this.text_area=!1},ProgramEvaluator:function(){this.model="ProgramEvaluator";this.requires_gpu=!1;this.deadline_seconds=10;this.execution_language="python";this.legacy_template_refs=[];this.gae_grading_code=this.executor_grading_code=""},CodeGradedEvaluator:function(){this.model="CodeGradedEvaluator";this.requires_gpu=!1;this.deadline_seconds=10;this.execution_language="python";
this.legacy_template_refs=[];this.gae_grading_code=this.executor_grading_code="";this.markers=[]},IFrameEvaluator:function(){this.model="IFrameEvaluator";this.external_uri=this.js_application=this.html_body=this.gae_grading_code=""},FormQuizEvaluator:function(){this.model="FormQuizEvaluator";this.answer_sets=[new b.WidgetGroupEvaluator]},WidgetGroupEvaluator:function(){this.model="WidgetGroupEvaluator";this.widget_graders=[];this.evaluation_matched_comment="Good job!";this.is_correct=!0},SelectionEvaluator:function(){this.model=
"SelectionEvaluator";this.marker="";this.answer=!1},NumericalEvaluator:function(){this.model="NumericalEvaluator";this.marker="";this.upper_bound=this.lower_bound=0},RegexEvaluator:function(){this.model="RegexEvaluator";this.answer=this.marker=""},FileAttachement:function(){this.name="exercise.py";this.text="";this.blob_key=void 0}};return b}]);angular.module("services.editor").factory("mediaUpload",["$http","mixin",function(a,b){var d={PARALLEL_UPLOADS:5,MAX_RETRIES:3,reset:function(){if(d.running)return console.error("Cannot reset mediaUpload while running"),!1;d.totalQueued=0;d.totalFinished=0;d.failedQueue=[];d.mediaQueue=[];d.activeUploads=[];return!0},uploadInProgress:function(){return d.totalQueued>d.totalFinished+d.failedQueue.length},remainingToUpload:function(){return d.totalQueued-(d.totalFinished+d.failedQueue.length)},updateKeys:function(a){if(d.running)console.error("Cannot update media keys while running");
else for(var b=0;b<d.mediaQueue.length;b++){var f=d.mediaQueue[b];f.nodeKey in a&&(f.nodeKey=a[f.nodeKey])}},isKeyEnqueued:function(a){var b,f;for(b=0;b<d.mediaQueue.length;b++)if(f=d.mediaQueue[b],f.nodeKey===a)return!0;for(b=0;b<d.activeUploads.length;b++)if(f=d.activeUploads[b],f.nodeKey===a)return!0;return!1},_removeFromActiveUploads:function(a){for(var b=0;b<d.activeUploads.length;b++)if(d.activeUploads[b]===a){d.activeUploads.splice(b,1);break}},addToQueue:function(a,b,f,g){a={file:a,mediaName:b,
nodeKey:f,doNotProcess:g,failures:0,state:"QUEUED",percent:0};"video"===a.mediaName?d.mediaQueue.push(a):d.mediaQueue.unshift(a);d.totalQueued++},runQueue:function(){if(d.running)console.error("Already running");else if(0===d.mediaQueue.length)console.warn("no media to upload");else{d.running=!0;for(var a=0;a<d.PARALLEL_UPLOADS&&0<d.mediaQueue.length;a++)d._startNextUpload()}},_startNextUpload:function(){d.totalFinished+d.failedQueue.length===d.totalQueued&&(d.running=!1,d.emitEvent("allFinished"));
if(d.running&&0<d.mediaQueue.length){var a=d.mediaQueue.shift();d.activeUploads.push(a);d._uploadMediaFile(a)}},_uploadMediaFile:function(c){d.emitEvent("started",c);var b="/api/nodes/"+c.nodeKey+"/"+c.mediaName+"/upload_url?fresh=true";c.doNotProcess&&(b+="&process=false");a.get(b).success(function(a){d._blobUploadHandler(c,a.url)}).error(function(){d._failedUpload(c)})},_failedUpload:function(a){console.warn("retry on "+a.file.name);a.state="FAILED_GETURL";a.failures++;a.failures>=d.MAX_RETRIES?
(a.state="TOO_MANY_RETRIES",d.failedQueue.push(a),d.emitEvent("error",a),d._removeFromActiveUploads(a),d._startNextUpload()):d._uploadMediaFile(a)},_finishedUpload:function(a){d.totalFinished++;d.emitEvent("finished",a);d._removeFromActiveUploads(a);d._startNextUpload()},_blobUploadHandler:function(a,b){var f=new XMLHttpRequest;f.addEventListener("progress",function(b){b.lengthComputable&&(a.progress=Math.round(b.loaded/b.total),1===a.progress&&(a.state="PROCESSING"),d.emitEvent("progress",a))},!1);
f.addEventListener("abort",function(){a.state="ABORTED";d._failedUpload(a)});f.addEventListener("load",function(b){200!==b.srcElement.status?(console.error("Load event returned "+b.srcElement.status),a.state="FAILED_LOAD",d._failedUpload(a)):(a.state="SUCCESS",d._finishedUpload(a))});f.addEventListener("error",function(){a.state="FAILED_XHR";d._failedUpload(a)});f.open("POST",b);f.setRequestHeader("X-XSRF-Token",document.cookie.match(/(^|; *)XSRF-TOKEN=(.*?)(;|$)/)[2]);var g=new FormData;g.append("file",
a.file);f.send(g);a.state="UPLOADING"}};b.eventEmission(d,["allFinished","finished","started","error","progress"]);d.reset();return d}]);angular.module("services.editor").factory("nodedb",["api","mediaUpload","mixin",function(a,b,d){var c={_nodes:{},_originalNodes:{},doNotPostProcessUploads:!0,networkState:!1,saveRetries:0,MAX_RETRIES:3,errors:[],_logError:function(a){console.error(a);c.errors.push({time:new Date,msg:a});c.emitEvent("error",a)},isTemporaryKey:function(a){return"~"===a.substr(0,1)},isDirty:function(a){return!angular.equals(a,c._originalNodes[a.key])},_setNetworkState:function(a){c.networkState=a;c.emitEvent("network",
a)},_keyFromKeyOrRef:function(a){var c=a;if(c)return a.hasOwnProperty("key")&&a.hasOwnProperty("ref")&&(c="Node"===a.ref?a.key:void 0),c},_fetchNodeFromServer:function(b,d){b&&(d||(d=0),console.log("fetching from server node "+b+" with depth="+d),"~"===b.substr(0,1)?console.warn("Attempt to fetch temporary key "+b+" from the server ignored"):"Saving"===c.networkState?c._logError("Network save in progress, cannot load data while saving."):(c.saveRetries=0,c._setNetworkState("Loading"),a.get("/nodes/"+
b+"?depth="+d).success(c._processFromServer).error(c._errorFromServer)))},_processFromServer:function(a){console.log("Updating nodedb with new data from server");c._setNetworkState(!1);c.saveRetries&&c._logError("Save retry succeeded! Yay.");angular.forEach(a.references.Node,c.updateNode);b.updateKeys(a.key_changes);c.emitEvent("keyChange",a.key_changes);b.runQueue()},updateNode:function(a){if(!a||!a.key)console.warn("updateNode passed a non-node object:"),console.warn(a);else{var b=a.key,d=c[b];
d&&(angular.equals(d,a)||console.warn("Incoming update to node "+b+" is different from local copy."));c._nodes[b]=a;c.isTemporaryKey(b)||(c._originalNodes[b]=angular.copy(a));c.emitEvent("nodeUpdate",b)}},_errorFromServer:function(a){c._logError(a.error);"Saving"===c.networkState&&(c.saveRetries++<c.MAX_RETRIES?(c._setNetworkState(!1),c._logError("Save failed.  Retry "+c.saveRetries),c._updateTimestampsFromServerAndSave()):c._logError("Too many retries.  Gave up trying to save :("));c._setNetworkState(!1)},
getNode:function(a,b,d){var a=c._keyFromKeyOrRef(a),h=c._nodes[a];b&&"~"!==a.substr(0,1)&&c._fetchNodeFromServer(a,d);return h},_collectUploads:function(a){for(var d=0;d<a.length;d++){var g=c._nodes[a[d].key];g.__FILE_background_image?b.addToQueue(g.__FILE_background_image,"background_image",g.key,c.doNotPostProcessUploads):g.__FILE_video&&b.addToQueue(g.__FILE_video,"video",g.key,c.doNotPostProcessUploads)}},_updateTimestampsFromServerAndSave:function(){var b=_.map(c.saveNodeData.nodes,function(a){return a.key});
c._setNetworkState("Loading");a.get("/nodes?keys="+JSON.stringify(b)).success(function(a){c._setNetworkState(!1);_.each(a.references.Node,c._updateSaveNodeDataTimestampFromNode);c._saveToServer()}).error(function(){c._setNetworkState(!1);c._logError("Failed to fetch updated timestamps before saving");c._saveToServer()})},_updateSaveNodeDataTimestampFromNode:function(a){for(var b,d=0;d<c.saveNodeData.nodes.length;d++)c.saveNodeData.nodes[d].key===a.key&&(b=c.saveNodeData.nodes[d]);b&&(b.last_edit_time=
a.last_edit_time)},_saveNodes:function(a){if(!b.reset())return alert("Cannot save while uploading media, please wait until all uploads havecompleted and try again."),!1;c.saveRetries=0;c._collectUploads(a);c.saveNodeData={nodes:a};c._saveToServer();return!0},_saveToServer:function(){c.networkState?c._logError("Cannot save while a network operation is already in progress"):(c._setNetworkState("Saving"),a.post("/nodes",c.saveNodeData).success(c._processFromServer).error(c._errorFromServer))},saveTreeFrom:function(a,
b,d){var h=!1;if(void 0===b)b=0;else{if(0>b)return;b--}d||(d=[],h=!0);if(a){if(c.isDirty(a)){var j=angular.copy(a);j.__FILE_video&&delete j.__FILE_video;j.__FILE_background_image&&delete j.__FILE_background_image;j.__URL_background_image&&delete j.__URL_background_image;d.push(j)}switch(a.model){case "Lesson":for(j=0;j<a.steps_refs.length;j++)c.saveTreeFrom(c.getNode(a.steps_refs[j]),b,d);break;case "Exercise":c.saveTreeFrom(c.getNode(a.lecture_ref),b,d),c.saveTreeFrom(c.getNode(a.quiz_ref),b,d),
c.saveTreeFrom(c.getNode(a.answer_ref),b,d),_.each(a.tidbits,function(a){c.saveTreeFrom(c.getNode(a.tidbit_ref),b,d)})}}return h?c._saveNodes(d):d}};b.addEventListener("finished",function(a){c._fetchNodeFromServer(a.nodeKey)});d.eventEmission(c,["nodeUpdate","network","keyChange","error"]);return c}]);angular.module("services.lesson").service("executor",["mixin","$http","dateTime","lessonContentContext","lesson","iframeEvaluator","$location",function(a,b,d,c,e,f,g){var h={submitFiles:function(a,l,k){var m=k.operation||"TEST",n=c.getCurrent(),w=d.getCurrentAsUTC(),p={model:"Submission",operation:m,parts:_.map(a,function(a){return{model:"SubmissionPart",marker:a.name,content:a.content}})},q={submission:p,client_route:"!"+g.path()},u=function(a){h.emitEvent("evaluation",{evaluation:a.data.evaluation,
submission:p,context:n,timestamp:w});return a};h.emitEvent("submit");e.updateLastSubmissionForMorsel(l,p);return k.useIframe?f.evaluate(p,l,k.iframeUrl).then(function(a){q.submission.client_execution=a.execution;q.submission.client_execution.raw_result=JSON.stringify(a.execution.raw_result);return b.post("/api/nodes/"+l+"/evaluation?_method=GET",q,{timeout:3E4}).then(u)},function(){q.execution={model:"SubmissionExecution",raw_result:"",status:"te"};return b.post("/api/nodes/"+l+"/evaluation?_method=GET",
q,{timeout:3E4}).then(u)}):b.post("/api/nodes/"+l+"/evaluation?_method=GET",q,{timeout:3E4}).then(u)}};return a.eventEmission(h,["update","submit","evaluation"])}]);angular.module("services.forum").factory("forumService",["$http","$q",function(a,b){return{getPosts:function(d){var c=b.defer();window.FORUM_JSONP_CALLBACK=function(a){for(var b=[],d=0;d<a.length;++d)b[d]={},b[d].title=a[d].title,b[d].href=a[d].href,b[d].date=a[d].date,b[d].score=a[d].score,b[d].answer_count=a[d].answer_count,b[d].views=a[d].views;c.resolve(b)};a.jsonp("https://forums.udacity.com/tags/"+d+"/interesting/?callback=FORUM_JSONP_CALLBACK").success(function(a){return a}).error(function(){});
return c.promise}}}]);angular.module("services.lesson").factory("imageQuiz",["mixin","api","dateTime","lesson","lessonContentContext",function(a,b,d,c,e){function f(a,c){a&&_.each(c.widgets,function(c){var b=_.find(a.parts,function(a){return a.marker===c.marker});b&&("RadioButtonWidget"===c.model?b.content&&(k.radioGroupAnswers[c.group]=b.marker):k.answers[c.marker]=b.content)})}var g=null,h=null,j=null,l;c.addEventListener("morselChange",function(a){l=a},{replayLast:!0});var k={answers:null,radioGroupAnswers:null,setQuiz:function(a){g=
a;var d=Math.round((new Date).getTime());h=d;k.answers={};_.each(g.widgets,function(a){k.answers[a.marker]=a.initial_value});k.radioGroupAnswers={};g.hasOwnProperty("lastSubmission")?(f(g.lastSubmission,g),k.emitEvent("ready")):b.get("/nodes/"+a.key+"/state").success(function(a){if(l.key===g.key&&d===h){var b=a.nodestates[0]?a.nodestates[0].last_submission_data:null,a=a.nodestates[0]?a.nodestates[0].bin_codes:null;f(b,g);c.updateLastSubmissionForMorsel(g.key,b);c.mergeBinCodesForMorsel(g.key,a);k.emitEvent("ready")}}).error(function(a){console.error("Error fetching quiz progress data");
console.error(a)})},getQuiz:function(){return g},submit:function(){_.each(g.widgets,function(a){"RadioButtonWidget"===a.model&&(k.answers[a.marker]=k.radioGroupAnswers[a.group]===a.marker)});if(g.evaluator){var a=Math.round((new Date).getTime()),f=g.key;j=a;var h=e.getCurrent(),p=d.getCurrentAsUTC(),q={model:"Submission",operation:"GRADE",parts:_.map(k.answers,function(a,c){return{model:"SubmissionPart",marker:c,content:a}})},u={submission:q};c.updateLastSubmissionForMorsel(g.key,q);b.post("/nodes/"+
g.key+"/evaluation?_method=GET",u).success(function(b){k.emitEvent("evaluation",{evaluation:b.evaluation,submission:q,context:h,timestamp:p});f===l.key&&a===j&&(b.evaluation?(c.mergeBinCodesForMorsel(g.key,b.evaluation.bin_codes),!0===b.evaluation.passed?(c.markMorselAsCompleted(f),g.containingExercise&&c.markMorselAsCompleted(g.containingExercise.key),k.emitEvent("correct",{quiz:g,comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes})):!1===b.evaluation.passed?k.emitEvent("incorrect",{quiz:g,
comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes}):null===b.evaluation.passed?k.emitEvent("recorded",{quiz:g,comment:b.evaluation.comment,binCodes:b.evaluation.bin_codes}):console.error("invalid evaluation.passed value:"+b.evaluation.passed)):k.emitEvent("error",{morselId:g.key,comment:"We encountered an error. Please try submitting again."}))}).error(function(){k.emitEvent("error",{morselId:g.key,comment:"We encountered an error. Please try submitting again."})})}else _.reduce(g.widgets,
function(a,c){return a&&k.answers[c.marker]===c.correct_value},!0)?k.emitEvent("correct",{morselId:g.key}):k.emitEvent("incorrect",{morselId:g.key})}};return a.eventEmission(k,"ready incorrect correct recorded error evaluation".split(" "))}]);angular.module("services.utility").factory("isTrustedDomain",[function(){return function(a){return"https://www.udacity.com"===a||"http://localhost:8080"===a||"http://localhost:8087"===a||"https://assignments-dot-udacity-extras.appspot.com"===a}}]);angular.module("services.lesson").factory("codeEditor",["mixin","codeMirror","libraryLoader",function(a,b,d){function c(a){return-1!==a.indexOf(".cu")?"cuda":-1!==a.indexOf(".py")?"python":-1!==a.indexOf(".js")?"javascript":-1!==a.indexOf(".html")?"html":-1!==a.indexOf(".css")?"css":-1!==a.indexOf(".cpp")?"cpp":-1!==a.indexOf(".java")?"java":-1!==a.indexOf(".json")?"javascript":-1!==a.indexOf(".e")?"specman":"plaintext"}function e(a){a&&(g=a,b.setActiveLanguage(c(a.name)),b.setContents(a.text),"javascript"===
c(a.name)?d.loadLibraries(["codemirror","jshint"]).then(function(){b.setOptions({gutters:["CodeMirror-lint-markers"],lintWith:CodeMirror.javascriptValidator})}):b.setOptions({gutters:[],lintWith:null}),h.emitEvent("activeFileChanged",{newActiveFile:a}))}var f=null,g=null,h={loadFiles:function(a){var c=!0;_.each(a,function(a){if(!_.isObject(a)||!a.name||!a.hasOwnProperty("text"))c=!1,console.error("Failed to load files. Invalid file: ",a)});if(c)return d.loadLibraries(["codemirror"]).then(function(){f=
_.map(a,function(a){return{name:a.name,text:a.text}});e(f[0]);h.emitEvent("filesLoaded",{files:f})})},getAllFiles:function(){g.text=b.getContents();return f},switchToFile:function(a){g.text=b.getContents();e(_.find(f,function(c){return c.name===a}))}};return a.eventEmission(h,["filesLoaded","activeFileChanged"])}]);angular.module("services.lesson").factory("iframeEvaluator",["mixin","$q","$timeout","isTrustedDomain",function(a,b,d,c){var e=null,f=null,g=null,h={evaluate:function(a,c,k){var m=b.defer();e=m;f=a;g=k;h.emitEvent("newEvaluation",{nodeId:c,iframeUrl:k});d(function(){m.reject("timeout")},6E4);return m.promise}};window.addEventListener("message",function(a){if(c(a.origin)){var b;a=a.data;try{b=JSON.parse(a)}catch(k){b=a}"ready"===b.messageType?h.emitEvent("postMessageRequest",{submission:f,iframeUrl:g}):
"execution"===b.messageType&&d(function(){e.resolve(b.result)})}},!1);return a.eventEmission(h,["newEvaluation","postMessageRequest"])}]);angular.module("services.lesson").factory("lesson",["$http","$q","mixin","lessonContentContext","typeForTag","freshContent",function(a,b,d,c,e,f){function g(a,c){var b=_.find(a,function(a){for(var b=c.length-1;0<=b;b--){var d=a.content_context[b];if(!d||d.node_ref.key!==c[b].node_key||d.tag!==c[b].tag)return!1}return!0});b&&(b=_.object(_.map(b.content_context,function(a){return[e[a.tag]+"Key",a.node_ref.key]})));return b}var h=null,j=null,l=null,k=null,m=null,n=null,w=null,p={announcePendingCourseChange:function(){p.emitEvent("pendingCourseChange",
{course:h})},changeCourse:function(d){var e=Math.round((new Date).getTime());w=e;b.all([a.get("/api/nodes/"+d+"?depth=1&fresh="+(!0===f)+"&required_behavior=view"),a.get("/api/nodes/"+d+"/state?fresh=true")]).then(function(a){var b=a[0].data,f=a[1].data,k=a=null;if(e===w){h=b.references.Node[d];j=b.references.Node;h.steps_refs=_.reject(h.steps_refs,function(a){return!j[a.key]});if(b=_.find(f.nodestates,function(a){return a.node_ref.key===d}))(k=g(b.last_interactions,c.getCurrent()))&&k.lessonKey&&
(a=j[k.lessonKey]);p.emitEvent("courseChange",{course:h,lessons:_.map(h.steps_refs,function(a,c){var b=j[a.key];b.indexInCourse=c;return b}),lastLessonVisited:a,hasActivity:null!==k})}},function(a){e===w&&a.status&&403===a.status&&p.emitEvent("coursePermissionDenied",d)})},announcePendingLessonChange:function(){p.emitEvent("pendingLessonChange",{lesson:l})},changeLesson:function(d){var e=Math.round((new Date).getTime());n=e;b.all([a.get("/api/nodes/"+d+"?depth=2&fresh="+(!0===f)+"&required_behavior=view"),
a.get("/api/nodes/"+d+"/state?fresh=true")]).then(function(a){if(e===n){var b=a[0].data,f=a[1].data,a=null;l=b.references.Node[d];k=b.references.Node;l.steps_refs=_.reject(l.steps_refs,function(a){return!k[a.key]});_.each(l.steps_refs,function(a,c){var b=k[a.key];if(!b)throw Error("Expected a morsel but got "+JSON.stringify(b,2));"Exercise"===b.model&&(_.each(["lecture_ref","quiz_ref","answer_ref"],function(a){b[a]&&(b[a]=k[b[a].key],b[a]&&(b[a].containingExercise=b))}),_.each(b.tidbits,function(a){a.tidbit_ref=
k[a.tidbit_ref.key];a.tidbit_ref&&(a.tidbit_ref.containingExercise=b)}));k[a.key].indexInLesson=c});_.each(k,function(a){if("ImageFormQuiz"===a.model||"ProgrammingQuiz"===a.model)a.binCodes=[]});if(b=_.find(f.nodestates,function(a){return a.node_ref.key===d}))_.each(b.completed_descendant_node_refs,function(a){p.markMorselAsCompleted(a.key)}),(b=g(b.last_interactions,c.getCurrent()))&&b.morselKey&&(a=k[b.morselKey]);p.emitEvent("lessonChange",{lesson:l,morsels:_.map(l.steps_refs,function(a){return k[a.key]}),
lastMorselVisited:a})}},function(a){e===n&&a&&(a.status&&403===a.status)&&p.emitEvent("lessonPermissionDenied",d)})},announcePendingMorselChange:function(a){p.emitEvent("pendingMorselChange",{from:m,to:a})},changeMorsel:function(a){m=k[a];p.emitEvent("morselChange",m)},markMorselAsCompleted:function(a){k[a]?k[a].completed=!0:console.error("Can't find morsel #"+a+" to mark it as completed")},updateProgressForMorsel:function(a,c){k[a]&&k[c]?k[a].progressNodeId=c:console.error("Can't find container morsel #"+
a+" or perhaps progress morsel #"+c+" to update progress")},updateLastSubmissionForMorsel:function(a,c){k[a]?k[a].lastSubmission=c:console.error("Can't find morsel #"+a+"to update activity")},mergeBinCodesForMorsel:function(a,c){k[a]&&(k[a].binCodes=_.union(k[a].binCodes,c))}};return d.eventEmission(p,"pendingCourseChange courseChange pendingLessonChange lessonChange pendingMorselChange morselChange lessonPermissionDenied coursePermissionDenied".split(" "))}]);angular.module("services.lesson").factory("lessonPrefetcher",["$http","$timeout","lesson",function(a,b,d){var c=null;d.addEventListener("courseChange",function(a){c=a.lessons},{replayLast:!0});d.addEventListener("courseChange",function(){d.addEventListener("lessonChange",function(d){var f=_.find(c,function(a){return a.key===d.lesson.key}).indexInCourse;if(0<f){var g=c[f-1].key;b(function(){a.get("/api/nodes/"+g+"?depth=2&fresh=false&required_behavior=view")},1E4,!1)}if(0<=f&&f<c.length-1){var h=c[f+
1].key;b(function(){a.get("/api/nodes/"+h+"?depth=2&fresh=false&required_behavior=view")},7E3,!1)}},{replayLast:!0})},{removeAfterFired:!0,replayLast:!0});d.addEventListener("morselChange",function(c){if(("Video"===c.model||"SketchVideo"===c.model)&&c.containingExercise&&c.containingExercise.lecture_ref&&c.containingExercise.lecture_ref.key===c.key&&c.containingExercise.quiz_ref&&!c.containingExercise.quiz_ref.lastSubmission){var b=c.containingExercise.quiz_ref;a.get("/api/nodes/"+b.key+"/state").success(function(a){b.lastSubmission||
d.updateLastSubmissionForMorsel(b.key,a.nodestates[0]?a.nodestates[0].last_submission_data:null)}).error(function(){console.error("Failed to prefetch last submission for quiz with id "+b.key)})}});return{}}]);angular.module("services.lesson").factory("lessonActivityTracker",["$http","lesson","lessonContentContext","youtubeVideoPlayer","dateTime","imageQuiz","executor","mixin","$routeParams",function(a,b,d,c,e,f,g,h,j){function l(a){function c(a){_.find(a.context,function(a){return"m-"===a.tag})||alert("A severe bug has occurred that we are trying to track down!  If you can please contact nicolas@udacity.com immediately, that would be very helpful. If not, please know that your last submission was lost and please resubmit again. Refreshing the page may help, but will lose your latest submission, so please copy it down before refreshing. We are very sorry about this! \n\nDebug Information, please include this in your email if you send one:\n"+
JSON.stringify(j,2)+"\n___\n"+JSON.stringify(d.getCurrent(),2)+"\n___\n"+window.location.href+"\n____\n"+JSON.stringify(a.evaluation,2)+"\n____\n"+new Date);return n(_.map(_.without([a.submission,a.evaluation],null,void 0),function(c){return{context:a.context,data:c}}),{chain:!0,timestamp:a.timestamp})}function b(){e+=1;3>e?c(a).then(function(){},b):w.emitEvent("quizActivityLogFailure",{context:a.context})}var e=0;a.evaluation&&(a.evaluation.model="SubmissionEvaluation");c(a).then(function(){},b)}
var k=null,m=null,n=function(c,b){var b=b||{},d={items:_.map(c,function(a){return{occurrence_time:b.timestamp||e.getCurrentAsUTC(),content_context:_.without(a.context,null,void 0,"none"),data:a.data}}),current_time:e.getCurrentAsUTC()},f="/api/activity";b.chain&&(f+="?related_chain=true");return a.post(f,d).then(function(a){200!==a.status&&(console.error("Error when trying to post activity. Response:"),console.error(a))})};c.addEventListener("videoPlay",function(a){k=a},{replayLast:!0});c.addEventListener("videoPause",
function(a){null!==k&&(null!==a&&void 0!==a)&&(m=a,n([{context:d.getCurrent(),data:{model:"PlayableView",start:k,stop:m}}]));k=m=null},{replayLast:!0});f.addEventListener("evaluation",l,{replayLast:!0});g.addEventListener("evaluation",l,{replayLast:!0});var w={logNodeVisit:function(){n([{context:d.getCurrent(),data:{model:"NodeVisit"}}])}};return h.eventEmission(w,["quizActivityLogFailure"])}]);angular.module("services.lesson").factory("lessonContentContext",["$routeParams","tags",function(a,b){return{getCurrent:function(){return _.without(_.map(["course","lesson","exercise","morsel"],function(d){if(a[d+"Key"]&&"none"!==a[d+"Key"])return{tag:b[d],node_key:a[d+"Key"]}}),void 0,null)}}}]);angular.module("services.lesson").factory("programmingQuiz",["$http","mixin","codeEditor","executor","lesson",function(a,b,d,c,e){function f(a){return _.map(a,function(a){return{name:a.name,content:a.text}})}function g(a){return _.map(a,function(a){var c={name:a.name};a._content&&"text/plain"===a._content._content_type?(c.text=a._content._plaintext,c.kind="plaintext"):a._content&&-1!==a._content._content_type.indexOf("image")&&(c.servingUrl=a._content._serving_url,c.kind="image");return c})}function h(a,
c){a&&_.each(c,function(c){var b=_.find(a.parts,function(a){return a.marker===c.name});b&&(c.text=b.content)})}var j=null,l=null,k=null,m;e.addEventListener("morselChange",function(a){m=a},{replayLast:!0});var n=null,w=null,p=null,q=null,u={init:function(c){var b=Math.round((new Date).getTime()),f=c.key;j=b;w=g(c.initial_code_files);n=g(c.initial_code_files);p=c.key;q=c;c.hasOwnProperty("lastSubmission")?(h(c.lastSubmission,n),d.loadFiles(n).then(function(){u.emitEvent("ready")})):a.get("/api/nodes/"+
c.key+"/state").success(function(a){if(f===m.key&&b===j){var c=a.nodestates[0],a=c?c.last_submission_data:null,c=c?c.bin_codes:[];h(a,n);e.updateLastSubmissionForMorsel(p,a);e.mergeBinCodesForMorsel(p,c);d.loadFiles(n);u.emitEvent("ready")}}).error(function(a){console.error("Error fetching programming quiz progress data");console.error(a)})},submit:function(){var a=Math.round((new Date).getTime()),b=m.key;l=a;c.submitFiles(f(d.getAllFiles()),p,{operation:"GRADE",useIframe:m.evaluator&&"IFrameEvaluator"===
m.evaluator.model,iframeUrl:m.evaluator&&m.evaluator.external_uri}).then(function(c){c=c.data;a===l&&b===m.key&&(e.mergeBinCodesForMorsel(b,c.evaluation.bin_codes),c.evaluation.passed&&(e.markMorselAsCompleted(b),q.containingExercise&&e.markMorselAsCompleted(q.containingExercise.key)),c.evaluation.comment&&c.evaluation.comment.indexOf("est case input")&&(u.emitEvent("run",{morselId:b,result:{stdout:c.evaluation.comment,stderr:null,images:null}}),c.evaluation.comment="Please see detailed feedback in the output area below."),
u.emitEvent("evaluated",{quiz:m,result:c.evaluation}))},function(a){u.emitEvent("evaluationError",a.data)})},run:function(){var a=Math.round((new Date).getTime()),b=m.key;k=a;c.submitFiles(f(d.getAllFiles()),p,{operation:"TEST",useIframe:m.evaluator&&"IFrameEvaluator"===m.evaluator.model,iframeUrl:m.evaluator&&m.evaluator.external_uri}).then(function(c){c=c.data;if(a===k&&b===m.key){var d={};c.execution&&c.execution._output_attachments&&(c=c.execution._output_attachments,d=g(c),d={stdout:c.stdout?
c.stdout._content._plaintext:null,stderr:c.stderr?c.stderr._content._plaintext:null,images:_.filter(d,function(a){return"image"===a.kind})});u.emitEvent("run",{morselId:b,result:d})}},function(a){u.emitEvent("runError",a.data)})},reset:function(){d.loadFiles(w)}};return b.eventEmission(u,["evaluated","evaluationError","run","runError","ready"])}]);angular.module("services.lesson").factory("tidbits",[function(){return{isTidbitRelevant:function(a,b,d){return _.some(a.bin_code_groups,function(a){return(!d||a.bin_codes.length)&&_.every(a.bin_codes,function(a){return _.contains(b,a)})})}}}]);angular.module("services.lesson").factory("viewerSettings",["mixin",function(a){var b={autoPlay:!0},d={set:function(a,e){if(b.hasOwnProperty(a)){var f=b[a];b[a]=e;d.emitEvent("change",{name:a,oldValue:f,newValue:e})}else console.error("can't set invalid setting: "+a)},get:function(a){if(b.hasOwnProperty(a))return b[a];console.error("Can't get invalid setting: "+a)}};return a.eventEmission(d,["change"])}]);angular.module("services.utility").factory("libraryLoader",["$q","$rootScope","cacheVersion",function(a,b,d){var c={codemirror:"/media/js/standalone/libs/codemirror/codemirror-custom.min.js?"+d,mathquill:"/media/js/standalone/libs/mathquill.min.js?"+d,jshint:"/media/js/standalone/libs/jshint/jshint-1.0.0.min.js"},e={};return{loadLibraries:function(d){return a.all(_.map(d,function(d){var f=c[d]?c[d]:d,j=a.defer();e[d]?d=e[d]:(e[d]=j.promise,jQuery.ajax({dataType:"script",cache:!0,url:f}).success(function(){j.resolve();
b.$apply()}).error(function(){j.reject();b.$apply()}),d=j.promise);return d}))}}}]);angular.module("udacity.core").run(function(){window.PRODUCTION&&(console.log=function(){},console.warn=function(){},console.error=function(){})});angular.module("services.utility").factory("markdownConverter",[function(){return new window.Markdown.getSanitizingConverter}]);angular.module("services.utility").service("mixin",["callbackList",function(a){return{eventEmission:function(b,d){var c=_.object(_.map(d,function(c){return[c,a.create()]}));if(!_.isArray(d)||!_.all(d,function(a){return _.isString(a)}))throw"eventNames must be an array of strings";if(!_.isObject(b))throw"targetObject must be an object to mix into";var e=function(a,d,e){if(c[a])e();else throw d;return b};if(_.intersection(_.keys(b),["addEventListener","removeEventListener","emitEvent"]).length)throw"Can't add event methods--they already exist!";
b.addEventListener=function(a,d,h){var h=h||{},j=_.without(_.keys(h),"replayLast","removeOnDestructionOf","removeAfterFired");if(j.length)throw Error("Unsupported options "+j+" when adding event listener");return e(a,'Cannot listen for non-emitted event "'+a+'"',function(){if(!_.isFunction(d))throw Error('You must provide a callback to run when the "'+a+'" event is emitted');c[a].add(d,h.replayLast,h.removeAfterFired);_.isObject(h.removeOnDestructionOf)&&h.removeOnDestructionOf.$on&&h.removeOnDestructionOf.$on("$destroy",
function(){b.removeEventListener(a,d)})})};b.removeEventListener=function(a,b){return e(a,'Cannot remove listener from non-emitted event "'+a+'"',function(){c[a].remove(b)})};b.emitEvent=function(a,b){return e(a,"Cannot emit invalid event "+a+". Add to exposed events when mixing in.",function(){if(void 0===b||null===b)b={};c[a].fire(b)})};return b}}}]);angular.module("services.reviews").factory("reviews",["api",function(a){return{getReviews:function(b,d,c,e,f){return a.post("/reviews?_method=GET",{entity_key:b,sort_order:e,paging:{offset:d*c,limit:c,cursor_map:f}},{})},vote:function(b,d){var c={score_type:"thumbs",score_str:d};return a.post("/users/me/reviews/"+encodeURIComponent(b),c)}}}]);angular.module("services.lesson").factory("sketch",["$http","mixin",function(a,b){function d(a){a=a||0;p=[];q=[];u=[];for(var c=0;c<n.length;c++)n[c].drawnUpTo=0;for(c=0;c<n.length;c++)if(n[c].start>a){p=n.slice(c);q=n.slice(0,c);return}p=[];q=n.slice(0,n.length)}function c(a){for(var c=p.length,b=[],d=0;d<c&&!(p[d].start>a);d++)q.push(p[d]),b.push(d);for(c=b.length-1;0<=c;c--)p.splice(b[c],1);b=[];for(c=0;c<q.length;c++)if(d=q[c],"background"===d.type)e(d),u.push(d),b.push(c);else if(d.points_and_times[d.drawnUpTo][2]<
a){var f;f=d;var g=a;s.beginPath();s.lineWidth=f.meta.width;s.globalAlpha=f.meta.alpha;"erase"===f.type?s.globalCompositeOperation="destination-out":(s.strokeStyle=f.meta.color,s.globalCompositeOperation="source-over");for(var h=!0,k=f.drawnUpTo;k<f.points_and_times.length;k++)if(f.points_and_times[k][2]>g){f.drawnUpTo=k;break}else if(s.lineCap="round",h=!0,m)if(0===k)if(s.moveTo(f.points_and_times[f.drawnUpTo][0],f.points_and_times[f.drawnUpTo][1]),0<f.points_and_times.length){var j=l(f.points_and_times[0],
f.points_and_times[1]);s.lineTo(j[0],j[1])}else s.fillStyle=f.meta.color,s.arc(f.points_and_times[k][0],f.points_and_times[k][1],f.meta.width/2,0,2*Math.PI,!1),s.fill(),h=!1;else if(k===f.points_and_times.length-1)s.moveTo(f.points_and_times[k-1][0],f.points_and_times[k-1][1]),s.lineTo(f.points_and_times[k][0],f.points_and_times[k][1]);else{var j=l(f.points_and_times[k-1],f.points_and_times[k]),n=l(f.points_and_times[k],f.points_and_times[k+1]);s.moveTo(j[0],j[1]);1>s.globalAlpha&&(s.lineCap="butt");
s.quadraticCurveTo(f.points_and_times[k][0],f.points_and_times[k][1],n[0],n[1])}else 0===k?1===f.points_and_times.length&&(s.fillStyle=f.meta.color,s.arc(f.points_and_times[k][0],f.points_and_times[k][1],f.meta.width/2,0,2*Math.PI,!1),s.fill(),h=!1):(s.moveTo(f.points_and_times[k-1][0],f.points_and_times[k-1][1]),s.lineTo(f.points_and_times[k][0],f.points_and_times[k][1]));h&&s.stroke();f=k===f.points_and_times.length?!0:!1;!0===f&&(u.push(d),b.push(c))}for(a=b.length-1;0<=a;a--)q.splice(b[a],1)}
function e(a){if("color"===a.meta.type)B.fillStyle=a.meta.data,B.fillRect(0,0,v.width,v.height);else if("image"===a.meta.type){var c=new Image;c.onload=function(){B.drawImage(this,0,0,v.width,v.height)};c.src=a.meta.url}}function f(a){for(var c,b=x.width,d=x.height,e=Math.sqrt(b*b+d*d),f=0;f<a.length;f++)if(c=a[f],"omit"===c.type)a.splice(f,1),f--;else{c.start=c.points_and_times[0][2];c.end=c.points_and_times[c.points_and_times.length-1][2];c.drawnUpTo=0;if("stroke"===c.type||"erase"===c.type)c.meta.width=
1<c.meta.width?Math.ceil(c.meta.width/1129.235*e):Math.ceil(c.meta.width*e),"undefined"===typeof c.meta.alpha&&(c.meta.alpha=1);for(var g=0;g<c.points_and_times.length;g++)c.points_and_times[g][0]*=b,c.points_and_times[g][1]*=d}}function g(){c(r.currentTime);r.currentTime===r.duration?(A&&clearTimeout(A),h(z.ENDED)):A=setTimeout(g,30)}function h(a){k=a;t.emitEvent("stateChange",k)}function j(a){var c={};if("object"===typeof a){"undefined"!==typeof a.length&&(c=[]);for(var b in a)"object"===typeof a[b]?
c[b]=j(a[b]):"number"===typeof a[b]?c[b]=a[b]:"string"===typeof a[b]?c[b]=a[b]:"boolean"===typeof a[b]&&(c[b]=!0===a[b]?!0:!1)}return c}function l(a,c){return[(c[0]-a[0])/2+a[0],(c[1]-a[1])/2+a[1],(c[2]-a[2])/2+a[2]]}var k=-2,m=!0,n=[],w=[],p=[],q=[],u=[],r,A,y,x,s,v,B,z={UNLOADED:-2,UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2},t=b.eventEmission({attach:function(c,b){a.get(c._strokes.uri).success(function(a){var d=c._audio.transcodings,e=[{type:"audio/mpeg",src:"http://devel.knowitdevel.appspot.com/api/nodes/143004/audio/transcoding/mp3"},
{type:"audio/ogg",src:"http://devel.knowitdevel.appspot.com/api/nodes/143004/audio/transcoding/ogg"}];if(d&&(void 0!==d.mp3||void 0!==d.ogg))e=[{type:"audio/mpeg",src:d.mp3},{type:"audio/ogg",src:d.ogg}];t.init(a.visual,e,{components:b})})},init:function(a,b,e){h(z.UNLOADED);if(a&&b){w=a;n=j(a);e="undefined"!==typeof e?e:{};if("object"===typeof e.parent){e.size="undefined"!==typeof e.size?e.size:{width:960,height:500};e.oversample="undefined"!==typeof e.oversample?e.oversample:1;var a=e.parent,g=
e.size,e=e.oversample;r=x=v=y=void 0;for(var e="number"===typeof e?e:1,k=a.childNodes.length,l=0;l<k;l++)a.removeChild(a.firstChild);y=document.createElement("div");y.id="canvasroom-container";y.style.cssText="position: relative; height: "+g.height+"px; width: "+g.width+"px";k="position: absolute; top: 0; left: 0; z-index: 1; width: "+g.width+"px; height: "+g.height+"px;";v=document.createElement("canvas");v.id="canvasroom-background";v.width=g.width*e;v.height=g.height*e;v.setAttribute("style",k);
y.appendChild(v);x=document.createElement("canvas");x.id="canvasroom";y.appendChild(x);x.width=g.width*e;x.height=g.height*e;x.setAttribute("style",k);r=document.createElement("audio");r.id="canvasroomAudio";y.appendChild(r);a.appendChild(y)}else if("object"===typeof e.components.container&&"object"===typeof e.components.backgroundCanvas&&"object"===typeof e.components.canvas&&"object"===typeof e.components.audioEl)y=e.components.container,v=e.components.backgroundCanvas,x=e.components.canvas,r=e.components.audioEl;
else{console.error("You must pass in options.parent or options.components!");return}x.getContext&&v.getContext?(s=x.getContext("2d"),B=v.getContext("2d"),s.clearRect(0,0,x.width,x.height),s.lineCap="round",B.clearRect(0,0,v.width,v.height),f(n)):console.error("canvas with ID canvas-room not supported!");a=y;r&&a.removeChild(r);r=new Audio;r.id="canvasroom-audio";for(g=0;g<b.length;g++)e=document.createElement("source"),e.type=b[g].type,e.src=b[g].src,console.log("adding audio source with src= "+b[g].src),
r.appendChild(e);a.appendChild(r);r.load();d(0);c(0);h(z.UNSTARTED);t.emitEvent("ready")}else console.error("DIDN'T GIVE A STROKE OBJECT OR DIDN'T GIVE AN AUDIO OBJECT!")},resize:function(a,c,b){var d=!r.paused;t.pause();var e=r.currentTime;"number"!==typeof a||"number"!==typeof c?console.warn("RESIZE FUNCTION WAS NOT GIVEN PROPER SIZE OPTIONS"):(b="number"===typeof b?b:1,y.style.width=a+"px",y.style.height=c+"px",v.width=a*b,v.height=c*b,v.style.height=c+"px",v.style.width=a+"px",x.width=a*b,x.height=
c*b,x.style.height=c+"px",x.style.width=a+"px",n=j(w),f(n),t.jump(e),d&&t.play())},play:function(){r.paused&&(r.play(),g(),h(z.PLAYING),t.emitEvent("playChange","play"))},pause:function(){r.paused||(r.pause(),A&&clearTimeout(A),h(z.PAUSED),t.emitEvent("playChange","pause"))},jump:function(a){var b=!r.paused;t.pause();s.clearRect(0,0,x.width,x.height);d(a);c(a);r.currentTime=a;b&&t.play();t.emitEvent("scrub",a)},jumpPercent:function(a){t.jump(r.duration*a);t.emitEvent("scrubPercent",a)},highQuality:function(a){if(0===
arguments.length||"undefined"===typeof a)return m;"boolean"===typeof a?m=a:console.warn("highQuality only accepts booleans. You passed in the following type: "+typeof a)},mute:function(){!0!==r.muted&&(r.muted=!0,t.emitEvent("muteChange",!0))},unMute:function(){!1!==r.muted&&(r.muted=!1,t.emitEvent("muteChange",!1))},isMuted:function(){return r.muted},setVolume:function(a){0<=a&&1>=a&&(r.volume=a,t.emitEvent("volumeChange",a))},getVolume:function(){return r.volume},PlayerState:z,getPlayerState:function(){return k},
getCurrentTime:function(){return r.currentTime},currentPosition:function(){return r.currentTime/r.duration},showLists:function(){console.log("baseStrokes");console.log(n);console.log("toDrawList");console.log(p);console.log("drawingList");console.log(q);console.log("drawnList");console.log(u)},showStroke:function(a){console.log(n[a])}},"ready stateChange playChange scrub scrubPercent muteChange volumeChange".split(" "));return t}]);angular.module("services.user").factory("user",["$timeout","api","mixin","basicUser",function(a,b,d,c){for(var e="bio email emailPreferences employerSharing enrollments facebookId firstName googleId enrollments badges hasPassword imageUrl key lastName linkedinUrl location nickname occupation principals registered resume sitePreferences websiteUrl".split(" "),f=function(a,c){var b={},d;for(d in c)if(c.hasOwnProperty(d))if("object"===typeof c[d]){if("undefined"!==typeof a[d]&&null!==a[d]){var e=f(a[d],
c[d][1]);e!=={}&&(b[c[d][0]]=e)}}else b[c[d]]="undefined"!==typeof a[d]?a[d]:null;return b},g=function(a){return f(a,{first_name:"firstName",last_name:"lastName",_registered:"registered",_image_url:"imageUrl",key:"key",_has_password:"hasPassword",employer_sharing:"employerSharing",nickname:"nickname",email:["email",{_verified:"verified",_verification_code_sent:"verificationCodeSent",address:"address"}],email_preferences:["emailPreferences",{master_ok:"masterOK",ok_course:"okCourse"}],site_preferences:["sitePreferences",
{use_html5_player:"useHtml5Player",auto_advance:"autoAdvance",playback_rate:"playbackRate",video_quality:"videoQuality"}],_enrollments:"enrollments",bio:"bio",occupation:"occupation",location:["location",{display_place:"displayPlace",places:"places",coordinates:"coordinates"}],linkedin_url:"linkedinUrl",website_url:"websiteUrl",_facebook_id:"facebookId",_google_id:"googleId",_resume:["resume",{processing_state:"processingState",uri:"url",size:"size",last_upload_time:"lastUploadTime"}],_badges:"badges",
_principals:"principals"})},h=g(c),j={},c=0;c<e.length;c++)j[e[c]]=null;var l=d.eventEmission({userIsLoggedIn:function(){return h.registered},unsetUser:function(){for(var a=0;a<e.length;a++)j[e[a]]=null;l.emitEvent("userUnset",{user:j});l.emitEvent("userChanged",{user:j})},getUser:function(){return j},getBaseUser:function(){return h},fetchFullUser:function(){b.get("/users/me").success(function(a){l.setUser(g(a.user))}).error(function(a,c,b,d){console.warn("The initial user fetch failed...");console.log({status:c,
data:a,config:d})})},setUser:function(a){for(var c=0;c<e.length;c++)a.hasOwnProperty(e[c])&&(j[e[c]]=a[e[c]]);h=angular.copy(j);l.emitEvent("userSet",{user:j});l.emitEvent("userChanged",{user:j})},getUserProp:function(a){return j.hasOwnProperty(a)?j[a]:null},translateUserFromApi:g,isEnrolledIn:function(a){return 0<_.filter(j.enrollments,function(c){return c.node_key===a&&c.is_enrolled}).length},isEnrolledForCreditIn:function(a){var c=["151101088","150207572","151148782","151059885","151254701"];return void 0!==
_.find(j.enrollments,function(b){var d=_.map(b.group_refs,function(a){return a.key});return b.node_key===a&&b.is_enrolled&&0<_.intersection(d,c).length})},isCourseEmailSubscribed:function(a){return 0<_.filter(j.enrollments,function(c){return c.node_key===a&&c.email_ok}).length},changeEnrollment:function(c,d){var e={};e[d?"node_keys_to_join":"node_keys_to_leave"]=[c];b.post("/users/me/enrollments",e).success(function(c){var b=function(){var a={},b=c.modified_enrollments;angular.forEach(b,function(c){a[c.node_key]=
!0});angular.forEach(j.enrollments,function(c){a[c.node_key]||b.push(c)});j.enrollments=b;l.emitEvent("changeEnrollmentComplete",{action:d?"enroll":"unenroll"})};1===c.modified_enrollments.length?UY.pushTrackingEvent("Enrollment",d?"Enroll":"Unenroll",c.modified_enrollments[0].node_key,void 0,b):a(b,0)}).error(function(){console.warn("Failed to join/leave course");l.emitEvent("changeEnrollmentComplete")})},changeEnrollmentSettings:function(a,c){b.post("/users/me/enrollments/"+encodeURIComponent(a)+
"/settings",c).success(function(a){j.enrollments=a.enrollments;l.emitEvent("changeEnrollmentSettingsComplete",a)}).error(function(){console.warn("Failed to change enrollment settings")})},requestPasswordReset:function(a){b.post("/users/send_password_reset_email",{email_address:a}).success(function(a,c,b,d){l.emitEvent("requestPasswordResetSuccess",{status:c,data:a,config:d,headers:b})}).error(function(a,c,b,d){l.emitEvent("requestPasswordResetFailure",{status:c,data:a,config:d,headers:b})})},requestUnsubscribe:function(a){b.post("/users/unsubscribe",
{email_address:a}).success(function(a,c,b,d){l.emitEvent("requestUnsubscribeSuccess",{status:c,data:a,config:d,headers:b})}).error(function(a,c,b,d){l.emitEvent("requestUnsubscribeFailure",{status:c,data:a,config:d,headers:b})})},resetPassword:function(a,c,d){b.post("/users/"+c+"/reset_password",{password:a,code:d}).success(function(a,c,b,d){l.emitEvent("resetPasswordSuccess",{status:c,data:a,config:d,headers:b})}).error(function(a,c,b,d){l.emitEvent("resetPasswordFailure",{status:c,data:a,config:d,
headers:b})})}},"userChanged userSet userUnset changeEnrollmentComplete changeEnrollmentSettingsComplete requestPasswordResetSuccess requestPasswordResetFailure requestUnsubscribeSuccess requestUnsubscribeFailure resetPasswordSuccess resetPasswordFailure".split(" "));return l}]);angular.module("services.utility").factory("api",["$http",function(a){var b={get:function(d,c,e){var f=(new Date).getTime();return b.timeRequest(a.get("/api"+d,c,e),f)},post:function(d,c,e){var f=(new Date).getTime();return b.timeRequest(a.post("/api"+d,c,e),f)},deleteRequest:function(d,c,e){var f=(new Date).getTime();return b.timeRequest(a["delete"]("/api"+d,c,e),f)},timeRequest:function(a,c){return a.success(function(a,b,d){a=d("X-Udacity-Trail");b=(new Date).getTime()-c;d=window.location.pathname+
window.location.hash;0<=b&&36E5>b&&_gaq&&_gaq.push(["_trackTiming",a,"request",b,d])})}};return b}]);angular.module("services.utility").factory("$cookieJar",["$utils",function(a){var b=function(a,b,d,g){a=encodeURIComponent(a)+"="+(d?encodeURIComponent(b):b);angular.isObject(g)&&(angular.isDate(g.expires)&&(a+="; expires="+g.expires.toUTCString()),angular.isString(g.path)&&""!==g.path&&(a+="; path="+g.path),angular.isString(g.domain)&&""!==g.domain&&(a+="; domain="+g.domain),!0===g.secure&&(a+="; secure"));return a},d=function(a,b){var d={};if(angular.isString(a)&&0<a.length)for(var g=a.split(/;\s/g),
h=null,j=null,l=null,k=0,m=g.length;k<m;k++){l=g[k].match(/([^=]+)=/i);if(angular.isArray(l))try{h=decodeURIComponent(l[1]),j=!1===b?g[k].substring(l[1].length+1):decodeURIComponent(g[k].substring(l[1].length+1))}catch(n){}else h=decodeURIComponent(g[k]),j="";d[h]=j}return d};return{exists:function(a){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.exists(): Cookie name must be a non-empty string.");return d(document.cookie,!0).hasOwnProperty(a)},get:function(a,b){var b=angular.isObject(b)?
b:{},f=d(document.cookie,!b.raw);if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.get(): Cookie name must be a non-empty string.");return angular.isUndefined(f[a])?null:angular.isFunction(b.converter)?b.converter(f[a]):f[a]},getSub:function(a,b,d){a=this.getSubs(a);if(null!==a){if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.getSub(): Subcookie name must be a non-empty string.");return angular.isUndefined(a[b])?null:angular.isFunction(d)?d(a[b]):a[b]}return null},getSubs:function(a){if(!angular.isString(a)||
""===a)throw new TypeError("$cookieJar.getSubs(): Cookie name must be a non-empty string.");var b=d(document.cookie,!1);if(angular.isString(b[a])){var f=b[a],a=f.split("&"),b=null,g={};if(0<f.length)for(var f=0,h=a.length;f<h;f++)b=a[f].split("="),g[decodeURIComponent(b[0])]=decodeURIComponent(b[1]);return g}return null},remove:function(c,b){if(!angular.isString(c)||""===c)throw new TypeError("$cookieJar.remove(): Cookie name must be a non-empty string.");b=a.mergeObject(b||{},{expires:new Date(0)});
return this.set(c,"",b)},removeSub:function(a,b,d){d=d||{};if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.removeSub(): Cookie name must be a non-empty string.");if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.removeSub(): Subcookie name must be a non-empty string.");var g=this.getSubs(a);if(angular.isObject(g)&&g.hasOwnProperty(b)){delete g[b];if(d.removeIfEmpty){for(var h in g)if(g.hasOwnProperty(h)&&!angular.isFunction(g[h])&&!angular.isUndefined(g[h]))return this.setSubs(a,
g,d);return this.remove(a,d)}return this.setSubs(a,g,d)}return""},set:function(a,d,f){f=f||{};if(!angular.isString(a))throw new TypeError("$cookieJar.set(): Cookie name must be a string.");if(angular.isUndefined(d))throw new TypeError("$cookieJar.set(): Value cannot be undefined.");a=b(a,d,!f.raw,f);return document.cookie=a},setSub:function(a,b,d,g){if(!angular.isString(a)||""===a)throw new TypeError("$cookieJar.setSub(): Cookie name must be a non-empty string.");if(!angular.isString(b)||""===b)throw new TypeError("$cookieJar.setSub(): Subcookie name must be a non-empty string.");
if(angular.isUndefined(d))throw new TypeError("$cookieJar.setSub(): Subcookie value cannot be undefined.");var h=this.getSubs(a),h=angular.isObject(h)?h:{};h[b]=d;return this.setSubs(a,h,g)},setSubs:function(a,d,f){if(!angular.isString(a))throw new TypeError("$cookieJar.setSubs(): Cookie name must be a string.");if(!angular.isObject(d))throw new TypeError("$cookieJar.setSubs(): Cookie value must be an object.");if(!angular.isObject(d))throw new TypeError("createCookieHashString(): Argument must be an object.");
var g=[],h;for(h in d)d.hasOwnProperty(h)&&(!angular.isFunction(d[h])&&!angular.isUndefined(d[h]))&&g.push(encodeURIComponent(h)+"="+encodeURIComponent(String(d[h])));d=g.join("&");a=b(a,d,!1,f);return document.cookie=a}}}]);angular.module("services.utility").factory("dateTime",["$filter",function(a){return{getCurrentAsUTC:function(){var b=new Date,b=new Date(b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds());return a("date")(b,"yyyy-MM-ddTHH:mm:ss.000")+"Z"},parseDateFromString:function(b){b=new Date(b);return a("date")(b,"yyyy-MM-dd")}}}]);angular.module("services.utility").factory("techDetect",["mixin",function(a){var b,d,c=function(){d={browser:null,version:null,browserDim:null,cookies:null,flash:null,os:null,screenDim:null,screenColorDepth:null,ua:navigator.userAgent||"unspecified UA",lang:navigator.language||"unspecified language"}};c();var e=function(a){for(var c=0;c<a.length;c++){var d=a[c].string,e=a[c].prop;b=a[c].versionSearch||a[c].identity;if(d){if(-1!==d.indexOf(a[c].subString))return a[c].identity}else if(e)return a[c].identity}},
f=function(a){var c=a.indexOf(b);if(-1!==c)return parseFloat(a.substring(c+b.length+1))},g=[{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.userAgent,subString:"OmniWeb",versionSearch:"OmniWeb/",identity:"OmniWeb"},{string:navigator.userAgent,subString:"Safari",identity:"Safari",versionSearch:"Version"},{prop:/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/i.test(navigator.userAgent),identity:"UIWebView",versionSearch:"OS"},{prop:window.opera,identity:"Opera",versionSearch:"Version"},
{string:navigator.vendor,subString:"iCab",identity:"iCab"},{string:navigator.vendor,subString:"KDE",identity:"Konqueror"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.vendor,subString:"Camino",identity:"Camino"},{string:navigator.userAgent,subString:"Netscape",identity:"Netscape"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Gecko",identity:"Mozilla",versionSearch:"rv"},{string:navigator.userAgent,
subString:"Mozilla",identity:"Netscape",versionSearch:"Mozilla"}],h=[{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.userAgent,subString:"iPod",identity:"iOS"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}],j=function(a){if(null===d.browser||a)d.browser=e(g)||"An unknown browser";
return d.browser},l=function(a){if(null===d.version||a)d.version=f(navigator.userAgent)||f(navigator.appVersion)||"an unknown version";return d.version},k=function(a){if(null===d.os||a)d.os=e(h)||"an unknown OS";return d.os},m=function(a){if(null===d.cookies||a)document.cookie="cookietest=1",d.cookies=-1!==document.cookie.indexOf("cookietest="),document.cookie="cookietest=1; expires=Thu, 01-Jan-1970 00:00:01 GMT";return d.cookies},n=function(a){if(null===d.flash||a)try{d.flash=!!(navigator.mimeTypes["application/x-shockwave-flash"]||
window.ActiveXObject&&new window.ActiveXObject("ShockwaveFlash.ShockwaveFlash"))}catch(c){d.flash=!1}return d.flash},w=function(a){if(null===d.browserDim||a)d.browserDim=[$(window).width(),$(window).height()];return d.browserDim},p=function(a){if(null===d.screenDim||a)d.screenDim=[screen.width,screen.height];return d.screenDim},q=function(a){if(null===d.screenColorDepth||a)d.screenColorDepth=screen.colorDepth;return d.screenColorDepth};return a.eventEmission({browserSize:w,browserType:j,browserVersion:l,
cookiesEnabled:m,flashEnabled:n,os:k,screenSize:p,screenColorDepth:q,ua:function(){return d.ua},language:function(){return d.lang},flushCache:c,browserStats:function(a){return{browser:j(a),version:l(a),os:k(a)}},getAllTech:function(a){a=!!a;j(a);l(a);k(a);m(a);n(a);w(a);p(a);q(a);return d}},["browserDetected"])}]);angular.module("services.utility").factory("urlParams",function(){return{getUrlQueryParams:UY.getUrlQueryParams,getDecodedURIComponent:UY.getDecodedURIComponent}});angular.module("services.utility").factory("$utils",[function(){return{mergeObject:function(){var a={},b=arguments,d=b.length,c;for(c=0;c<d;c+=1)_.extend(a,b[c],!0);return a}}}]);angular.module("services.utility").factory("validator",[function(){var a={valid:!0,errorText:""},b={noop:function(){return a},required:function(b,c){return"string"===typeof b&&""===b.replace(/^\s\s*/,"").replace(/\s\s*$/,"")||"undefined"===typeof b||"boolean"===typeof b&&!b?{valid:!1,errorText:c+" is required."}:a},strLen:function(b,c,e){("string"!==typeof b||"string"!==typeof c||"object"!==typeof e||2!==e.length)&&console.error("Wrong parameters passed to strLen validator for "+c);var b=b.length,
f=e[0],e=e[1];if("number"===typeof f&&"number"===typeof e){if(f===e&&f!==b)return{valid:!1,errorText:c+" has to be exactly "+e+" characters long."};if(b<f||b>e)return{valid:!1,errorText:c+" has to be between "+f+" and "+e+" characters long."}}else{if("number"===typeof f&&b<f)return{valid:!1,errorText:c+" has to be more than "+f+(1>=f?" character":" characters")+" long."};if("number"===typeof e&&b>e)return{valid:!1,errorText:c+" has to be "+(1>=e?"less than 1 character":"fewer than "+e+" characters")+
" long."}}return a},numericString:function(b,c){return"string"!==typeof b?(console.error("The numericString evaluator can only take in a string! You tried "+typeof b),{valid:!1,errorText:"The numericString evaluator can only take in a string! You tried "+typeof b}):!/^[0-9]+$/.test(b)?{valid:!1,errorText:c+" can only be numeric characters."}:a},email:function(b,c){("string"!==typeof b||"string"!==typeof c)&&console.error("Wrong parameters passed to email validator for "+c);return/^[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?$/i.test(b)?
a:{valid:!1,errorText:c+" has to be a valid email address"}},equal:function(b,c,e){("string"!==typeof b&&"number"!==typeof b&&"boolean"!==typeof b||"object"!==typeof e||2!==e.length)&&console.error("Wrong parameters passed to equal validator for "+c);"string"!==typeof b&&("number"!==typeof b&&"boolean"!==typeof b)&&console.error('Validator "Equal" only works for strings, numbers, and booleans. Tried '+typeof b+" for "+c);return b===e[0]?a:{valid:!1,errorText:c+" and "+e[1]+" have to be the same."}},
javascript:function(b,c,e){var f=e[0],e=[b].concat(e.splice(0,1)),f=f.apply(void 0,e);return"boolean"!==typeof f?(console.error("Javascript evaluator types must return only boolean values! This one returned "+f),{valid:!1,errorText:"Validator for "+c+" should have returned a bool, but returned "+f}):f?a:{valid:!1,errorText:c+" failed validation with value "+b}},regex:function(b,c,e){return"object"!==typeof e[0]||!1===e[0]instanceof RegExp?(console.error("Regex evaluator types must have a regex value for arg[0] but got "+
e[0]),{valid:!1,errorText:"Validator for "+c+" should be called with regex as arg[0]"}):"string"!==typeof b?(console.error("Regex can only be called on a string! Tried to call it on "+b+" for "+c),{valid:!1,errorText:"Broken validator. Regex for "+c+" wasn't called on a string"}):b.match(e[0])?a:{valid:!1,errorText:c+" failed regex validation with value "+b}}};return{check:function(a){var c,e={valid:!0,errorText:{}},f,g;for(g in a)if(a.hasOwnProperty(g)){c=a[g];for(var h=0;h<c.validators.length;h++)if(f=
c.validators[h],"undefined"===typeof f.disabled||!1===f.disabled)if("function"===typeof b[f.type]){var j=c.value,l=c.pretty||g,k=b[f.type](j,l,f.args||[]);k.valid?f.hasOwnProperty("chained")&&(k={},k[g]={pretty:l,value:j,validators:f.chained},f=this.check(k),!1===f.valid&&(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g]=e.errorText[g].concat(f.errorText[g]))):(e.valid=!1,e.errorText[g]=e.errorText[g]||[],e.errorText[g].push("undefined"===typeof f.failMsg?k.errorText.charAt(0).toUpperCase()+
k.errorText.slice(1):f.failMsg))}else console.warn("You tried to use a validator that doesn't exist! The name you tried to use was: "+f.type)}return e}}}]);angular.module("services.lesson").constant("viewerPartialMap",{Video:"video",SketchVideo:"video",ProgrammingQuiz:"programming_quiz",ImageFormQuiz:"image_quiz",Sketch:"sketch",EmbeddedFrame:"iframe"});angular.module("youtube").run(function(){var a=document.createElement("script");a.src="//www.youtube.com/iframe_api";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}).service("youtubeVideoPlayer",["mixin","user",function(a,b){var d={},c=null,e=b.getUserProp("sitePreferences"),f=e?e.playbackRate:1,g=e?e.videoQuality:"default",h=e?e.useHtml5Player:!0,j={small:0,medium:1,large:2,hd720:3,hd1080:4,highres:5};window.onYouTubeIframeAPIReady=function(){d.attach=function(a,
b,e){if(!_.isElement(a))throw"Must attach youtube player to a DOM element!";c&&(c=null);b={height:"523",width:"930",videoId:b,playerVars:{autoplay:e.autoPlay||0,color:"red",rel:0,showinfo:0,fs:1,theme:"light",wmode:"opaque"},events:{onReady:function(){d.emitEvent("ready");d.setPlaybackRate(f);d.setPlaybackQuality(g)},onPlaybackRateChange:function(a){f=a.data;d.emitEvent("playbackRateChange",a.data)},onPlaybackQualityChange:function(a){var b=c.getAvailableQualityLevels();j[a.data]>j[g]?g=a.data:j[a.data]<
j[b[0]]&&(g=a.data);d.emitEvent("playbackQualityChange",a.data)},onStateChange:function(a){a.data===YT.PlayerState.ENDED?d.emitEvent("videoEnd"):a.data===YT.PlayerState.PAUSED?d.emitEvent("videoPause",Math.floor(c.getCurrentTime())):a.data===YT.PlayerState.PLAYING&&d.emitEvent("videoPlay",Math.floor(c.getCurrentTime()))}}};h&&(b.playerVars.html5=1);c=new YT.Player(a,b)};d.emitEvent("apiReady")};d.getAvailablePlaybackRates=function(){return c.getAvailablePlaybackRates()};d.getCurrentPlaybackRate=function(){return c&&
c.getPlaybackRate?c.getPlaybackRate():f};d.setPlaybackRate=function(a){f=a;c.setPlaybackRate(a)};d.setPlaybackQuality=function(a){f=a;c.setPlaybackQuality(a)};d.playVideo=function(){c&&c.playVideo?c.playVideo():console.error("The video player isn't ready or there is no video player on this page!")};d.pauseVideo=function(){c&&c.pauseVideo&&(c.pauseVideo(),d.emitEvent("videoPause",Math.floor(c.getCurrentTime())))};d.stopVideo=function(){c.stopVideo()};d.destroyVideo=function(){c.stopVideo();c.destroy()};
d.loadVideo=function(a,b,e){c.loadVideoById?(c.loadVideoById(a,b||0,e||g),d.setPlaybackRate(f),d.setPlaybackQuality(g)):d.addEventListener("ready",function(){c.loadVideoById(a,b||0,e||g)},{removeAfterFired:!0})};d.getCurrentTime=function(){return c&&c.getCurrentTime?Math.floor(c.getCurrentTime()):null};return a.eventEmission(d,"apiReady ready videoEnd videoPlay videoPause playbackRateChange playbackQualityChange".split(" "))}]);window.UYSocial={};
(function(a){var b={client_id:"620121594665.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email"};a.runWhenReadyFacebook=function(b){a.facebookLoaded?b():(a.facebookLoadedCallbacks=a.facebookLoadedCallbacks||[],a.facebookLoadedCallbacks.push(b))};a.runWhenReadyTwitter=function(b){a.twitterLoaded?b():(a.twitterLoadedCallbacks=a.twitterLoadedCallbacks||[],a.twitterLoadedCallbacks.push(b))};a.runWhenReadyGoogle=function(b){a.googleLoaded?
b():(a.googleLoadedCallbacks=a.googleLoadedCallbacks||[],a.googleLoadedCallbacks.push(b))};a.getFacebookAuthResponse=function(b){a.runWhenReadyFacebook(function(){var a=window.FB.getAuthResponse();a?b(a):window.FB.login(function(a){a.authResponse&&b(a.authResponse)},{scope:"email"})})};a.getFacebookMeResponse=function(b){a.runWhenReadyFacebook(function(){window.FB.getLoginStatus(function(){window.FB.api("/me",function(a){b(a)})})})};a.getGoogleToken=function(c,d){a.runWhenReadyGoogle(function(){window.gapi.auth.authorize($.extend({response_type:"code",
immediate:c},b),function(a){a.code&&d(a)})})};a.getGoogleMeResponse=function(c){a.runWhenReadyGoogle(function(){window.gapi.auth.authorize($.extend({immediate:!0},b),function(){window.gapi.client.load("oauth2","v2",function(){window.gapi.client.oauth2.userinfo.get().execute(function(a){c(a)})})})})};var d=function(){if(a.googlePlusoneLoaded&&a.googleAuthLoaded&&(a.googleLoaded=!0,a.googleLoadedCallbacks))for(var b=0;b<a.googleLoadedCallbacks.length;b++)a.googleLoadedCallbacks[b]()};setTimeout(function(){if(!a.facebookLoaded){$("body").append('<div id="fb-root"></div>');
window.fbAsyncInit=function(){window.FB.init({appId:365362206864879,channelUrl:"//"+window.location.host+"/facebookChannel.html",status:!0,cookie:!0,xfbml:!0});a.facebookLoaded=!0;if(a.facebookLoadedCallbacks)for(var b=0;b<a.facebookLoadedCallbacks.length;b++)a.facebookLoadedCallbacks[b]()};var b,d=document.getElementsByTagName("script")[0];document.getElementById("facebook-jssdk")||(b=document.createElement("script"),b.id="facebook-jssdk",b.async=!0,b.src="//connect.facebook.net/en_US/all.js",d.parentNode.insertBefore(b,
d))}},200);setTimeout(function(){a.twitterLoaded||UY.getScriptCached("//platform.twitter.com/widgets.js",function(){if(window.twttr&&(a.twitterLoaded=!0,a.twitterLoadedCallbacks))for(var b=0;b<a.twitterLoadedCallbacks.length;b++)a.twitterLoadedCallbacks[b]()})},200);setTimeout(function(){a.googlePlusoneLoaded||UY.getScriptCached("https://apis.google.com/js/plusone.js",function(){window.gapi&&window.gapi.plusone&&(a.googlePlusoneLoaded=!0,d())})},200);setTimeout(function(){!1!==window.initGoogleAuth&&
(window.initGoogleAuth=function(){window.gapi.auth.init(function(){window.initGoogleAuth=!1;a.googleAuthLoaded=!0;d()})},UY.getScriptCached("https://apis.google.com/js/client.js?onload=initGoogleAuth"))},200)})(window.UYSocial);(function(a){"function"===typeof define&&define.amd?define(["jquery"],a):a(window.jQuery)})(function(a){var b=0;a.ajaxTransport("iframe",function(d){if(d.async&&("POST"===d.type||"GET"===d.type)){var c,e;return{send:function(f,g){c=a('<form style="display:none;"></form>');c.attr("accept-charset",d.formAcceptCharset);e=a('<iframe src="javascript:false;" name="iframe-transport-'+(b+=1)+'"></iframe>').bind("load",function(){var b,f=a.isArray(d.paramName)?d.paramName:[d.paramName];e.unbind("load").bind("load",
function(){var b;try{if(b=e.contents(),!b.length||!b[0].firstChild)throw Error();}catch(d){b=void 0}g(200,"success",{iframe:b});a('<iframe src="javascript:false;"></iframe>').appendTo(c);c.remove()});c.prop("target",e.prop("name")).prop("action",d.url).prop("method",d.type);d.formData&&a.each(d.formData,function(b,d){a('<input type="hidden"/>').prop("name",d.name).val(d.value).appendTo(c)});d.fileInput&&(d.fileInput.length&&"POST"===d.type)&&(b=d.fileInput.clone(),d.fileInput.after(function(a){return b[a]}),
d.paramName&&d.fileInput.each(function(b){a(this).prop("name",f[b]||d.paramName)}),c.append(d.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"));c.submit();b&&b.length&&d.fileInput.each(function(c,d){var e=a(b[c]);a(d).prop("name",e.prop("name"));e.replaceWith(d)})});c.append(e).appendTo(document.body)},abort:function(){e&&e.unbind("load").prop("src","javascript".concat(":false;"));c&&c.remove()}}}});a.ajaxSetup({converters:{"iframe text":function(b){return b&&
a(b[0].body).text()},"iframe json":function(b){var c=/^\s*(\[|\{[^\{])/,e=/[\}\]]\s*$/,f=/^\)\]\}',?\n/,b=b&&a(b[0].body).text();"string"===typeof b&&(b=b.replace(f,""),c.test(b)&&e.test(b)&&(b="string"===typeof b?JSON.parse(b):b));return b},"iframe html":function(b){return b&&a(b[0].body).html()},"iframe script":function(b){return b&&a.globalEval(a(b[0].body).text())}}})});
(function(a){"function"===typeof define&&define.amd?define(["jquery","jquery.ui.widget"],a):a(window.jQuery)})(function(a){a.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader);a.support.xhrFormDataFileUpload=!!window.FormData;a.widget("blueimp.fileupload",{options:{dropZone:a(document),pasteZone:a(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,
redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(a){return a.serializeArray()},add:function(a,d){d.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date;this.bitrate=this.loaded=0;this.getBitrate=function(a,d,c){var e=
a-this.timestamp;if(!this.bitrate||!c||e>c)this.bitrate=8*(d-this.loaded)*(1E3/e),this.loaded=d,this.timestamp=a;return this.bitrate}},_isXHRUpload:function(b){return!b.forceIframeTransport&&(!b.multipart&&a.support.xhrFileUpload||a.support.xhrFormDataFileUpload)},_getFormData:function(b){var d;return"function"===typeof b.formData?b.formData(b.form):a.isArray(b.formData)?b.formData:b.formData?(d=[],a.each(b.formData,function(a,b){d.push({name:a,value:b})}),d):[]},_getTotal:function(b){var d=0;a.each(b,
function(a,b){d+=b.size||1});return d},_onProgress:function(a,d){if(a.lengthComputable){var c=+new Date,e,f;if(!d._time||!d.progressInterval||!(c-d._time<d.progressInterval&&a.loaded!==a.total))d._time=c,e=d.total||this._getTotal(d.files),f=parseInt(a.loaded/a.total*(d.chunkSize||e),10)+(d.uploadedBytes||0),this._loaded+=f-(d.loaded||d.uploadedBytes||0),d.lengthComputable=!0,d.loaded=f,d.total=e,d.bitrate=d._bitrateTimer.getBitrate(c,f,d.bitrateInterval),this._trigger("progress",a,d),this._trigger("progressall",
a,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(c,this._loaded,d.bitrateInterval)})}},_initProgressListener:function(b){var d=this,c=b.xhr?b.xhr():a.ajaxSettings.xhr();c.upload&&(a(c.upload).bind("progress",function(a){var c=a.originalEvent;a.lengthComputable=c.lengthComputable;a.loaded=c.loaded;a.total=c.total;d._onProgress(a,b)}),b.xhr=function(){return c})},_initXHRData:function(b){var d,c=b.files[0],e=b.multipart||!a.support.xhrFileUpload,f=b.paramName[0];
b.headers=b.headers||{};b.contentRange&&(b.headers["Content-Range"]=b.contentRange);e?a.support.xhrFormDataFileUpload&&(b.postMessage?(d=this._getFormData(b),b.blob?d.push({name:f,value:b.blob}):a.each(b.files,function(a,c){d.push({name:b.paramName[a]||f,value:c})})):(b.formData instanceof FormData?d=b.formData:(d=new FormData,a.each(this._getFormData(b),function(a,b){d.append(b.name,b.value)})),b.blob?(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(c.name)+'"',d.append(f,b.blob,
c.name)):a.each(b.files,function(a,c){if(window.Blob&&c instanceof Blob||window.File&&c instanceof File)d.append(b.paramName[a]||f,c,c.name)})),b.data=d):(b.headers["Content-Disposition"]='attachment; filename="'+encodeURI(c.name)+'"',b.contentType=c.type,b.data=b.blob||c);b.blob=null},_initIframeSettings:function(b){b.dataType="iframe "+(b.dataType||"");b.formData=this._getFormData(b);b.redirect&&a("<a></a>").prop("href",b.url).prop("host")!==location.host&&b.formData.push({name:b.redirectParamName||
"redirect",value:b.redirect})},_initDataSettings:function(a){this._isXHRUpload(a)?(this._chunkedUpload(a,!0)||(a.data||this._initXHRData(a),this._initProgressListener(a)),a.postMessage&&(a.dataType="postmessage "+(a.dataType||""))):this._initIframeSettings(a,"iframe")},_getParamName:function(b){var d=a(b.fileInput),c=b.paramName;c?a.isArray(c)||(c=[c]):(c=[],d.each(function(){for(var b=a(this),d=b.prop("name")||"files[]",b=(b.prop("files")||[1]).length;b;)c.push(d),b-=1}),c.length||(c=[d.prop("name")||
"files[]"]));return c},_initFormSettings:function(b){if(!b.form||!b.form.length)b.form=a(b.fileInput.prop("form")),b.form.length||(b.form=a(this.options.fileInput.prop("form")));b.paramName=this._getParamName(b);b.url||(b.url=b.form.prop("action")||location.href);b.type=(b.type||b.form.prop("method")||"").toUpperCase();"POST"!==b.type&&"PUT"!==b.type&&(b.type="POST");b.formAcceptCharset||(b.formAcceptCharset=b.form.attr("accept-charset"))},_getAJAXSettings:function(b){b=a.extend({},this.options,b);
this._initFormSettings(b);this._initDataSettings(b);return b},_enhancePromise:function(a){a.success=a.done;a.error=a.fail;a.complete=a.always;return a},_getXHRPromise:function(b,d,c){var e=a.Deferred(),f=e.promise(),d=d||this.options.context||f;!0===b?e.resolveWith(d,c):!1===b&&e.rejectWith(d,c);f.abort=e.promise;return this._enhancePromise(f)},_getUploadedBytes:function(a){return(a=(a=(a=a.getResponseHeader("Range"))&&a.split("-"))&&1<a.length&&parseInt(a[1],10))&&a+1},_chunkedUpload:function(b,
d){var c=this,e=b.files[0],f=e.size,g=b.uploadedBytes=b.uploadedBytes||0,h=b.maxChunkSize||f,j=e.slice||e.webkitSlice||e.mozSlice,l=a.Deferred(),k=l.promise(),m,n;if(!this._isXHRUpload(b)||(!j||!(g||h<f))||b.data)return!1;if(d)return!0;if(g>=f)return e.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,b.context,[null,"error",e.error]);n=function(){var d=a.extend({},b);d.blob=j.call(e,g,g+h,e.type);d.chunkSize=d.blob.size;d.contentRange="bytes "+g+"-"+(g+d.chunkSize-1)+"/"+f;c._initXHRData(d);
c._initProgressListener(d);m=(a.ajax(d)||c._getXHRPromise(!1,d.context)).done(function(e,h,k){g=c._getUploadedBytes(k)||g+d.chunkSize;d.loaded||c._onProgress(a.Event("progress",{lengthComputable:!0,loaded:g-d.uploadedBytes,total:g-d.uploadedBytes}),d);b.uploadedBytes=d.uploadedBytes=g;g<f?n():l.resolveWith(d.context,[e,h,k])}).fail(function(a,b,c){l.rejectWith(d.context,[a,b,c])})};this._enhancePromise(k);k.abort=function(){return m.abort()};n();return k},_beforeSend:function(a,d){0===this._active&&
(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer);this._active+=1;this._loaded+=d.uploadedBytes||0;this._total+=this._getTotal(d.files)},_onDone:function(b,d,c,e){this._isXHRUpload(e)||this._onProgress(a.Event("progress",{lengthComputable:!0,loaded:1,total:1}),e);e.result=b;e.textStatus=d;e.jqXHR=c;this._trigger("done",null,e)},_onFail:function(a,d,c,e){e.jqXHR=a;e.textStatus=d;e.errorThrown=c;this._trigger("fail",null,e);e.recalculateProgress&&(this._loaded-=e.loaded||e.uploadedBytes||
0,this._total-=e.total||this._getTotal(e.files))},_onAlways:function(a,d,c,e){this._active-=1;e.textStatus=d;c&&c.always?(e.jqXHR=c,e.result=a):(e.jqXHR=a,e.errorThrown=c);this._trigger("always",null,e);0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(b,d){var c=this,e,f,g,h,j=c._getAJAXSettings(d),l=function(){c._sending+=1;j._bitrateTimer=new c._BitrateTimer;return e=e||((f||!1===c._trigger("send",b,j))&&c._getXHRPromise(!1,j.context,
f)||c._chunkedUpload(j)||a.ajax(j)).done(function(a,b,d){c._onDone(a,b,d,j)}).fail(function(a,b,d){c._onFail(a,b,d,j)}).always(function(a,b,d){c._sending-=1;c._onAlways(a,b,d,j);if(j.limitConcurrentUploads&&j.limitConcurrentUploads>c._sending)for(a=c._slots.shift();a;){if(b=a.state?"pending"===a.state():!a.isRejected()){a.resolve();break}a=c._slots.shift()}})};this._beforeSend(b,j);return this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?
(1<this.options.limitConcurrentUploads?(g=a.Deferred(),this._slots.push(g),h=g.pipe(l)):h=this._sequence=this._sequence.pipe(l,l),h.abort=function(){f=[void 0,"abort","abort"];return!e?(g&&g.rejectWith(j.context,f),l()):e.abort()},this._enhancePromise(h)):l()},_onAdd:function(b,d){var c=this,e=!0,f=a.extend({},this.options,d),g=f.limitMultiFileUploads,h=this._getParamName(f),j,l,k;if(!f.singleFileUploads&&!g||!this._isXHRUpload(f))l=[d.files],j=[h];else if(!f.singleFileUploads&&g){l=[];j=[];for(k=
0;k<d.files.length;k+=g)l.push(d.files.slice(k,k+g)),f=h.slice(k,k+g),f.length||(f=h),j.push(f)}else j=h;d.originalFiles=d.files;a.each(l||d.files,function(f,g){var h=a.extend({},d);h.files=l?g:[g];h.paramName=j[f];h.submit=function(){return h.jqXHR=this.jqXHR=!1!==c._trigger("submit",b,this)&&c._onSend(b,this)};return e=c._trigger("add",b,h)});return e},_replaceFileInput:function(b){var d=b.clone(!0);a("<form></form>").append(d)[0].reset();b.after(d).detach();a.cleanData(b.unbind("remove"));this.options.fileInput=
this.options.fileInput.map(function(a,e){return e===b[0]?d[0]:e});b[0]===this.element[0]&&(this.element=d)},_handleFileTreeEntry:function(b,d){var c=this,e=a.Deferred(),f=function(a){a&&!a.entry&&(a.entry=b);e.resolve([a])},g,d=d||"";b.isFile?b._file?(b._file.relativePath=d,e.resolve(b._file)):b.file(function(a){a.relativePath=d;e.resolve(a)},f):b.isDirectory?(g=b.createReader(),g.readEntries(function(a){c._handleFileTreeEntries(a,d+b.name+"/").done(function(a){e.resolve(a)}).fail(f)},f)):e.resolve([]);
return e.promise()},_handleFileTreeEntries:function(b,d){var c=this;return a.when.apply(a,a.map(b,function(a){return c._handleFileTreeEntry(a,d)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(b){var b=b||{},d=b.items;return d&&d.length&&(d[0].webkitGetAsEntry||d[0].getAsEntry)?this._handleFileTreeEntries(a.map(d,function(a){var b;if(a.webkitGetAsEntry){if(b=a.webkitGetAsEntry())b._file=a.getAsFile();return b}return a.getAsEntry()})):a.Deferred().resolve(a.makeArray(b.files)).promise()},
_getSingleFileInputFiles:function(b){var b=a(b),d=b.prop("webkitEntries")||b.prop("entries");if(d&&d.length)return this._handleFileTreeEntries(d);d=a.makeArray(b.prop("files"));if(d.length)void 0===d[0].name&&d[0].fileName&&a.each(d,function(a,b){b.name=b.fileName;b.size=b.fileSize});else{b=b.prop("value");if(!b)return a.Deferred().resolve([]).promise();d=[{name:b.replace(/^.*\\/,"")}]}return a.Deferred().resolve(d).promise()},_getFileInputFiles:function(b){return!(b instanceof a)||1===b.length?this._getSingleFileInputFiles(b):
a.when.apply(a,a.map(b,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_onChange:function(b){var d=this,c={fileInput:a(b.target),form:a(b.target.form)};this._getFileInputFiles(c.fileInput).always(function(a){c.files=a;d.options.replaceFileInput&&d._replaceFileInput(c.fileInput);!1!==d._trigger("change",b,c)&&d._onAdd(b,c)})},_onPaste:function(b){var d=b.originalEvent.clipboardData,c={files:[]};a.each(d&&d.items||[],function(a,b){var d=b.getAsFile&&
b.getAsFile();d&&c.files.push(d)});if(!1===this._trigger("paste",b,c)||!1===this._onAdd(b,c))return!1},_onDrop:function(a){var d=this,c=a.dataTransfer=a.originalEvent.dataTransfer,e={};c&&(c.files&&c.files.length)&&a.preventDefault();this._getDroppedFiles(c).always(function(c){e.files=c;!1!==d._trigger("drop",a,e)&&d._onAdd(a,e)})},_onDragOver:function(b){var d=b.dataTransfer=b.originalEvent.dataTransfer;if(!1===this._trigger("dragover",b))return!1;d&&-1!==a.inArray("Files",d.types)&&(d.dropEffect=
"copy",b.preventDefault())},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste}));this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop");this._off(this.options.pasteZone,"paste");this._off(this.options.fileInput,"change")},_setOption:function(b,d){var c=-1!==a.inArray(b,this._refreshOptionsList);
c&&this._destroyEventHandlers();this._super(b,d);c&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var b=this.options;void 0===b.fileInput?b.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):b.fileInput instanceof a||(b.fileInput=a(b.fileInput));b.dropZone instanceof a||(b.dropZone=a(b.dropZone));b.pasteZone instanceof a||(b.pasteZone=a(b.pasteZone))},_create:function(){a.extend(this.options,a(this.element[0].cloneNode(!1)).data());
this._initSpecialOptions();this._slots=[];this._sequence=this._getXHRPromise(!0);this._sending=this._active=this._loaded=this._total=0;this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(b){var d=this;b&&!this.options.disabled&&(b.fileInput&&!b.files?this._getFileInputFiles(b.fileInput).always(function(a){b.files=a;d._onAdd(null,b)}):(b.files=a.makeArray(b.files),this._onAdd(null,b)))},send:function(b){if(b&&!this.options.disabled){if(b.fileInput&&!b.files){var d=
this,c=a.Deferred(),e=c.promise(),f,g;e.abort=function(){g=!0;if(f)return f.abort();c.reject(null,"abort","abort");return e};this._getFileInputFiles(b.fileInput).always(function(a){g||(b.files=a,f=d._onSend(null,b).then(function(a,b,d){c.resolve(a,b,d)},function(a,b,d){c.reject(a,b,d)}))});return this._enhancePromise(e)}b.files=a.makeArray(b.files);if(b.files.length)return this._onSend(null,b)}return this._getXHRPromise(!1,b&&b.context)}})});function WavDecoder(){}
function WavEncoder(a){function b(a,b){for(var c=new Float32Array(b),d=0,e=0;e<a.length;e++)c.set(a[e],d),d+=a[e].length;return c}function d(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))}sampleRate=44100;var c=0;for(i in a.left)c+=a.left[i].length;for(var e=b(a.left,c),c=b(a.right,c),f=e.length+c.length,a=new Float32Array(f),g=0,h=0;g<f;)a[g++]=e[h],a[g++]=c[h],h++;e=new ArrayBuffer(44+2*a.length);e=new DataView(e);d(e,0,"RIFF");e.setUint32(4,32+2*a.length,!0);d(e,8,"WAVE");d(e,
12,"fmt ");e.setUint32(16,16,!0);e.setUint16(20,1,!0);e.setUint16(22,2,!0);e.setUint32(24,sampleRate,!0);e.setUint32(28,4*sampleRate,!0);e.setUint16(32,4,!0);e.setUint16(34,16,!0);d(e,36,"data");e.setUint32(40,2*a.length,!0);c=44;for(f=0;f<a.length;f++,c+=2)g=Math.max(-1,Math.min(1,a[f])),e.setInt16(c,0>g?32768*g:32767*g,!0);return new Blob([e],{type:"audio/wav"})};
